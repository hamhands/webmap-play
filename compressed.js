!function(a,b,c){function e(){var b=a.L;d.noConflict=function(){return a.L=b,this},a.L=d}var d={version:"1.0.0"};"object"==typeof module&&"object"==typeof module.exports?module.exports=d:"function"==typeof define&&define.amd&&define(d),"undefined"!=typeof a&&e(),d.Util={extend:function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){e=arguments[c];for(b in e)a[b]=e[b]}return a},create:Object.create||function(){function a(){}return function(b){return a.prototype=b,new a}}(),bind:function(a,b){var c=Array.prototype.slice;if(a.bind)return a.bind.apply(a,c.call(arguments,1));var d=c.call(arguments,2);return function(){return a.apply(b,d.length?d.concat(c.call(arguments)):arguments)}},stamp:function(a){return a._leaflet_id=a._leaflet_id||++d.Util.lastId,a._leaflet_id},lastId:0,throttle:function(a,b,c){var d,e,f,g;return g=function(){d=!1,e&&(f.apply(c,e),e=!1)},f=function(){d?e=arguments:(a.apply(c,arguments),setTimeout(g,b),d=!0)}},wrapNum:function(a,b,c){var d=b[1],e=b[0],f=d-e;return a===d&&c?a:((a-e)%f+f)%f+e},falseFn:function(){return!1},formatNum:function(a,b){var c=Math.pow(10,b||5);return Math.round(a*c)/c},trim:function(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")},splitWords:function(a){return d.Util.trim(a).split(/\s+/)},setOptions:function(a,b){a.hasOwnProperty("options")||(a.options=a.options?d.Util.create(a.options):{});for(var c in b)a.options[c]=b[c];return a.options},getParamString:function(a,b,c){var d=[];for(var e in a)d.push(encodeURIComponent(c?e.toUpperCase():e)+"="+encodeURIComponent(a[e]));return(b&&b.indexOf("?")!==-1?"&":"?")+d.join("&")},template:function(a,b){return a.replace(d.Util.templateRe,function(a,d){var e=b[d];if(e===c)throw new Error("No value provided for variable "+a);return"function"==typeof e&&(e=e(b)),e})},templateRe:/\{ *([\w_\-]+) *\}/g,isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},indexOf:function(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function b(b){return a["webkit"+b]||a["moz"+b]||a["ms"+b]}function e(b){var d=+new Date,e=Math.max(0,16-(d-c));return c=d+e,a.setTimeout(b,e)}var c=0,f=a.requestAnimationFrame||b("RequestAnimationFrame")||e,g=a.cancelAnimationFrame||b("CancelAnimationFrame")||b("CancelRequestAnimationFrame")||function(b){a.clearTimeout(b)};d.Util.requestAnimFrame=function(b,c,g){return g&&f===e?void b.call(c):f.call(a,d.bind(b,c))},d.Util.cancelAnimFrame=function(b){b&&g.call(a,b)}}(),d.extend=d.Util.extend,d.bind=d.Util.bind,d.stamp=d.Util.stamp,d.setOptions=d.Util.setOptions,d.Class=function(){},d.Class.extend=function(a){var b=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},c=b.__super__=this.prototype,e=d.Util.create(c);e.constructor=b,b.prototype=e;for(var f in this)this.hasOwnProperty(f)&&"prototype"!==f&&(b[f]=this[f]);return a.statics&&(d.extend(b,a.statics),delete a.statics),a.includes&&(d.Util.extend.apply(null,[e].concat(a.includes)),delete a.includes),e.options&&(a.options=d.Util.extend(d.Util.create(e.options),a.options)),d.extend(e,a),e._initHooks=[],e.callInitHooks=function(){if(!this._initHooksCalled){c.callInitHooks&&c.callInitHooks.call(this),this._initHooksCalled=!0;for(var a=0,b=e._initHooks.length;a<b;a++)e._initHooks[a].call(this)}},b},d.Class.include=function(a){return d.extend(this.prototype,a),this},d.Class.mergeOptions=function(a){return d.extend(this.prototype.options,a),this},d.Class.addInitHook=function(a){var b=Array.prototype.slice.call(arguments,1),c="function"==typeof a?a:function(){this[a].apply(this,b)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(c),this},d.Evented=d.Class.extend({on:function(a,b,c){if("object"==typeof a)for(var e in a)this._on(e,a[e],b);else{a=d.Util.splitWords(a);for(var f=0,g=a.length;f<g;f++)this._on(a[f],b,c)}return this},off:function(a,b,c){if(a)if("object"==typeof a)for(var e in a)this._off(e,a[e],b);else{a=d.Util.splitWords(a);for(var f=0,g=a.length;f<g;f++)this._off(a[f],b,c)}else delete this._events;return this},_on:function(a,b,d){this._events=this._events||{};var e=this._events[a];e||(e=[],this._events[a]=e),d===this&&(d=c);for(var f={fn:b,ctx:d},g=e,h=0,i=g.length;h<i;h++)if(g[h].fn===b&&g[h].ctx===d)return;g.push(f),e.count++},_off:function(a,b,e){var f,g,h;if(this._events&&(f=this._events[a])){if(!b){for(g=0,h=f.length;g<h;g++)f[g].fn=d.Util.falseFn;return void delete this._events[a]}if(e===this&&(e=c),f)for(g=0,h=f.length;g<h;g++){var i=f[g];if(i.ctx===e&&i.fn===b)return i.fn=d.Util.falseFn,this._firingCount&&(this._events[a]=f=f.slice()),void f.splice(g,1)}}},fire:function(a,b,c){if(!this.listens(a,c))return this;var e=d.Util.extend({},b,{type:a,target:this});if(this._events){var f=this._events[a];if(f){this._firingCount=this._firingCount+1||1;for(var g=0,h=f.length;g<h;g++){var i=f[g];i.fn.call(i.ctx||this,e)}this._firingCount--}}return c&&this._propagateEvent(e),this},listens:function(a,b){var c=this._events&&this._events[a];if(c&&c.length)return!0;if(b)for(var d in this._eventParents)if(this._eventParents[d].listens(a,b))return!0;return!1},once:function(a,b,c){if("object"==typeof a){for(var e in a)this.once(e,a[e],b);return this}var f=d.bind(function(){this.off(a,b,c).off(a,f,c)},this);return this.on(a,b,c).on(a,f,c)},addEventParent:function(a){return this._eventParents=this._eventParents||{},this._eventParents[d.stamp(a)]=a,this},removeEventParent:function(a){return this._eventParents&&delete this._eventParents[d.stamp(a)],this},_propagateEvent:function(a){for(var b in this._eventParents)this._eventParents[b].fire(a.type,d.extend({layer:a.target},a),!0)}});var f=d.Evented.prototype;f.addEventListener=f.on,f.removeEventListener=f.clearAllEventListeners=f.off,f.addOneTimeEventListener=f.once,f.fireEvent=f.fire,f.hasEventListeners=f.listens,d.Mixin={Events:f},function(){var c=navigator.userAgent.toLowerCase(),e=b.documentElement,f="ActiveXObject"in a,g=c.indexOf("webkit")!==-1,h=c.indexOf("phantom")!==-1,i=c.search("android [23]")!==-1,j=c.indexOf("chrome")!==-1,k=c.indexOf("gecko")!==-1&&!g&&!a.opera&&!f,l=0===navigator.platform.indexOf("Win"),m="undefined"!=typeof orientation||c.indexOf("mobile")!==-1,n=!a.PointerEvent&&a.MSPointerEvent,o=a.PointerEvent||n,p=f&&"transition"in e.style,q="WebKitCSSMatrix"in a&&"m11"in new a.WebKitCSSMatrix&&!i,r="MozPerspective"in e.style,s="OTransition"in e.style,t=!a.L_NO_TOUCH&&(o||"ontouchstart"in a||a.DocumentTouch&&b instanceof a.DocumentTouch);d.Browser={ie:f,ielt9:f&&!b.addEventListener,edge:"msLaunchUri"in navigator&&!("documentMode"in b),webkit:g,gecko:k,android:c.indexOf("android")!==-1,android23:i,chrome:j,safari:!j&&c.indexOf("safari")!==-1,win:l,ie3d:p,webkit3d:q,gecko3d:r,opera12:s,any3d:!a.L_DISABLE_3D&&(p||q||r)&&!s&&!h,mobile:m,mobileWebkit:m&&g,mobileWebkit3d:m&&q,mobileOpera:m&&a.opera,mobileGecko:m&&k,touch:!!t,msPointer:!!n,pointer:!!o,retina:(a.devicePixelRatio||a.screen.deviceXDPI/a.screen.logicalXDPI)>1}}(),d.Point=function(a,b,c){this.x=c?Math.round(a):a,this.y=c?Math.round(b):b},d.Point.prototype={clone:function(){return new d.Point(this.x,this.y)},add:function(a){return this.clone()._add(d.point(a))},_add:function(a){return this.x+=a.x,this.y+=a.y,this},subtract:function(a){return this.clone()._subtract(d.point(a))},_subtract:function(a){return this.x-=a.x,this.y-=a.y,this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){return this.x/=a,this.y/=a,this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){return this.x*=a,this.y*=a,this},scaleBy:function(a){return new d.Point(this.x*a.x,this.y*a.y)},unscaleBy:function(a){return new d.Point(this.x/a.x,this.y/a.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},distanceTo:function(a){a=d.point(a);var b=a.x-this.x,c=a.y-this.y;return Math.sqrt(b*b+c*c)},equals:function(a){return a=d.point(a),a.x===this.x&&a.y===this.y},contains:function(a){return a=d.point(a),Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+d.Util.formatNum(this.x)+", "+d.Util.formatNum(this.y)+")"}},d.point=function(a,b,e){return a instanceof d.Point?a:d.Util.isArray(a)?new d.Point(a[0],a[1]):a===c||null===a?a:"object"==typeof a&&"x"in a&&"y"in a?new d.Point(a.x,a.y):new d.Point(a,b,e)},d.Bounds=function(a,b){if(a)for(var c=b?[a,b]:a,d=0,e=c.length;d<e;d++)this.extend(c[d])},d.Bounds.prototype={extend:function(a){return a=d.point(a),this.min||this.max?(this.min.x=Math.min(a.x,this.min.x),this.max.x=Math.max(a.x,this.max.x),this.min.y=Math.min(a.y,this.min.y),this.max.y=Math.max(a.y,this.max.y)):(this.min=a.clone(),this.max=a.clone()),this},getCenter:function(a){return new d.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return new d.Point(this.min.x,this.max.y)},getTopRight:function(){return new d.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var b,c;return a="number"==typeof a[0]||a instanceof d.Point?d.point(a):d.bounds(a),a instanceof d.Bounds?(b=a.min,c=a.max):b=c=a,b.x>=this.min.x&&c.x<=this.max.x&&b.y>=this.min.y&&c.y<=this.max.y},intersects:function(a){a=d.bounds(a);var b=this.min,c=this.max,e=a.min,f=a.max,g=f.x>=b.x&&e.x<=c.x,h=f.y>=b.y&&e.y<=c.y;return g&&h},overlaps:function(a){a=d.bounds(a);var b=this.min,c=this.max,e=a.min,f=a.max,g=f.x>b.x&&e.x<c.x,h=f.y>b.y&&e.y<c.y;return g&&h},isValid:function(){return!(!this.min||!this.max)}},d.bounds=function(a,b){return!a||a instanceof d.Bounds?a:new d.Bounds(a,b)},d.Transformation=function(a,b,c,d){this._a=a,this._b=b,this._c=c,this._d=d},d.Transformation.prototype={transform:function(a,b){return this._transform(a.clone(),b)},_transform:function(a,b){return b=b||1,a.x=b*(this._a*a.x+this._b),a.y=b*(this._c*a.y+this._d),a},untransform:function(a,b){return b=b||1,new d.Point((a.x/b-this._b)/this._a,(a.y/b-this._d)/this._c)}},d.DomUtil={get:function(a){return"string"==typeof a?b.getElementById(a):a},getStyle:function(a,c){var d=a.style[c]||a.currentStyle&&a.currentStyle[c];if((!d||"auto"===d)&&b.defaultView){var e=b.defaultView.getComputedStyle(a,null);d=e?e[c]:null}return"auto"===d?null:d},create:function(a,c,d){var e=b.createElement(a);return e.className=c||"",d&&d.appendChild(e),e},remove:function(a){var b=a.parentNode;b&&b.removeChild(a)},empty:function(a){for(;a.firstChild;)a.removeChild(a.firstChild)},toFront:function(a){a.parentNode.appendChild(a)},toBack:function(a){var b=a.parentNode;b.insertBefore(a,b.firstChild)},hasClass:function(a,b){if(a.classList!==c)return a.classList.contains(b);var e=d.DomUtil.getClass(a);return e.length>0&&new RegExp("(^|\\s)"+b+"(\\s|$)").test(e)},addClass:function(a,b){if(a.classList!==c)for(var e=d.Util.splitWords(b),f=0,g=e.length;f<g;f++)a.classList.add(e[f]);else if(!d.DomUtil.hasClass(a,b)){var h=d.DomUtil.getClass(a);d.DomUtil.setClass(a,(h?h+" ":"")+b)}},removeClass:function(a,b){a.classList!==c?a.classList.remove(b):d.DomUtil.setClass(a,d.Util.trim((" "+d.DomUtil.getClass(a)+" ").replace(" "+b+" "," ")))},setClass:function(a,b){a.className.baseVal===c?a.className=b:a.className.baseVal=b},getClass:function(a){return a.className.baseVal===c?a.className:a.className.baseVal},setOpacity:function(a,b){"opacity"in a.style?a.style.opacity=b:"filter"in a.style&&d.DomUtil._setOpacityIE(a,b)},_setOpacityIE:function(a,b){var c=!1,d="DXImageTransform.Microsoft.Alpha";try{c=a.filters.item(d)}catch(a){if(1===b)return}b=Math.round(100*b),c?(c.Enabled=100!==b,c.Opacity=b):a.style.filter+=" progid:"+d+"(opacity="+b+")"},testProp:function(a){for(var c=b.documentElement.style,d=0;d<a.length;d++)if(a[d]in c)return a[d];return!1},setTransform:function(a,b,c){var e=b||new d.Point(0,0);a.style[d.DomUtil.TRANSFORM]=(d.Browser.ie3d?"translate("+e.x+"px,"+e.y+"px)":"translate3d("+e.x+"px,"+e.y+"px,0)")+(c?" scale("+c+")":"")},setPosition:function(a,b){a._leaflet_pos=b,d.Browser.any3d?d.DomUtil.setTransform(a,b):(a.style.left=b.x+"px",a.style.top=b.y+"px")},getPosition:function(a){return a._leaflet_pos||new d.Point(0,0)}},function(){d.DomUtil.TRANSFORM=d.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]);var c=d.DomUtil.TRANSITION=d.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);if(d.DomUtil.TRANSITION_END="webkitTransition"===c||"OTransition"===c?c+"End":"transitionend","onselectstart"in b)d.DomUtil.disableTextSelection=function(){d.DomEvent.on(a,"selectstart",d.DomEvent.preventDefault)},d.DomUtil.enableTextSelection=function(){d.DomEvent.off(a,"selectstart",d.DomEvent.preventDefault)};else{var e=d.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);d.DomUtil.disableTextSelection=function(){if(e){var a=b.documentElement.style;this._userSelect=a[e],a[e]="none"}},d.DomUtil.enableTextSelection=function(){e&&(b.documentElement.style[e]=this._userSelect,delete this._userSelect)}}d.DomUtil.disableImageDrag=function(){d.DomEvent.on(a,"dragstart",d.DomEvent.preventDefault)},d.DomUtil.enableImageDrag=function(){d.DomEvent.off(a,"dragstart",d.DomEvent.preventDefault)},d.DomUtil.preventOutline=function(b){for(;b.tabIndex===-1;)b=b.parentNode;b&&b.style&&(d.DomUtil.restoreOutline(),this._outlineElement=b,this._outlineStyle=b.style.outline,b.style.outline="none",d.DomEvent.on(a,"keydown",d.DomUtil.restoreOutline,this))},d.DomUtil.restoreOutline=function(){this._outlineElement&&(this._outlineElement.style.outline=this._outlineStyle,delete this._outlineElement,delete this._outlineStyle,d.DomEvent.off(a,"keydown",d.DomUtil.restoreOutline,this))}}(),d.LatLng=function(a,b,d){if(isNaN(a)||isNaN(b))throw new Error("Invalid LatLng object: ("+a+", "+b+")");this.lat=+a,this.lng=+b,d!==c&&(this.alt=+d)},d.LatLng.prototype={equals:function(a,b){if(!a)return!1;a=d.latLng(a);var e=Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng));return e<=(b===c?1e-9:b)},toString:function(a){return"LatLng("+d.Util.formatNum(this.lat,a)+", "+d.Util.formatNum(this.lng,a)+")"},distanceTo:function(a){return d.CRS.Earth.distance(this,d.latLng(a))},wrap:function(){return d.CRS.Earth.wrapLatLng(this)},toBounds:function(a){var b=180*a/40075017,c=b/Math.cos(Math.PI/180*this.lat);return d.latLngBounds([this.lat-b,this.lng-c],[this.lat+b,this.lng+c])},clone:function(){return new d.LatLng(this.lat,this.lng,this.alt)}},d.latLng=function(a,b,e){return a instanceof d.LatLng?a:d.Util.isArray(a)&&"object"!=typeof a[0]?3===a.length?new d.LatLng(a[0],a[1],a[2]):2===a.length?new d.LatLng(a[0],a[1]):null:a===c||null===a?a:"object"==typeof a&&"lat"in a?new d.LatLng(a.lat,"lng"in a?a.lng:a.lon,a.alt):b===c?null:new d.LatLng(a,b,e)},d.LatLngBounds=function(a,b){if(a)for(var c=b?[a,b]:a,d=0,e=c.length;d<e;d++)this.extend(c[d])},d.LatLngBounds.prototype={extend:function(a){var e,f,b=this._southWest,c=this._northEast;if(a instanceof d.LatLng)e=a,f=a;else{if(!(a instanceof d.LatLngBounds))return a?this.extend(d.latLng(a)||d.latLngBounds(a)):this;if(e=a._southWest,f=a._northEast,!e||!f)return this}return b||c?(b.lat=Math.min(e.lat,b.lat),b.lng=Math.min(e.lng,b.lng),c.lat=Math.max(f.lat,c.lat),c.lng=Math.max(f.lng,c.lng)):(this._southWest=new d.LatLng(e.lat,e.lng),this._northEast=new d.LatLng(f.lat,f.lng)),this},pad:function(a){var b=this._southWest,c=this._northEast,e=Math.abs(b.lat-c.lat)*a,f=Math.abs(b.lng-c.lng)*a;return new d.LatLngBounds(new d.LatLng(b.lat-e,b.lng-f),new d.LatLng(c.lat+e,c.lng+f))},getCenter:function(){return new d.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new d.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new d.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){a="number"==typeof a[0]||a instanceof d.LatLng?d.latLng(a):d.latLngBounds(a);var e,f,b=this._southWest,c=this._northEast;return a instanceof d.LatLngBounds?(e=a.getSouthWest(),f=a.getNorthEast()):e=f=a,e.lat>=b.lat&&f.lat<=c.lat&&e.lng>=b.lng&&f.lng<=c.lng},intersects:function(a){a=d.latLngBounds(a);var b=this._southWest,c=this._northEast,e=a.getSouthWest(),f=a.getNorthEast(),g=f.lat>=b.lat&&e.lat<=c.lat,h=f.lng>=b.lng&&e.lng<=c.lng;return g&&h},overlaps:function(a){a=d.latLngBounds(a);var b=this._southWest,c=this._northEast,e=a.getSouthWest(),f=a.getNorthEast(),g=f.lat>b.lat&&e.lat<c.lat,h=f.lng>b.lng&&e.lng<c.lng;return g&&h},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(a){return!!a&&(a=d.latLngBounds(a),this._southWest.equals(a.getSouthWest())&&this._northEast.equals(a.getNorthEast()))},isValid:function(){return!(!this._southWest||!this._northEast)}},d.latLngBounds=function(a,b){return a instanceof d.LatLngBounds?a:new d.LatLngBounds(a,b)},d.Projection={},d.Projection.LonLat={project:function(a){return new d.Point(a.lng,a.lat)},unproject:function(a){return new d.LatLng(a.y,a.x)},bounds:d.bounds([-180,-90],[180,90])},d.Projection.SphericalMercator={R:6378137,MAX_LATITUDE:85.0511287798,project:function(a){var b=Math.PI/180,c=this.MAX_LATITUDE,e=Math.max(Math.min(c,a.lat),-c),f=Math.sin(e*b);return new d.Point(this.R*a.lng*b,this.R*Math.log((1+f)/(1-f))/2)},unproject:function(a){var b=180/Math.PI;return new d.LatLng((2*Math.atan(Math.exp(a.y/this.R))-Math.PI/2)*b,a.x*b/this.R)},bounds:function(){var a=6378137*Math.PI;return d.bounds([-a,-a],[a,a])}()},d.CRS={latLngToPoint:function(a,b){var c=this.projection.project(a),d=this.scale(b);return this.transformation._transform(c,d)},pointToLatLng:function(a,b){var c=this.scale(b),d=this.transformation.untransform(a,c);return this.projection.unproject(d)},project:function(a){return this.projection.project(a)},unproject:function(a){return this.projection.unproject(a)},scale:function(a){return 256*Math.pow(2,a)},zoom:function(a){return Math.log(a/256)/Math.LN2},getProjectedBounds:function(a){if(this.infinite)return null;var b=this.projection.bounds,c=this.scale(a),e=this.transformation.transform(b.min,c),f=this.transformation.transform(b.max,c);return d.bounds(e,f)},infinite:!1,wrapLatLng:function(a){var b=this.wrapLng?d.Util.wrapNum(a.lng,this.wrapLng,!0):a.lng,c=this.wrapLat?d.Util.wrapNum(a.lat,this.wrapLat,!0):a.lat,e=a.alt;return d.latLng(c,b,e)}},d.CRS.Simple=d.extend({},d.CRS,{projection:d.Projection.LonLat,transformation:new d.Transformation(1,0,-1,0),scale:function(a){return Math.pow(2,a)},zoom:function(a){return Math.log(a)/Math.LN2},distance:function(a,b){var c=b.lng-a.lng,d=b.lat-a.lat;return Math.sqrt(c*c+d*d)},infinite:!0}),d.CRS.Earth=d.extend({},d.CRS,{wrapLng:[-180,180],R:6371e3,distance:function(a,b){var c=Math.PI/180,d=a.lat*c,e=b.lat*c,f=Math.sin(d)*Math.sin(e)+Math.cos(d)*Math.cos(e)*Math.cos((b.lng-a.lng)*c);return this.R*Math.acos(Math.min(f,1))}}),d.CRS.EPSG3857=d.extend({},d.CRS.Earth,{code:"EPSG:3857",projection:d.Projection.SphericalMercator,transformation:function(){var a=.5/(Math.PI*d.Projection.SphericalMercator.R);return new d.Transformation(a,.5,-a,.5)}()}),d.CRS.EPSG900913=d.extend({},d.CRS.EPSG3857,{code:"EPSG:900913"}),d.CRS.EPSG4326=d.extend({},d.CRS.Earth,{code:"EPSG:4326",projection:d.Projection.LonLat,transformation:new d.Transformation(1/180,1,-1/180,.5)}),d.Map=d.Evented.extend({options:{crs:d.CRS.EPSG3857,center:c,zoom:c,minZoom:c,maxZoom:c,layers:[],maxBounds:c,renderer:c,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(a,b){b=d.setOptions(this,b),this._initContainer(a),this._initLayout(),this._onResize=d.bind(this._onResize,this),this._initEvents(),b.maxBounds&&this.setMaxBounds(b.maxBounds),b.zoom!==c&&(this._zoom=this._limitZoom(b.zoom)),b.center&&b.zoom!==c&&this.setView(d.latLng(b.center),b.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this.callInitHooks(),this._addLayers(this.options.layers)},setView:function(a,b){return b=b===c?this.getZoom():b,this._resetView(d.latLng(a),b),this},setZoom:function(a,b){return this._loaded?this.setView(this.getCenter(),a,{zoom:b}):(this._zoom=a,this)},zoomIn:function(a,b){return a=a||(d.Browser.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+a,b)},zoomOut:function(a,b){return a=a||(d.Browser.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-a,b)},setZoomAround:function(a,b,c){var e=this.getZoomScale(b),f=this.getSize().divideBy(2),g=a instanceof d.Point?a:this.latLngToContainerPoint(a),h=g.subtract(f).multiplyBy(1-1/e),i=this.containerPointToLatLng(f.add(h));return this.setView(i,b,{zoom:c})},_getBoundsCenterZoom:function(a,b){b=b||{},a=a.getBounds?a.getBounds():d.latLngBounds(a);var c=d.point(b.paddingTopLeft||b.padding||[0,0]),e=d.point(b.paddingBottomRight||b.padding||[0,0]),f=this.getBoundsZoom(a,!1,c.add(e));f="number"==typeof b.maxZoom?Math.min(b.maxZoom,f):f;var g=e.subtract(c).divideBy(2),h=this.project(a.getSouthWest(),f),i=this.project(a.getNorthEast(),f),j=this.unproject(h.add(i).divideBy(2).add(g),f);return{center:j,zoom:f}},fitBounds:function(a,b){if(a=d.latLngBounds(a),!a.isValid())throw new Error("Bounds are not valid.");var c=this._getBoundsCenterZoom(a,b);return this.setView(c.center,c.zoom,b)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,b){return this.setView(a,this._zoom,{pan:b})},panBy:function(a){return this.fire("movestart"),this._rawPanBy(d.point(a)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(a){return a=d.latLngBounds(a),a.isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=a,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(a){return this.options.minZoom=a,this._loaded&&this.getZoom()<this.options.minZoom?this.setZoom(a):this},setMaxZoom:function(a){return this.options.maxZoom=a,this._loaded&&this.getZoom()>this.options.maxZoom?this.setZoom(a):this},panInsideBounds:function(a,b){this._enforcingBounds=!0;var c=this.getCenter(),e=this._limitCenter(c,this._zoom,d.latLngBounds(a));return c.equals(e)||this.panTo(e,b),this._enforcingBounds=!1,this},invalidateSize:function(a){if(!this._loaded)return this;a=d.extend({animate:!1,pan:!0},a===!0?{animate:!0}:a);var b=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var c=this.getSize(),e=b.divideBy(2).round(),f=c.divideBy(2).round(),g=e.subtract(f);return g.x||g.y?(a.animate&&a.pan?this.panBy(g):(a.pan&&this._rawPanBy(g),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(d.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:b,newSize:c})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},addHandler:function(a,b){if(!b)return this;var c=this[a]=new b(this);return this._handlers.push(c),this.options[a]&&c.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(a){this._container._leaflet_id=c,this._containerId=c}d.DomUtil.remove(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this._loaded&&this.fire("unload");for(var a in this._layers)this._layers[a].remove();return this},createPane:function(a,b){var c="leaflet-pane"+(a?" leaflet-"+a.replace("Pane","")+"-pane":""),e=d.DomUtil.create("div",c,b||this._mapPane);return a&&(this._panes[a]=e),e},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),b=this.unproject(a.getBottomLeft()),c=this.unproject(a.getTopRight());return new d.LatLngBounds(b,c)},getMinZoom:function(){return this.options.minZoom===c?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===c?this._layersMaxZoom===c?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,b,c){a=d.latLngBounds(a),c=d.point(c||[0,0]);var e=this.getZoom()||0,f=this.getMinZoom(),g=this.getMaxZoom(),h=a.getNorthWest(),i=a.getSouthEast(),j=this.getSize().subtract(c),k=this.project(i,e).subtract(this.project(h,e)),l=d.Browser.any3d?this.options.zoomSnap:1,m=Math.min(j.x/k.x,j.y/k.y);return e=this.getScaleZoom(m,e),l&&(e=Math.round(e/(l/100))*(l/100),e=b?Math.ceil(e/l)*l:Math.floor(e/l)*l),Math.max(f,Math.min(g,e))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new d.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(a,b){var c=this._getTopLeftPoint(a,b);return new d.Bounds(c,c.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(a){return this.options.crs.getProjectedBounds(a===c?this.getZoom():a)},getPane:function(a){return"string"==typeof a?this._panes[a]:a},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(a,b){var d=this.options.crs;return b=b===c?this._zoom:b,d.scale(a)/d.scale(b)},getScaleZoom:function(a,b){var d=this.options.crs;b=b===c?this._zoom:b;var e=d.zoom(a*d.scale(b));return isNaN(e)?1/0:e},project:function(a,b){return b=b===c?this._zoom:b,this.options.crs.latLngToPoint(d.latLng(a),b)},unproject:function(a,b){return b=b===c?this._zoom:b,this.options.crs.pointToLatLng(d.point(a),b)},layerPointToLatLng:function(a){var b=d.point(a).add(this.getPixelOrigin());return this.unproject(b)},latLngToLayerPoint:function(a){var b=this.project(d.latLng(a))._round();return b._subtract(this.getPixelOrigin())},wrapLatLng:function(a){return this.options.crs.wrapLatLng(d.latLng(a))},distance:function(a,b){return this.options.crs.distance(d.latLng(a),d.latLng(b))},containerPointToLayerPoint:function(a){return d.point(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return d.point(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){var b=this.containerPointToLayerPoint(d.point(a));return this.layerPointToLatLng(b)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(d.latLng(a)))},mouseEventToContainerPoint:function(a){return d.DomEvent.getMousePosition(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){var b=this._container=d.DomUtil.get(a);if(!b)throw new Error("Map container not found.");if(b._leaflet_id)throw new Error("Map container is already initialized.");d.DomEvent.addListener(b,"scroll",this._onScroll,this),this._containerId=d.Util.stamp(b)},_initLayout:function(){var a=this._container;this._fadeAnimated=this.options.fadeAnimation&&d.Browser.any3d,d.DomUtil.addClass(a,"leaflet-container"+(d.Browser.touch?" leaflet-touch":"")+(d.Browser.retina?" leaflet-retina":"")+(d.Browser.ielt9?" leaflet-oldie":"")+(d.Browser.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var b=d.DomUtil.getStyle(a,"position");"absolute"!==b&&"relative"!==b&&"fixed"!==b&&(a.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),d.DomUtil.setPosition(this._mapPane,new d.Point(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(d.DomUtil.addClass(a.markerPane,"leaflet-zoom-hide"),d.DomUtil.addClass(a.shadowPane,"leaflet-zoom-hide"))},_resetView:function(a,b){d.DomUtil.setPosition(this._mapPane,new d.Point(0,0));var c=!this._loaded;this._loaded=!0,b=this._limitZoom(b),this.fire("viewprereset");var e=this._zoom!==b;this._moveStart(e)._move(a,b)._moveEnd(e),this.fire("viewreset"),c&&this.fire("load")},_moveStart:function(a){return a&&this.fire("zoomstart"),this.fire("movestart")},_move:function(a,b,d){b===c&&(b=this._zoom);var e=this._zoom!==b;return this._zoom=b,this._lastCenter=a,this._pixelOrigin=this._getNewPixelOrigin(a),(e||d&&d.pinch)&&this.fire("zoom",d),this.fire("move",d)},_moveEnd:function(a){return a&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return d.Util.cancelAnimFrame(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(a){d.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(b){if(d.DomEvent){this._targets={},this._targets[d.stamp(this._container)]=this;var c=b?"off":"on";d.DomEvent[c](this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this),this.options.trackResize&&d.DomEvent[c](a,"resize",this._onResize,this),d.Browser.any3d&&this.options.transform3DLimit&&this[c]("moveend",this._onMoveEnd)}},_onResize:function(){d.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=d.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var a=this._getMapPanePos();Math.max(Math.abs(a.x),Math.abs(a.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(a,b){for(var e,c=[],f="mouseout"===b||"mouseover"===b,g=a.target||a.srcElement,h=!1;g;){if(e=this._targets[d.stamp(g)],e&&("click"===b||"preclick"===b)&&!a._simulated&&this._draggableMoved(e)){h=!0;break}if(e&&e.listens(b,!0)){if(f&&!d.DomEvent._isExternalTarget(g,a))break;if(c.push(e),f)break}if(g===this._container)break;g=g.parentNode}return c.length||h||f||!d.DomEvent._isExternalTarget(g,a)||(c=[this]),c},_handleDOMEvent:function(a){if(this._loaded&&!d.DomEvent._skipped(a)){var b="keypress"===a.type&&13===a.keyCode?"click":a.type;"mousedown"===b&&d.DomUtil.preventOutline(a.target||a.srcElement),this._fireDOMEvent(a,b)}},_fireDOMEvent:function(a,b,c){if("click"===a.type){var e=d.Util.extend({},a);e.type="preclick",this._fireDOMEvent(e,e.type,c)}if(!a._stopped&&(c=(c||[]).concat(this._findEventTargets(a,b)),c.length)){var f=c[0];"contextmenu"===b&&f.listens(b,!0)&&d.DomEvent.preventDefault(a);var g={originalEvent:a};if("keypress"!==a.type){var h=f instanceof d.Marker;g.containerPoint=h?this.latLngToContainerPoint(f.getLatLng()):this.mouseEventToContainerPoint(a),g.layerPoint=this.containerPointToLayerPoint(g.containerPoint),g.latlng=h?f.getLatLng():this.layerPointToLatLng(g.layerPoint);
}for(var i=0;i<c.length;i++)if(c[i].fire(b,g,!0),g.originalEvent._stopped||c[i].options.nonBubblingEvents&&d.Util.indexOf(c[i].options.nonBubblingEvents,b)!==-1)return}},_draggableMoved:function(a){return a=a.dragging&&a.dragging.enabled()?a:this,a.dragging&&a.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var a=0,b=this._handlers.length;a<b;a++)this._handlers[a].disable()},whenReady:function(a,b){return this._loaded?a.call(b||this,{target:this}):this.on("load",a,b),this},_getMapPanePos:function(){return d.DomUtil.getPosition(this._mapPane)||new d.Point(0,0)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(a,b){var d=a&&b!==c?this._getNewPixelOrigin(a,b):this.getPixelOrigin();return d.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(a,b){var c=this.getSize()._divideBy(2);return this.project(a,b)._subtract(c)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(a,b,c){var d=this._getNewPixelOrigin(c,b);return this.project(a,b)._subtract(d)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,b,c){if(!c)return a;var e=this.project(a,b),f=this.getSize().divideBy(2),g=new d.Bounds(e.subtract(f),e.add(f)),h=this._getBoundsOffset(g,c,b);return h.round().equals([0,0])?a:this.unproject(e.add(h),b)},_limitOffset:function(a,b){if(!b)return a;var c=this.getPixelBounds(),e=new d.Bounds(c.min.add(a),c.max.add(a));return a.add(this._getBoundsOffset(e,b))},_getBoundsOffset:function(a,b,c){var e=d.bounds(this.project(b.getNorthEast(),c),this.project(b.getSouthWest(),c)),f=e.min.subtract(a.min),g=e.max.subtract(a.max),h=this._rebound(f.x,-g.x),i=this._rebound(f.y,-g.y);return new d.Point(h,i)},_rebound:function(a,b){return a+b>0?Math.round(a-b)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(b))},_limitZoom:function(a){var b=this.getMinZoom(),c=this.getMaxZoom(),e=d.Browser.any3d?this.options.zoomSnap:1;return e&&(a=Math.round(a/e)*e),Math.max(b,Math.min(c,a))}}),d.map=function(a,b){return new d.Map(a,b)},d.Layer=d.Evented.extend({options:{pane:"overlayPane",nonBubblingEvents:[]},addTo:function(a){return a.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(a){return a&&a.removeLayer(this),this},getPane:function(a){return this._map.getPane(a?this.options[a]||a:this.options.pane)},addInteractiveTarget:function(a){return this._map._targets[d.stamp(a)]=this,this},removeInteractiveTarget:function(a){return delete this._map._targets[d.stamp(a)],this},_layerAdd:function(a){var b=a.target;if(b.hasLayer(this)){if(this._map=b,this._zoomAnimated=b._zoomAnimated,this.getEvents){var c=this.getEvents();b.on(c,this),this.once("remove",function(){b.off(c,this)},this)}this.onAdd(b),this.getAttribution&&this._map.attributionControl&&this._map.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),b.fire("layeradd",{layer:this})}}}),d.Map.include({addLayer:function(a){var b=d.stamp(a);return this._layers[b]?this:(this._layers[b]=a,a._mapToAdd=this,a.beforeAdd&&a.beforeAdd(this),this.whenReady(a._layerAdd,a),this)},removeLayer:function(a){var b=d.stamp(a);return this._layers[b]?(this._loaded&&a.onRemove(this),a.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(a.getAttribution()),delete this._layers[b],this._loaded&&(this.fire("layerremove",{layer:a}),a.fire("remove")),a._map=a._mapToAdd=null,this):this},hasLayer:function(a){return!!a&&d.stamp(a)in this._layers},eachLayer:function(a,b){for(var c in this._layers)a.call(b,this._layers[c]);return this},_addLayers:function(a){a=a?d.Util.isArray(a)?a:[a]:[];for(var b=0,c=a.length;b<c;b++)this.addLayer(a[b])},_addZoomLimit:function(a){!isNaN(a.options.maxZoom)&&isNaN(a.options.minZoom)||(this._zoomBoundLayers[d.stamp(a)]=a,this._updateZoomLevels())},_removeZoomLimit:function(a){var b=d.stamp(a);this._zoomBoundLayers[b]&&(delete this._zoomBoundLayers[b],this._updateZoomLevels())},_updateZoomLevels:function(){var a=1/0,b=-(1/0),d=this._getZoomSpan();for(var e in this._zoomBoundLayers){var f=this._zoomBoundLayers[e].options;a=f.minZoom===c?a:Math.min(a,f.minZoom),b=f.maxZoom===c?b:Math.max(b,f.maxZoom)}this._layersMaxZoom=b===-(1/0)?c:b,this._layersMinZoom=a===1/0?c:a,d!==this._getZoomSpan()&&this.fire("zoomlevelschange")}}),d.Projection.Mercator={R:6378137,R_MINOR:6356752.314245179,bounds:d.bounds([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(a){var b=Math.PI/180,c=this.R,e=a.lat*b,f=this.R_MINOR/c,g=Math.sqrt(1-f*f),h=g*Math.sin(e),i=Math.tan(Math.PI/4-e/2)/Math.pow((1-h)/(1+h),g/2);return e=-c*Math.log(Math.max(i,1e-10)),new d.Point(a.lng*b*c,e)},unproject:function(a){for(var k,b=180/Math.PI,c=this.R,e=this.R_MINOR/c,f=Math.sqrt(1-e*e),g=Math.exp(-a.y/c),h=Math.PI/2-2*Math.atan(g),i=0,j=.1;i<15&&Math.abs(j)>1e-7;i++)k=f*Math.sin(h),k=Math.pow((1-k)/(1+k),f/2),j=Math.PI/2-2*Math.atan(g*k)-h,h+=j;return new d.LatLng(h*b,a.x*b/c)}},d.CRS.EPSG3395=d.extend({},d.CRS.Earth,{code:"EPSG:3395",projection:d.Projection.Mercator,transformation:function(){var a=.5/(Math.PI*d.Projection.Mercator.R);return new d.Transformation(a,.5,-a,.5)}()}),d.GridLayer=d.Layer.extend({options:{tileSize:256,opacity:1,updateWhenIdle:d.Browser.mobile,updateWhenZooming:!0,updateInterval:200,attribution:null,zIndex:1,bounds:null,minZoom:0,maxZoom:c,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(a){d.setOptions(this,a)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(a){a._addZoomLimit(this)},onRemove:function(a){this._removeAllTiles(),d.DomUtil.remove(this._container),a._removeZoomLimit(this),this._container=null,this._tileZoom=null},bringToFront:function(){return this._map&&(d.DomUtil.toFront(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(d.DomUtil.toBack(this._container),this._setAutoZIndex(Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(a){return this.options.opacity=a,this._updateOpacity(),this},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var a={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),a.move=this._onMove),this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},createTile:function(){return b.createElement("div")},getTileSize:function(){var a=this.options.tileSize;return a instanceof d.Point?a:new d.Point(a,a)},_updateZIndex:function(){this._container&&this.options.zIndex!==c&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a){for(var f,b=this.getPane().children,c=-a(-(1/0),1/0),d=0,e=b.length;d<e;d++)f=b[d].style.zIndex,b[d]!==this._container&&f&&(c=a(c,+f));isFinite(c)&&(this.options.zIndex=c+a(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!d.Browser.ielt9){d.DomUtil.setOpacity(this._container,this.options.opacity);var a=+new Date,b=!1,c=!1;for(var e in this._tiles){var f=this._tiles[e];if(f.current&&f.loaded){var g=Math.min(1,(a-f.loaded)/200);d.DomUtil.setOpacity(f.el,g),g<1?b=!0:(f.active&&(c=!0),f.active=!0)}}c&&!this._noPrune&&this._pruneTiles(),b&&(d.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=d.Util.requestAnimFrame(this._updateOpacity,this))}},_initContainer:function(){this._container||(this._container=d.DomUtil.create("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var a=this._tileZoom,b=this.options.maxZoom;if(a===c)return c;for(var e in this._levels)this._levels[e].el.children.length||e===a?this._levels[e].el.style.zIndex=b-Math.abs(a-e):(d.DomUtil.remove(this._levels[e].el),this._removeTilesAtZoom(e),delete this._levels[e]);var f=this._levels[a],g=this._map;return f||(f=this._levels[a]={},f.el=d.DomUtil.create("div","leaflet-tile-container leaflet-zoom-animated",this._container),f.el.style.zIndex=b,f.origin=g.project(g.unproject(g.getPixelOrigin()),a).round(),f.zoom=a,this._setZoomTransform(f,g.getCenter(),g.getZoom()),d.Util.falseFn(f.el.offsetWidth)),this._level=f,f},_pruneTiles:function(){if(this._map){var a,b,c=this._map.getZoom();if(c>this.options.maxZoom||c<this.options.minZoom)return void this._removeAllTiles();for(a in this._tiles)b=this._tiles[a],b.retain=b.current;for(a in this._tiles)if(b=this._tiles[a],b.current&&!b.active){var d=b.coords;this._retainParent(d.x,d.y,d.z,d.z-5)||this._retainChildren(d.x,d.y,d.z,d.z+2)}for(a in this._tiles)this._tiles[a].retain||this._removeTile(a)}},_removeTilesAtZoom:function(a){for(var b in this._tiles)this._tiles[b].coords.z===a&&this._removeTile(b)},_removeAllTiles:function(){for(var a in this._tiles)this._removeTile(a)},_invalidateAll:function(){for(var a in this._levels)d.DomUtil.remove(this._levels[a].el),delete this._levels[a];this._removeAllTiles(),this._tileZoom=null},_retainParent:function(a,b,c,e){var f=Math.floor(a/2),g=Math.floor(b/2),h=c-1,i=new d.Point(+f,+g);i.z=+h;var j=this._tileCoordsToKey(i),k=this._tiles[j];return k&&k.active?(k.retain=!0,!0):(k&&k.loaded&&(k.retain=!0),h>e&&this._retainParent(f,g,h,e))},_retainChildren:function(a,b,c,e){for(var f=2*a;f<2*a+2;f++)for(var g=2*b;g<2*b+2;g++){var h=new d.Point(f,g);h.z=c+1;var i=this._tileCoordsToKey(h),j=this._tiles[i];j&&j.active?j.retain=!0:(j&&j.loaded&&(j.retain=!0),c+1<e&&this._retainChildren(f,g,c+1,e))}},_resetView:function(a){var b=a&&(a.pinch||a.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),b,b)},_animateZoom:function(a){this._setView(a.center,a.zoom,!0,a.noUpdate)},_setView:function(a,b,d,e){var f=Math.round(b);(this.options.maxZoom!==c&&f>this.options.maxZoom||this.options.minZoom!==c&&f<this.options.minZoom)&&(f=c);var g=this.options.updateWhenZooming&&f!==this._tileZoom;e&&!g||(this._tileZoom=f,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),f!==c&&this._update(a),d||this._pruneTiles(),this._noPrune=!!d),this._setZoomTransforms(a,b)},_setZoomTransforms:function(a,b){for(var c in this._levels)this._setZoomTransform(this._levels[c],a,b)},_setZoomTransform:function(a,b,c){var e=this._map.getZoomScale(c,a.zoom),f=a.origin.multiplyBy(e).subtract(this._map._getNewPixelOrigin(b,c)).round();d.Browser.any3d?d.DomUtil.setTransform(a.el,f,e):d.DomUtil.setPosition(a.el,f)},_resetGrid:function(){var a=this._map,b=a.options.crs,c=this._tileSize=this.getTileSize(),d=this._tileZoom,e=this._map.getPixelWorldBounds(this._tileZoom);e&&(this._globalTileRange=this._pxBoundsToTileRange(e)),this._wrapX=b.wrapLng&&!this.options.noWrap&&[Math.floor(a.project([0,b.wrapLng[0]],d).x/c.x),Math.ceil(a.project([0,b.wrapLng[1]],d).x/c.y)],this._wrapY=b.wrapLat&&!this.options.noWrap&&[Math.floor(a.project([b.wrapLat[0],0],d).y/c.x),Math.ceil(a.project([b.wrapLat[1],0],d).y/c.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(a){var b=this._map,c=b._animatingZoom?Math.max(b._animateToZoom,b.getZoom()):b.getZoom(),e=b.getZoomScale(c,this._tileZoom),f=b.project(a,this._tileZoom).floor(),g=b.getSize().divideBy(2*e);return new d.Bounds(f.subtract(g),f.add(g))},_update:function(a){var e=this._map;if(e){var f=e.getZoom();if(a===c&&(a=e.getCenter()),this._tileZoom!==c){var g=this._getTiledPixelBounds(a),h=this._pxBoundsToTileRange(g),i=h.getCenter(),j=[],k=this.options.keepBuffer,l=new d.Bounds(h.getBottomLeft().subtract([k,-k]),h.getTopRight().add([k,-k]));for(var m in this._tiles){var n=this._tiles[m].coords;n.z===this._tileZoom&&l.contains(d.point(n.x,n.y))||(this._tiles[m].current=!1)}if(Math.abs(f-this._tileZoom)>1)return void this._setView(a,f);for(var o=h.min.y;o<=h.max.y;o++)for(var p=h.min.x;p<=h.max.x;p++){var q=new d.Point(p,o);if(q.z=this._tileZoom,this._isValidTile(q)){var r=this._tiles[this._tileCoordsToKey(q)];r?r.current=!0:j.push(q)}}if(j.sort(function(a,b){return a.distanceTo(i)-b.distanceTo(i)}),0!==j.length){this._loading||(this._loading=!0,this.fire("loading"));var s=b.createDocumentFragment();for(p=0;p<j.length;p++)this._addTile(j[p],s);this._level.el.appendChild(s)}}}},_isValidTile:function(a){var b=this._map.options.crs;if(!b.infinite){var c=this._globalTileRange;if(!b.wrapLng&&(a.x<c.min.x||a.x>c.max.x)||!b.wrapLat&&(a.y<c.min.y||a.y>c.max.y))return!1}if(!this.options.bounds)return!0;var e=this._tileCoordsToBounds(a);return d.latLngBounds(this.options.bounds).overlaps(e)},_keyToBounds:function(a){return this._tileCoordsToBounds(this._keyToTileCoords(a))},_tileCoordsToBounds:function(a){var b=this._map,c=this.getTileSize(),e=a.scaleBy(c),f=e.add(c),g=b.unproject(e,a.z),h=b.unproject(f,a.z);return this.options.noWrap||(g=b.wrapLatLng(g),h=b.wrapLatLng(h)),new d.LatLngBounds(g,h)},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z},_keyToTileCoords:function(a){var b=a.split(":"),c=new d.Point(+b[0],+b[1]);return c.z=+b[2],c},_removeTile:function(a){var b=this._tiles[a];b&&(d.DomUtil.remove(b.el),delete this._tiles[a],this.fire("tileunload",{tile:b.el,coords:this._keyToTileCoords(a)}))},_initTile:function(a){d.DomUtil.addClass(a,"leaflet-tile");var b=this.getTileSize();a.style.width=b.x+"px",a.style.height=b.y+"px",a.onselectstart=d.Util.falseFn,a.onmousemove=d.Util.falseFn,d.Browser.ielt9&&this.options.opacity<1&&d.DomUtil.setOpacity(a,this.options.opacity),d.Browser.android&&!d.Browser.android23&&(a.style.WebkitBackfaceVisibility="hidden")},_addTile:function(a,b){var c=this._getTilePos(a),e=this._tileCoordsToKey(a),f=this.createTile(this._wrapCoords(a),d.bind(this._tileReady,this,a));this._initTile(f),this.createTile.length<2&&d.Util.requestAnimFrame(d.bind(this._tileReady,this,a,null,f)),d.DomUtil.setPosition(f,c),this._tiles[e]={el:f,coords:a,current:!0},b.appendChild(f),this.fire("tileloadstart",{tile:f,coords:a})},_tileReady:function(a,b,c){if(this._map){b&&this.fire("tileerror",{error:b,tile:c,coords:a});var e=this._tileCoordsToKey(a);c=this._tiles[e],c&&(c.loaded=+new Date,this._map._fadeAnimated?(d.DomUtil.setOpacity(c.el,0),d.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=d.Util.requestAnimFrame(this._updateOpacity,this)):(c.active=!0,this._pruneTiles()),d.DomUtil.addClass(c.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:c.el,coords:a}),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),d.Browser.ielt9||!this._map._fadeAnimated?d.Util.requestAnimFrame(this._pruneTiles,this):setTimeout(d.bind(this._pruneTiles,this),250)))}},_getTilePos:function(a){return a.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(a){var b=new d.Point(this._wrapX?d.Util.wrapNum(a.x,this._wrapX):a.x,this._wrapY?d.Util.wrapNum(a.y,this._wrapY):a.y);return b.z=a.z,b},_pxBoundsToTileRange:function(a){var b=this.getTileSize();return new d.Bounds(a.min.unscaleBy(b).floor(),a.max.unscaleBy(b).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0}}),d.gridLayer=function(a){return new d.GridLayer(a)},d.TileLayer=d.GridLayer.extend({options:{minZoom:0,maxZoom:18,maxNativeZoom:null,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(a,b){this._url=a,b=d.setOptions(this,b),b.detectRetina&&d.Browser.retina&&b.maxZoom>0&&(b.tileSize=Math.floor(b.tileSize/2),b.zoomReverse?(b.zoomOffset--,b.minZoom++):(b.zoomOffset++,b.maxZoom--),b.minZoom=Math.max(0,b.minZoom)),"string"==typeof b.subdomains&&(b.subdomains=b.subdomains.split("")),d.Browser.android||this.on("tileunload",this._onTileRemove)},setUrl:function(a,b){return this._url=a,b||this.redraw(),this},createTile:function(a,c){var e=b.createElement("img");return d.DomEvent.on(e,"load",d.bind(this._tileOnLoad,this,c,e)),d.DomEvent.on(e,"error",d.bind(this._tileOnError,this,c,e)),this.options.crossOrigin&&(e.crossOrigin=""),e.alt="",e.src=this.getTileUrl(a),e},getTileUrl:function(a){var b={r:d.Browser.retina?"@2x":"",s:this._getSubdomain(a),x:a.x,y:a.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var c=this._globalTileRange.max.y-a.y;this.options.tms&&(b.y=c),b["-y"]=c}return d.Util.template(this._url,d.extend(b,this.options))},_tileOnLoad:function(a,b){d.Browser.ielt9?setTimeout(d.bind(a,this,null,b),0):a(null,b)},_tileOnError:function(a,b,c){var d=this.options.errorTileUrl;d&&(b.src=d),a(c,b)},getTileSize:function(){var a=this._map,b=d.GridLayer.prototype.getTileSize.call(this),c=this._tileZoom+this.options.zoomOffset,e=this.options.maxNativeZoom;return null!==e&&c>e?b.divideBy(a.getZoomScale(e,c)).round():b},_onTileRemove:function(a){a.tile.onload=null},_getZoomForUrl:function(){var a=this.options,b=this._tileZoom;return a.zoomReverse&&(b=a.maxZoom-b),b+=a.zoomOffset,null!==a.maxNativeZoom?Math.min(b,a.maxNativeZoom):b},_getSubdomain:function(a){var b=Math.abs(a.x+a.y)%this.options.subdomains.length;return this.options.subdomains[b]},_abortLoading:function(){var a,b;for(a in this._tiles)this._tiles[a].coords.z!==this._tileZoom&&(b=this._tiles[a].el,b.onload=d.Util.falseFn,b.onerror=d.Util.falseFn,b.complete||(b.src=d.Util.emptyImageUrl,d.DomUtil.remove(b)))}}),d.tileLayer=function(a,b){return new d.TileLayer(a,b)},d.TileLayer.WMS=d.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(a,b){this._url=a;var c=d.extend({},this.defaultWmsParams);for(var e in b)e in this.options||(c[e]=b[e]);b=d.setOptions(this,b),c.width=c.height=b.tileSize*(b.detectRetina&&d.Browser.retina?2:1),this.wmsParams=c},onAdd:function(a){this._crs=this.options.crs||a.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var b=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[b]=this._crs.code,d.TileLayer.prototype.onAdd.call(this,a)},getTileUrl:function(a){var b=this._tileCoordsToBounds(a),c=this._crs.project(b.getNorthWest()),e=this._crs.project(b.getSouthEast()),f=(this._wmsVersion>=1.3&&this._crs===d.CRS.EPSG4326?[e.y,c.x,c.y,e.x]:[c.x,e.y,e.x,c.y]).join(","),g=d.TileLayer.prototype.getTileUrl.call(this,a);return g+d.Util.getParamString(this.wmsParams,g,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+f},setParams:function(a,b){return d.extend(this.wmsParams,a),b||this.redraw(),this}}),d.tileLayer.wms=function(a,b){return new d.TileLayer.WMS(a,b)},d.ImageOverlay=d.Layer.extend({options:{opacity:1,alt:"",interactive:!1,attribution:null,crossOrigin:!1},initialize:function(a,b,c){this._url=a,this._bounds=d.latLngBounds(b),d.setOptions(this,c)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(d.DomUtil.addClass(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){d.DomUtil.remove(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(a){return this.options.opacity=a,this._image&&this._updateOpacity(),this},setStyle:function(a){return a.opacity&&this.setOpacity(a.opacity),this},bringToFront:function(){return this._map&&d.DomUtil.toFront(this._image),this},bringToBack:function(){return this._map&&d.DomUtil.toBack(this._image),this},setUrl:function(a){return this._url=a,this._image&&(this._image.src=a),this},setBounds:function(a){return this._bounds=a,this._map&&this._reset(),this},getAttribution:function(){return this.options.attribution},getEvents:function(){var a={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var a=this._image=d.DomUtil.create("img","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":""));a.onselectstart=d.Util.falseFn,a.onmousemove=d.Util.falseFn,a.onload=d.bind(this.fire,this,"load"),this.options.crossOrigin&&(a.crossOrigin=""),a.src=this._url,a.alt=this.options.alt},_animateZoom:function(a){var b=this._map.getZoomScale(a.zoom),c=this._map._latLngToNewLayerPoint(this._bounds.getNorthWest(),a.zoom,a.center);d.DomUtil.setTransform(this._image,c,b)},_reset:function(){var a=this._image,b=new d.Bounds(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),c=b.getSize();d.DomUtil.setPosition(a,b.min),a.style.width=c.x+"px",a.style.height=c.y+"px"},_updateOpacity:function(){d.DomUtil.setOpacity(this._image,this.options.opacity)}}),d.imageOverlay=function(a,b,c){return new d.ImageOverlay(a,b,c)},d.Icon=d.Class.extend({initialize:function(a){d.setOptions(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,b){var c=this._getIconUrl(a);if(!c){if("icon"===a)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var d=this._createImg(c,b&&"IMG"===b.tagName?b:null);return this._setIconStyles(d,a),d},_setIconStyles:function(a,b){var c=this.options,e=c[b+"Size"];"number"==typeof e&&(e=[e,e]);var f=d.point(e),g=d.point("shadow"===b&&c.shadowAnchor||c.iconAnchor||f&&f.divideBy(2,!0));a.className="leaflet-marker-"+b+" "+(c.className||""),g&&(a.style.marginLeft=-g.x+"px",a.style.marginTop=-g.y+"px"),f&&(a.style.width=f.x+"px",a.style.height=f.y+"px")},_createImg:function(a,c){return c=c||b.createElement("img"),c.src=a,c},_getIconUrl:function(a){return d.Browser.retina&&this.options[a+"RetinaUrl"]||this.options[a+"Url"]}}),d.icon=function(a){return new d.Icon(a)},d.Icon.Default=d.Icon.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(a){return d.Icon.Default.imagePath||(d.Icon.Default.imagePath=this._detectIconPath()),(this.options.imagePath||d.Icon.Default.imagePath)+d.Icon.prototype._getIconUrl.call(this,a)},_detectIconPath:function(){var a=d.DomUtil.create("div","leaflet-default-icon-path",b.body),c=d.DomUtil.getStyle(a,"background-image")||d.DomUtil.getStyle(a,"backgroundImage");return b.body.removeChild(a),0===c.indexOf("url")?c.replace(/^url\([\"\']?/,"").replace(/[\"\']?\)$/,""):""}}),d.Marker=d.Layer.extend({options:{icon:new d.Icon.Default,interactive:!0,draggable:!1,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",nonBubblingEvents:["click","dblclick","mouseover","mouseout","contextmenu"]},initialize:function(a,b){d.setOptions(this,b),this._latlng=d.latLng(a)},onAdd:function(a){this._zoomAnimated=this._zoomAnimated&&a.options.markerZoomAnimation,this._zoomAnimated&&a.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(a){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),this._zoomAnimated&&a.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(a){var b=this._latlng;return this._latlng=d.latLng(a),this.update(),this.fire("move",{oldLatLng:b,latlng:this._latlng})},setZIndexOffset:function(a){return this.options.zIndexOffset=a,this.update()},setIcon:function(a){return this.options.icon=a,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon){var a=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(a)}return this},_initIcon:function(){var a=this.options,b="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),c=a.icon.createIcon(this._icon),e=!1;c!==this._icon&&(this._icon&&this._removeIcon(),e=!0,a.title&&(c.title=a.title),a.alt&&(c.alt=a.alt)),d.DomUtil.addClass(c,b),a.keyboard&&(c.tabIndex="0"),this._icon=c,a.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var f=a.icon.createShadow(this._shadow),g=!1;f!==this._shadow&&(this._removeShadow(),g=!0),f&&d.DomUtil.addClass(f,b),this._shadow=f,a.opacity<1&&this._updateOpacity(),e&&this.getPane().appendChild(this._icon),this._initInteraction(),f&&g&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),d.DomUtil.remove(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&d.DomUtil.remove(this._shadow),this._shadow=null},_setPos:function(a){d.DomUtil.setPosition(this._icon,a),this._shadow&&d.DomUtil.setPosition(this._shadow,a),this._zIndex=a.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(a){this._icon.style.zIndex=this._zIndex+a},_animateZoom:function(a){var b=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(b)},_initInteraction:function(){if(this.options.interactive&&(d.DomUtil.addClass(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),d.Handler.MarkerDrag)){var a=this.options.draggable;this.dragging&&(a=this.dragging.enabled(),this.dragging.disable()),this.dragging=new d.Handler.MarkerDrag(this),a&&this.dragging.enable()}},setOpacity:function(a){return this.options.opacity=a,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var a=this.options.opacity;d.DomUtil.setOpacity(this._icon,a),this._shadow&&d.DomUtil.setOpacity(this._shadow,a)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),d.marker=function(a,b){return new d.Marker(a,b)},d.DivIcon=d.Icon.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(a){var c=a&&"DIV"===a.tagName?a:b.createElement("div"),e=this.options;if(c.innerHTML=e.html!==!1?e.html:"",e.bgPos){var f=d.point(e.bgPos);c.style.backgroundPosition=-f.x+"px "+-f.y+"px"}return this._setIconStyles(c,"icon"),c},createShadow:function(){return null}}),d.divIcon=function(a){return new d.DivIcon(a)},d.DivOverlay=d.Layer.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(a,b){d.setOptions(this,a),this._source=b},onAdd:function(a){this._zoomAnimated=a._zoomAnimated,this._container||this._initLayout(),a._fadeAnimated&&d.DomUtil.setOpacity(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),a._fadeAnimated&&d.DomUtil.setOpacity(this._container,1),this.bringToFront()},onRemove:function(a){a._fadeAnimated?(d.DomUtil.setOpacity(this._container,0),this._removeTimeout=setTimeout(d.bind(d.DomUtil.remove,d.DomUtil,this._container),200)):d.DomUtil.remove(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(a){return this._latlng=d.latLng(a),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(a){return this._content=a,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var a={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&d.DomUtil.toFront(this._container),this},bringToBack:function(){return this._map&&d.DomUtil.toBack(this._container),this},_updateContent:function(){if(this._content){var a=this._contentNode,b="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof b)a.innerHTML=b;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(b)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),b=d.point(this.options.offset),c=this._getAnchor();this._zoomAnimated?d.DomUtil.setPosition(this._container,a.add(c)):b=b.add(a).add(c);var e=this._containerBottom=-b.y,f=this._containerLeft=-Math.round(this._containerWidth/2)+b.x;this._container.style.bottom=e+"px",this._container.style.left=f+"px"}},_getAnchor:function(){return[0,0]}}),d.Popup=d.DivOverlay.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,className:""},openOn:function(a){return a.openPopup(this),this},onAdd:function(a){d.DivOverlay.prototype.onAdd.call(this,a),a.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof d.Path||this._source.on("preclick",d.DomEvent.stopPropagation))},onRemove:function(a){d.DivOverlay.prototype.onRemove.call(this,a),a.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof d.Path||this._source.off("preclick",d.DomEvent.stopPropagation))},getEvents:function(){var a=d.DivOverlay.prototype.getEvents.call(this);return("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(a.preclick=this._close),this.options.keepInView&&(a.moveend=this._adjustPan),a},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var a="leaflet-popup",b=this._container=d.DomUtil.create("div",a+" "+(this.options.className||"")+" leaflet-zoom-animated");if(this.options.closeButton){var c=this._closeButton=d.DomUtil.create("a",a+"-close-button",b);c.href="#close",c.innerHTML="&#215;",d.DomEvent.on(c,"click",this._onCloseButtonClick,this)}var e=this._wrapper=d.DomUtil.create("div",a+"-content-wrapper",b);this._contentNode=d.DomUtil.create("div",a+"-content",e),d.DomEvent.disableClickPropagation(e).disableScrollPropagation(this._contentNode).on(e,"contextmenu",d.DomEvent.stopPropagation),this._tipContainer=d.DomUtil.create("div",a+"-tip-container",b),this._tip=d.DomUtil.create("div",a+"-tip",this._tipContainer)},_updateLayout:function(){var a=this._contentNode,b=a.style;b.width="",b.whiteSpace="nowrap";var c=a.offsetWidth;c=Math.min(c,this.options.maxWidth),c=Math.max(c,this.options.minWidth),b.width=c+1+"px",b.whiteSpace="",b.height="";var e=a.offsetHeight,f=this.options.maxHeight,g="leaflet-popup-scrolled";f&&e>f?(b.height=f+"px",d.DomUtil.addClass(a,g)):d.DomUtil.removeClass(a,g),this._containerWidth=this._container.offsetWidth},_animateZoom:function(a){var b=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center),c=this._getAnchor();d.DomUtil.setPosition(this._container,b.add(c))},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var a=this._map,b=parseInt(d.DomUtil.getStyle(this._container,"marginBottom"),10)||0,c=this._container.offsetHeight+b,e=this._containerWidth,f=new d.Point(this._containerLeft,-c-this._containerBottom);f._add(d.DomUtil.getPosition(this._container));var g=a.layerPointToContainerPoint(f),h=d.point(this.options.autoPanPadding),i=d.point(this.options.autoPanPaddingTopLeft||h),j=d.point(this.options.autoPanPaddingBottomRight||h),k=a.getSize(),l=0,m=0;
g.x+e+j.x>k.x&&(l=g.x+e-k.x+j.x),g.x-l-i.x<0&&(l=g.x-i.x),g.y+c+j.y>k.y&&(m=g.y+c-k.y+j.y),g.y-m-i.y<0&&(m=g.y-i.y),(l||m)&&a.fire("autopanstart").panBy([l,m])}},_onCloseButtonClick:function(a){this._close(),d.DomEvent.stop(a)},_getAnchor:function(){return d.point(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),d.popup=function(a,b){return new d.Popup(a,b)},d.Map.mergeOptions({closePopupOnClick:!0}),d.Map.include({openPopup:function(a,b,c){return a instanceof d.Popup||(a=new d.Popup(c).setContent(a)),b&&a.setLatLng(b),this.hasLayer(a)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=a,this.addLayer(a))},closePopup:function(a){return a&&a!==this._popup||(a=this._popup,this._popup=null),a&&this.removeLayer(a),this}}),d.Layer.include({bindPopup:function(a,b){return a instanceof d.Popup?(d.setOptions(a,b),this._popup=a,a._source=this):(this._popup&&!b||(this._popup=new d.Popup(b,this)),this._popup.setContent(a)),this._popupHandlersAdded||(this.on({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(a,b){if(a instanceof d.Layer||(b=a,a=this),a instanceof d.FeatureGroup)for(var c in this._layers){a=this._layers[c];break}return b||(b=a.getCenter?a.getCenter():a.getLatLng()),this._popup&&this._map&&(this._popup._source=a,this._popup.update(),this._map.openPopup(this._popup,b)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(a){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(a)),this},isPopupOpen:function(){return this._popup.isOpen()},setPopupContent:function(a){return this._popup&&this._popup.setContent(a),this},getPopup:function(){return this._popup},_openPopup:function(a){var b=a.layer||a.target;if(this._popup&&this._map)return d.DomEvent.stop(a),b instanceof d.Path?void this.openPopup(a.layer||a.target,a.latlng):void(this._map.hasLayer(this._popup)&&this._popup._source===b?this.closePopup():this.openPopup(b,a.latlng))},_movePopup:function(a){this._popup.setLatLng(a.latlng)}}),d.Marker.include({_getPopupAnchor:function(){return this.options.icon.options.popupAnchor||[0,0]}}),d.Tooltip=d.DivOverlay.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(a){d.DivOverlay.prototype.onAdd.call(this,a),this.setOpacity(this.options.opacity),a.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(a){d.DivOverlay.prototype.onRemove.call(this,a),a.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var a=d.DivOverlay.prototype.getEvents.call(this);return d.Browser.touch&&!this.options.permanent&&(a.preclick=this._close),a},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var a="leaflet-tooltip",b=a+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=d.DomUtil.create("div",b)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(a){var b=this._map,c=this._container,e=b.latLngToContainerPoint(b.getCenter()),f=b.layerPointToContainerPoint(a),g=this.options.direction,h=c.offsetWidth,i=c.offsetHeight,j=d.point(this.options.offset),k=this._getAnchor();"top"===g?a=a.add(d.point(-h/2+j.x,-i+j.y+k.y)):"bottom"===g?a=a.subtract(d.point(h/2-j.x,-j.y)):"center"===g?a=a.subtract(d.point(h/2+j.x,i/2-k.y+j.y)):"right"===g||"auto"===g&&f.x<e.x?(g="right",a=a.add([j.x+k.x,k.y-i/2+j.y])):(g="left",a=a.subtract(d.point(h+k.x-j.x,i/2-k.y-j.y))),d.DomUtil.removeClass(c,"leaflet-tooltip-right"),d.DomUtil.removeClass(c,"leaflet-tooltip-left"),d.DomUtil.removeClass(c,"leaflet-tooltip-top"),d.DomUtil.removeClass(c,"leaflet-tooltip-bottom"),d.DomUtil.addClass(c,"leaflet-tooltip-"+g),d.DomUtil.setPosition(c,a)},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._setPosition(a)},setOpacity:function(a){this.options.opacity=a,this._container&&d.DomUtil.setOpacity(this._container,a)},_animateZoom:function(a){var b=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);this._setPosition(b)},_getAnchor:function(){return d.point(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),d.tooltip=function(a,b){return new d.Tooltip(a,b)},d.Map.include({openTooltip:function(a,b,c){return a instanceof d.Tooltip||(a=new d.Tooltip(c).setContent(a)),b&&a.setLatLng(b),this.hasLayer(a)?this:this.addLayer(a)},closeTooltip:function(a){return a&&this.removeLayer(a),this}}),d.Layer.include({bindTooltip:function(a,b){return a instanceof d.Tooltip?(d.setOptions(a,b),this._tooltip=a,a._source=this):(this._tooltip&&!b||(this._tooltip=d.tooltip(b,this)),this._tooltip.setContent(a)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(a){if(a||!this._tooltipHandlersAdded){var b=a?"off":"on",c={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?c.add=this._openTooltip:(c.mouseover=this._openTooltip,c.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(c.mousemove=this._moveTooltip),d.Browser.touch&&(c.click=this._openTooltip)),this[b](c),this._tooltipHandlersAdded=!a}},openTooltip:function(a,b){if(a instanceof d.Layer||(b=a,a=this),a instanceof d.FeatureGroup)for(var c in this._layers){a=this._layers[c];break}return b||(b=a.getCenter?a.getCenter():a.getLatLng()),this._tooltip&&this._map&&(this._tooltip._source=a,this._tooltip.update(),this._map.openTooltip(this._tooltip,b),this._tooltip.options.interactive&&this._tooltip._container&&(d.DomUtil.addClass(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(d.DomUtil.removeClass(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(a){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(a)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(a){return this._tooltip&&this._tooltip.setContent(a),this},getTooltip:function(){return this._tooltip},_openTooltip:function(a){var b=a.layer||a.target;this._tooltip&&this._map&&this.openTooltip(b,this._tooltip.options.sticky?a.latlng:c)},_moveTooltip:function(a){var c,d,b=a.latlng;this._tooltip.options.sticky&&a.originalEvent&&(c=this._map.mouseEventToContainerPoint(a.originalEvent),d=this._map.containerPointToLayerPoint(c),b=this._map.layerPointToLatLng(d)),this._tooltip.setLatLng(b)}}),d.Marker.include({_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor||[0,0]}}),d.LayerGroup=d.Layer.extend({initialize:function(a){this._layers={};var b,c;if(a)for(b=0,c=a.length;b<c;b++)this.addLayer(a[b])},addLayer:function(a){var b=this.getLayerId(a);return this._layers[b]=a,this._map&&this._map.addLayer(a),this},removeLayer:function(a){var b=a in this._layers?a:this.getLayerId(a);return this._map&&this._layers[b]&&this._map.removeLayer(this._layers[b]),delete this._layers[b],this},hasLayer:function(a){return!!a&&(a in this._layers||this.getLayerId(a)in this._layers)},clearLayers:function(){for(var a in this._layers)this.removeLayer(this._layers[a]);return this},invoke:function(a){var c,d,b=Array.prototype.slice.call(arguments,1);for(c in this._layers)d=this._layers[c],d[a]&&d[a].apply(d,b);return this},onAdd:function(a){for(var b in this._layers)a.addLayer(this._layers[b])},onRemove:function(a){for(var b in this._layers)a.removeLayer(this._layers[b])},eachLayer:function(a,b){for(var c in this._layers)a.call(b,this._layers[c]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[];for(var b in this._layers)a.push(this._layers[b]);return a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return d.stamp(a)}}),d.layerGroup=function(a){return new d.LayerGroup(a)},d.FeatureGroup=d.LayerGroup.extend({addLayer:function(a){return this.hasLayer(a)?this:(a.addEventParent(this),d.LayerGroup.prototype.addLayer.call(this,a),this.fire("layeradd",{layer:a}))},removeLayer:function(a){return this.hasLayer(a)?(a in this._layers&&(a=this._layers[a]),a.removeEventParent(this),d.LayerGroup.prototype.removeLayer.call(this,a),this.fire("layerremove",{layer:a})):this},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new d.LatLngBounds;for(var b in this._layers){var c=this._layers[b];a.extend(c.getBounds?c.getBounds():c.getLatLng())}return a}}),d.featureGroup=function(a){return new d.FeatureGroup(a)},d.Renderer=d.Layer.extend({options:{padding:.1},initialize:function(a){d.setOptions(this,a),d.stamp(this)},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&d.DomUtil.addClass(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update()},onRemove:function(){d.DomUtil.remove(this._container)},getEvents:function(){var a={viewreset:this._reset,zoom:this._onZoom,moveend:this._update};return this._zoomAnimated&&(a.zoomanim=this._onAnimZoom),a},_onAnimZoom:function(a){this._updateTransform(a.center,a.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(a,b){var c=this._map.getZoomScale(b,this._zoom),e=d.DomUtil.getPosition(this._container),f=this._map.getSize().multiplyBy(.5+this.options.padding),g=this._map.project(this._center,b),h=this._map.project(a,b),i=h.subtract(g),j=f.multiplyBy(-c).add(e).add(f).subtract(i);d.Browser.any3d?d.DomUtil.setTransform(this._container,j,c):d.DomUtil.setPosition(this._container,j)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom)},_update:function(){var a=this.options.padding,b=this._map.getSize(),c=this._map.containerPointToLayerPoint(b.multiplyBy(-a)).round();this._bounds=new d.Bounds(c,c.add(b.multiplyBy(1+2*a)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),d.Map.include({getRenderer:function(a){var b=a.options.renderer||this._getPaneRenderer(a.options.pane)||this.options.renderer||this._renderer;return b||(b=this._renderer=this.options.preferCanvas&&d.canvas()||d.svg()),this.hasLayer(b)||this.addLayer(b),b},_getPaneRenderer:function(a){if("overlayPane"===a||a===c)return!1;var b=this._paneRenderers[a];return b===c&&(b=d.SVG&&d.svg({pane:a})||d.Canvas&&d.canvas({pane:a}),this._paneRenderers[a]=b),b}}),d.Path=d.Layer.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0},beforeAdd:function(a){this._renderer=a.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this),this._renderer.on("update",this._update,this)},onRemove:function(){this._renderer._removePath(this),this._renderer.off("update",this._update,this)},getEvents:function(){return{zoomend:this._project,viewreset:this._reset}},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(a){return d.setOptions(this,a),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(d.Browser.touch?10:0)}}),d.LineUtil={simplify:function(a,b){if(!b||!a.length)return a.slice();var c=b*b;return a=this._reducePoints(a,c),a=this._simplifyDP(a,c)},pointToSegmentDistance:function(a,b,c){return Math.sqrt(this._sqClosestPointOnSegment(a,b,c,!0))},closestPointOnSegment:function(a,b,c){return this._sqClosestPointOnSegment(a,b,c)},_simplifyDP:function(a,b){var d=a.length,e=typeof Uint8Array!=c+""?Uint8Array:Array,f=new e(d);f[0]=f[d-1]=1,this._simplifyDPStep(a,f,b,0,d-1);var g,h=[];for(g=0;g<d;g++)f[g]&&h.push(a[g]);return h},_simplifyDPStep:function(a,b,c,d,e){var g,h,i,f=0;for(h=d+1;h<=e-1;h++)i=this._sqClosestPointOnSegment(a[h],a[d],a[e],!0),i>f&&(g=h,f=i);f>c&&(b[g]=1,this._simplifyDPStep(a,b,c,d,g),this._simplifyDPStep(a,b,c,g,e))},_reducePoints:function(a,b){for(var c=[a[0]],d=1,e=0,f=a.length;d<f;d++)this._sqDist(a[d],a[e])>b&&(c.push(a[d]),e=d);return e<f-1&&c.push(a[f-1]),c},clipSegment:function(a,b,c,d,e){var h,i,j,f=d?this._lastCode:this._getBitCode(a,c),g=this._getBitCode(b,c);for(this._lastCode=g;;){if(!(f|g))return[a,b];if(f&g)return!1;h=f||g,i=this._getEdgeIntersection(a,b,h,c,e),j=this._getBitCode(i,c),h===f?(a=i,f=j):(b=i,g=j)}},_getEdgeIntersection:function(a,b,c,e,f){var k,l,g=b.x-a.x,h=b.y-a.y,i=e.min,j=e.max;return 8&c?(k=a.x+g*(j.y-a.y)/h,l=j.y):4&c?(k=a.x+g*(i.y-a.y)/h,l=i.y):2&c?(k=j.x,l=a.y+h*(j.x-a.x)/g):1&c&&(k=i.x,l=a.y+h*(i.x-a.x)/g),new d.Point(k,l,f)},_getBitCode:function(a,b){var c=0;return a.x<b.min.x?c|=1:a.x>b.max.x&&(c|=2),a.y<b.min.y?c|=4:a.y>b.max.y&&(c|=8),c},_sqDist:function(a,b){var c=b.x-a.x,d=b.y-a.y;return c*c+d*d},_sqClosestPointOnSegment:function(a,b,c,e){var k,f=b.x,g=b.y,h=c.x-f,i=c.y-g,j=h*h+i*i;return j>0&&(k=((a.x-f)*h+(a.y-g)*i)/j,k>1?(f=c.x,g=c.y):k>0&&(f+=h*k,g+=i*k)),h=a.x-f,i=a.y-g,e?h*h+i*i:new d.Point(f,g)}},d.Polyline=d.Path.extend({options:{smoothFactor:1,noClip:!1},initialize:function(a,b){d.setOptions(this,b),this._setLatLngs(a)},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){return this._setLatLngs(a),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(a){for(var f,g,b=1/0,c=null,e=d.LineUtil._sqClosestPointOnSegment,h=0,i=this._parts.length;h<i;h++)for(var j=this._parts[h],k=1,l=j.length;k<l;k++){f=j[k-1],g=j[k];var m=e(a,f,g,!0);m<b&&(b=m,c=e(a,f,g))}return c&&(c.distance=Math.sqrt(b)),c},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var a,b,c,d,e,f,g,h=this._rings[0],i=h.length;if(!i)return null;for(a=0,b=0;a<i-1;a++)b+=h[a].distanceTo(h[a+1])/2;if(0===b)return this._map.layerPointToLatLng(h[0]);for(a=0,d=0;a<i-1;a++)if(e=h[a],f=h[a+1],c=e.distanceTo(f),d+=c,d>b)return g=(d-b)/c,this._map.layerPointToLatLng([f.x-g*(f.x-e.x),f.y-g*(f.y-e.y)])},getBounds:function(){return this._bounds},addLatLng:function(a,b){return b=b||this._defaultShape(),a=d.latLng(a),b.push(a),this._bounds.extend(a),this.redraw()},_setLatLngs:function(a){this._bounds=new d.LatLngBounds,this._latlngs=this._convertLatLngs(a)},_defaultShape:function(){return d.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(a){for(var b=[],c=d.Polyline._flat(a),e=0,f=a.length;e<f;e++)c?(b[e]=d.latLng(a[e]),this._bounds.extend(b[e])):b[e]=this._convertLatLngs(a[e]);return b},_project:function(){var a=new d.Bounds;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,a);var b=this._clickTolerance(),c=new d.Point(b,b);this._bounds.isValid()&&a.isValid()&&(a.min._subtract(c),a.max._add(c),this._pxBounds=a)},_projectLatlngs:function(a,b,c){var g,h,e=a[0]instanceof d.LatLng,f=a.length;if(e){for(h=[],g=0;g<f;g++)h[g]=this._map.latLngToLayerPoint(a[g]),c.extend(h[g]);b.push(h)}else for(g=0;g<f;g++)this._projectLatlngs(a[g],b,c)},_clipPoints:function(){var a=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(a)){if(this.options.noClip)return void(this._parts=this._rings);var c,e,f,g,h,i,j,b=this._parts;for(c=0,f=0,g=this._rings.length;c<g;c++)for(j=this._rings[c],e=0,h=j.length;e<h-1;e++)i=d.LineUtil.clipSegment(j[e],j[e+1],a,e,!0),i&&(b[f]=b[f]||[],b[f].push(i[0]),i[1]===j[e+1]&&e!==h-2||(b[f].push(i[1]),f++))}},_simplifyPoints:function(){for(var a=this._parts,b=this.options.smoothFactor,c=0,e=a.length;c<e;c++)a[c]=d.LineUtil.simplify(a[c],b)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)}}),d.polyline=function(a,b){return new d.Polyline(a,b)},d.Polyline._flat=function(a){return!d.Util.isArray(a[0])||"object"!=typeof a[0][0]&&"undefined"!=typeof a[0][0]},d.PolyUtil={},d.PolyUtil.clipPolygon=function(a,b,c){var e,g,h,i,j,k,l,m,n,f=[1,4,2,8],o=d.LineUtil;for(g=0,l=a.length;g<l;g++)a[g]._code=o._getBitCode(a[g],b);for(i=0;i<4;i++){for(m=f[i],e=[],g=0,l=a.length,h=l-1;g<l;h=g++)j=a[g],k=a[h],j._code&m?k._code&m||(n=o._getEdgeIntersection(k,j,m,b,c),n._code=o._getBitCode(n,b),e.push(n)):(k._code&m&&(n=o._getEdgeIntersection(k,j,m,b,c),n._code=o._getBitCode(n,b),e.push(n)),e.push(j));a=e}return a},d.Polygon=d.Polyline.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var a,b,c,d,e,f,g,h,i,j=this._rings[0],k=j.length;if(!k)return null;for(f=g=h=0,a=0,b=k-1;a<k;b=a++)c=j[a],d=j[b],e=c.y*d.x-d.y*c.x,g+=(c.x+d.x)*e,h+=(c.y+d.y)*e,f+=3*e;return i=0===f?j[0]:[g/f,h/f],this._map.layerPointToLatLng(i)},_convertLatLngs:function(a){var b=d.Polyline.prototype._convertLatLngs.call(this,a),c=b.length;return c>=2&&b[0]instanceof d.LatLng&&b[0].equals(b[c-1])&&b.pop(),b},_setLatLngs:function(a){d.Polyline.prototype._setLatLngs.call(this,a),d.Polyline._flat(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return d.Polyline._flat(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var a=this._renderer._bounds,b=this.options.weight,c=new d.Point(b,b);if(a=new d.Bounds(a.min.subtract(c),a.max.add(c)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(a)){if(this.options.noClip)return void(this._parts=this._rings);for(var g,e=0,f=this._rings.length;e<f;e++)g=d.PolyUtil.clipPolygon(this._rings[e],a,!0),g.length&&this._parts.push(g)}},_updatePath:function(){this._renderer._updatePoly(this,!0)}}),d.polygon=function(a,b){return new d.Polygon(a,b)},d.Rectangle=d.Polygon.extend({initialize:function(a,b){d.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(a),b)},setBounds:function(a){return this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){return a=d.latLngBounds(a),[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}}),d.rectangle=function(a,b){return new d.Rectangle(a,b)},d.CircleMarker=d.Path.extend({options:{fill:!0,radius:10},initialize:function(a,b){d.setOptions(this,b),this._latlng=d.latLng(a),this._radius=this.options.radius},setLatLng:function(a){return this._latlng=d.latLng(a),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(a){return this.options.radius=this._radius=a,this.redraw()},getRadius:function(){return this._radius},setStyle:function(a){var b=a&&a.radius||this._radius;return d.Path.prototype.setStyle.call(this,a),this.setRadius(b),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var a=this._radius,b=this._radiusY||a,c=this._clickTolerance(),e=[a+c,b+c];this._pxBounds=new d.Bounds(this._point.subtract(e),this._point.add(e))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)}}),d.circleMarker=function(a,b){return new d.CircleMarker(a,b)},d.Circle=d.CircleMarker.extend({initialize:function(a,b,c){if("number"==typeof b&&(b=d.extend({},c,{radius:b})),d.setOptions(this,b),this._latlng=d.latLng(a),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(a){return this._mRadius=a,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var a=[this._radius,this._radiusY||this._radius];return new d.LatLngBounds(this._map.layerPointToLatLng(this._point.subtract(a)),this._map.layerPointToLatLng(this._point.add(a)))},setStyle:d.Path.prototype.setStyle,_project:function(){var a=this._latlng.lng,b=this._latlng.lat,c=this._map,e=c.options.crs;if(e.distance===d.CRS.Earth.distance){var f=Math.PI/180,g=this._mRadius/d.CRS.Earth.R/f,h=c.project([b+g,a]),i=c.project([b-g,a]),j=h.add(i).divideBy(2),k=c.unproject(j).lat,l=Math.acos((Math.cos(g*f)-Math.sin(b*f)*Math.sin(k*f))/(Math.cos(b*f)*Math.cos(k*f)))/f;(isNaN(l)||0===l)&&(l=g/Math.cos(Math.PI/180*b)),this._point=j.subtract(c.getPixelOrigin()),this._radius=isNaN(l)?0:Math.max(Math.round(j.x-c.project([k,a-l]).x),1),this._radiusY=Math.max(Math.round(j.y-h.y),1)}else{var m=e.unproject(e.project(this._latlng).subtract([this._mRadius,0]));this._point=c.latLngToLayerPoint(this._latlng),this._radius=this._point.x-c.latLngToLayerPoint(m).x}this._updateBounds()}}),d.circle=function(a,b,c){return new d.Circle(a,b,c)},d.SVG=d.Renderer.extend({getEvents:function(){var a=d.Renderer.prototype.getEvents.call(this);return a.zoomstart=this._onZoomStart,a},_initContainer:function(){this._container=d.SVG.create("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=d.SVG.create("g"),this._container.appendChild(this._rootGroup)},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){d.Renderer.prototype._update.call(this);var a=this._bounds,b=a.getSize(),c=this._container;this._svgSize&&this._svgSize.equals(b)||(this._svgSize=b,c.setAttribute("width",b.x),c.setAttribute("height",b.y)),d.DomUtil.setPosition(c,a.min),c.setAttribute("viewBox",[a.min.x,a.min.y,b.x,b.y].join(" ")),this.fire("update")}},_initPath:function(a){var b=a._path=d.SVG.create("path");a.options.className&&d.DomUtil.addClass(b,a.options.className),a.options.interactive&&d.DomUtil.addClass(b,"leaflet-interactive"),this._updateStyle(a)},_addPath:function(a){this._rootGroup.appendChild(a._path),a.addInteractiveTarget(a._path)},_removePath:function(a){d.DomUtil.remove(a._path),a.removeInteractiveTarget(a._path)},_updatePath:function(a){a._project(),a._update()},_updateStyle:function(a){var b=a._path,c=a.options;b&&(c.stroke?(b.setAttribute("stroke",c.color),b.setAttribute("stroke-opacity",c.opacity),b.setAttribute("stroke-width",c.weight),b.setAttribute("stroke-linecap",c.lineCap),b.setAttribute("stroke-linejoin",c.lineJoin),c.dashArray?b.setAttribute("stroke-dasharray",c.dashArray):b.removeAttribute("stroke-dasharray"),c.dashOffset?b.setAttribute("stroke-dashoffset",c.dashOffset):b.removeAttribute("stroke-dashoffset")):b.setAttribute("stroke","none"),c.fill?(b.setAttribute("fill",c.fillColor||c.color),b.setAttribute("fill-opacity",c.fillOpacity),b.setAttribute("fill-rule",c.fillRule||"evenodd")):b.setAttribute("fill","none"))},_updatePoly:function(a,b){this._setPath(a,d.SVG.pointsToPath(a._parts,b))},_updateCircle:function(a){var b=a._point,c=a._radius,d=a._radiusY||c,e="a"+c+","+d+" 0 1,0 ",f=a._empty()?"M0 0":"M"+(b.x-c)+","+b.y+e+2*c+",0 "+e+2*-c+",0 ";this._setPath(a,f)},_setPath:function(a,b){a._path.setAttribute("d",b)},_bringToFront:function(a){d.DomUtil.toFront(a._path)},_bringToBack:function(a){d.DomUtil.toBack(a._path)}}),d.extend(d.SVG,{create:function(a){return b.createElementNS("http://www.w3.org/2000/svg",a)},pointsToPath:function(a,b){var e,f,g,h,i,j,c="";for(e=0,g=a.length;e<g;e++){for(i=a[e],f=0,h=i.length;f<h;f++)j=i[f],c+=(f?"L":"M")+j.x+" "+j.y;c+=b?d.Browser.svg?"z":"x":""}return c||"M0 0"}}),d.Browser.svg=!(!b.createElementNS||!d.SVG.create("svg").createSVGRect),d.svg=function(a){return d.Browser.svg||d.Browser.vml?new d.SVG(a):null},d.Browser.vml=!d.Browser.svg&&function(){try{var a=b.createElement("div");a.innerHTML='<v:shape adj="1"/>';var c=a.firstChild;return c.style.behavior="url(#default#VML)",c&&"object"==typeof c.adj}catch(a){return!1}}(),d.SVG.include(d.Browser.vml?{_initContainer:function(){this._container=d.DomUtil.create("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||d.Renderer.prototype._update.call(this)},_initPath:function(a){var b=a._container=d.SVG.create("shape");d.DomUtil.addClass(b,"leaflet-vml-shape "+(this.options.className||"")),b.coordsize="1 1",a._path=d.SVG.create("path"),b.appendChild(a._path),this._updateStyle(a)},_addPath:function(a){var b=a._container;this._container.appendChild(b),a.options.interactive&&a.addInteractiveTarget(b)},_removePath:function(a){var b=a._container;d.DomUtil.remove(b),a.removeInteractiveTarget(b)},_updateStyle:function(a){var b=a._stroke,c=a._fill,e=a.options,f=a._container;f.stroked=!!e.stroke,f.filled=!!e.fill,e.stroke?(b||(b=a._stroke=d.SVG.create("stroke")),f.appendChild(b),b.weight=e.weight+"px",b.color=e.color,b.opacity=e.opacity,e.dashArray?b.dashStyle=d.Util.isArray(e.dashArray)?e.dashArray.join(" "):e.dashArray.replace(/( *, *)/g," "):b.dashStyle="",b.endcap=e.lineCap.replace("butt","flat"),b.joinstyle=e.lineJoin):b&&(f.removeChild(b),a._stroke=null),e.fill?(c||(c=a._fill=d.SVG.create("fill")),f.appendChild(c),c.color=e.fillColor||e.color,c.opacity=e.fillOpacity):c&&(f.removeChild(c),a._fill=null)},_updateCircle:function(a){var b=a._point.round(),c=Math.round(a._radius),d=Math.round(a._radiusY||c);this._setPath(a,a._empty()?"M0 0":"AL "+b.x+","+b.y+" "+c+","+d+" 0,23592600")},_setPath:function(a,b){a._path.v=b},_bringToFront:function(a){d.DomUtil.toFront(a._container)},_bringToBack:function(a){d.DomUtil.toBack(a._container)}}:{}),d.Browser.vml&&(d.SVG.create=function(){try{return b.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return b.createElement("<lvml:"+a+' class="lvml">')}}catch(a){return function(a){return b.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}()),d.Canvas=d.Renderer.extend({onAdd:function(){d.Renderer.prototype.onAdd.call(this),this._layers=this._layers||{},this._draw()},_initContainer:function(){var a=this._container=b.createElement("canvas");d.DomEvent.on(a,"mousemove",d.Util.throttle(this._onMouseMove,32,this),this).on(a,"click dblclick mousedown mouseup contextmenu",this._onClick,this).on(a,"mouseout",this._handleMouseOut,this),this._ctx=a.getContext("2d")},_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={},d.Renderer.prototype._update.call(this);var a=this._bounds,b=this._container,c=a.getSize(),e=d.Browser.retina?2:1;d.DomUtil.setPosition(b,a.min),b.width=e*c.x,b.height=e*c.y,b.style.width=c.x+"px",b.style.height=c.y+"px",d.Browser.retina&&this._ctx.scale(2,2),this._ctx.translate(-a.min.x,-a.min.y),this.fire("update")}},_initPath:function(a){this._updateDashArray(a),this._layers[d.stamp(a)]=a},_addPath:d.Util.falseFn,_removePath:function(a){a._removed=!0,this._requestRedraw(a)},_updatePath:function(a){this._redrawBounds=a._pxBounds,this._draw(!0),a._project(),a._update(),this._draw(),this._redrawBounds=null},_updateStyle:function(a){this._updateDashArray(a),this._requestRedraw(a)},_updateDashArray:function(a){if(a.options.dashArray){var d,b=a.options.dashArray.split(","),c=[];for(d=0;d<b.length;d++)c.push(Number(b[d]));a.options._dashArray=c}},_requestRedraw:function(a){if(this._map){var b=(a.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new d.Bounds,this._redrawBounds.extend(a._pxBounds.min.subtract([b,b])),this._redrawBounds.extend(a._pxBounds.max.add([b,b])),this._redrawRequest=this._redrawRequest||d.Util.requestAnimFrame(this._redraw,this)}},_redraw:function(){this._redrawRequest=null,this._draw(!0),this._draw(),this._redrawBounds=null},_draw:function(a){this._clear=a;var b,c=this._redrawBounds;this._ctx.save(),c&&(this._ctx.beginPath(),this._ctx.rect(c.min.x,c.min.y,c.max.x-c.min.x,c.max.y-c.min.y),this._ctx.clip());for(var d in this._layers)b=this._layers[d],(!c||b._pxBounds&&b._pxBounds.intersects(c))&&b._updatePath(),a&&b._removed&&(delete b._removed,delete this._layers[d]);this._ctx.restore()},_updatePoly:function(a,b){var c,d,e,f,g=a._parts,h=g.length,i=this._ctx;if(h){for(this._drawnLayers[a._leaflet_id]=a,i.beginPath(),i.setLineDash&&i.setLineDash(a.options&&a.options._dashArray||[]),c=0;c<h;c++){for(d=0,e=g[c].length;d<e;d++)f=g[c][d],i[d?"lineTo":"moveTo"](f.x,f.y);b&&i.closePath()}this._fillStroke(i,a)}},_updateCircle:function(a){if(!a._empty()){var b=a._point,c=this._ctx,d=a._radius,e=(a._radiusY||d)/d;this._drawnLayers[a._leaflet_id]=a,1!==e&&(c.save(),c.scale(1,e)),c.beginPath(),c.arc(b.x,b.y/e,d,0,2*Math.PI,!1),1!==e&&c.restore(),this._fillStroke(c,a)}},_fillStroke:function(a,b){var c=this._clear,d=b.options;a.globalCompositeOperation=c?"destination-out":"source-over",d.fill&&(a.globalAlpha=c?1:d.fillOpacity,a.fillStyle=d.fillColor||d.color,a.fill(d.fillRule||"evenodd")),d.stroke&&0!==d.weight&&(a.globalAlpha=c?1:d.opacity,b._prevWeight=a.lineWidth=c?b._prevWeight+1:d.weight,a.strokeStyle=d.color,a.lineCap=d.lineCap,a.lineJoin=d.lineJoin,a.stroke())},_onClick:function(a){var e,b=this._map.mouseEventToLayerPoint(a),c=[];for(var f in this._layers)e=this._layers[f],e.options.interactive&&e._containsPoint(b)&&!this._map._draggableMoved(e)&&(d.DomEvent._fakeStop(a),c.push(e));c.length&&this._fireEvent(c,a)},_onMouseMove:function(a){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var b=this._map.mouseEventToLayerPoint(a);this._handleMouseOut(a,b),this._handleMouseHover(a,b)}},_handleMouseOut:function(a,b){var c=this._hoveredLayer;!c||"mouseout"!==a.type&&c._containsPoint(b)||(d.DomUtil.removeClass(this._container,"leaflet-interactive"),this._fireEvent([c],a,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(a,b){var c,e;for(c in this._drawnLayers)e=this._drawnLayers[c],e.options.interactive&&e._containsPoint(b)&&(d.DomUtil.addClass(this._container,"leaflet-interactive"),this._fireEvent([e],a,"mouseover"),this._hoveredLayer=e);this._hoveredLayer&&this._fireEvent([this._hoveredLayer],a)},_fireEvent:function(a,b,c){this._map._fireDOMEvent(b,c||b.type,a)},_bringToFront:d.Util.falseFn,_bringToBack:d.Util.falseFn}),d.Browser.canvas=function(){return!!b.createElement("canvas").getContext}(),d.canvas=function(a){return d.Browser.canvas?new d.Canvas(a):null},d.Polyline.prototype._containsPoint=function(a,b){var c,e,f,g,h,i,j=this._clickTolerance();if(!this._pxBounds.contains(a))return!1;for(c=0,g=this._parts.length;c<g;c++)for(i=this._parts[c],e=0,h=i.length,f=h-1;e<h;f=e++)if((b||0!==e)&&d.LineUtil.pointToSegmentDistance(a,i[f],i[e])<=j)return!0;return!1},d.Polygon.prototype._containsPoint=function(a){var c,e,f,g,h,i,j,k,b=!1;if(!this._pxBounds.contains(a))return!1;for(g=0,j=this._parts.length;g<j;g++)for(c=this._parts[g],h=0,k=c.length,i=k-1;h<k;i=h++)e=c[h],f=c[i],e.y>a.y!=f.y>a.y&&a.x<(f.x-e.x)*(a.y-e.y)/(f.y-e.y)+e.x&&(b=!b);return b||d.Polyline.prototype._containsPoint.call(this,a,!0)},d.CircleMarker.prototype._containsPoint=function(a){return a.distanceTo(this._point)<=this._radius+this._clickTolerance()},d.GeoJSON=d.FeatureGroup.extend({initialize:function(a,b){d.setOptions(this,b),this._layers={},a&&this.addData(a)},addData:function(a){var c,e,f,b=d.Util.isArray(a)?a:a.features;if(b){for(c=0,e=b.length;c<e;c++)f=b[c],(f.geometries||f.geometry||f.features||f.coordinates)&&this.addData(f);return this}var g=this.options;if(g.filter&&!g.filter(a))return this;
var h=d.GeoJSON.geometryToLayer(a,g);return h?(h.feature=d.GeoJSON.asFeature(a),h.defaultOptions=h.options,this.resetStyle(h),g.onEachFeature&&g.onEachFeature(a,h),this.addLayer(h)):this},resetStyle:function(a){return a.options=d.Util.extend({},a.defaultOptions),this._setLayerStyle(a,this.options.style),this},setStyle:function(a){return this.eachLayer(function(b){this._setLayerStyle(b,a)},this)},_setLayerStyle:function(a,b){"function"==typeof b&&(b=b(a.feature)),a.setStyle&&a.setStyle(b)}}),d.extend(d.GeoJSON,{geometryToLayer:function(a,b){var i,j,k,l,c="Feature"===a.type?a.geometry:a,e=c?c.coordinates:null,f=[],g=b&&b.pointToLayer,h=b&&b.coordsToLatLng||this.coordsToLatLng;if(!e&&!c)return null;switch(c.type){case"Point":return i=h(e),g?g(a,i):new d.Marker(i);case"MultiPoint":for(k=0,l=e.length;k<l;k++)i=h(e[k]),f.push(g?g(a,i):new d.Marker(i));return new d.FeatureGroup(f);case"LineString":case"MultiLineString":return j=this.coordsToLatLngs(e,"LineString"===c.type?0:1,h),new d.Polyline(j,b);case"Polygon":case"MultiPolygon":return j=this.coordsToLatLngs(e,"Polygon"===c.type?1:2,h),new d.Polygon(j,b);case"GeometryCollection":for(k=0,l=c.geometries.length;k<l;k++){var m=this.geometryToLayer({geometry:c.geometries[k],type:"Feature",properties:a.properties},b);m&&f.push(m)}return new d.FeatureGroup(f);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(a){return new d.LatLng(a[1],a[0],a[2])},coordsToLatLngs:function(a,b,c){for(var g,d=[],e=0,f=a.length;e<f;e++)g=b?this.coordsToLatLngs(a[e],b-1,c):(c||this.coordsToLatLng)(a[e]),d.push(g);return d},latLngToCoords:function(a){return a.alt!==c?[a.lng,a.lat,a.alt]:[a.lng,a.lat]},latLngsToCoords:function(a,b,c){for(var e=[],f=0,g=a.length;f<g;f++)e.push(b?d.GeoJSON.latLngsToCoords(a[f],b-1,c):d.GeoJSON.latLngToCoords(a[f]));return!b&&c&&e.push(e[0]),e},getFeature:function(a,b){return a.feature?d.extend({},a.feature,{geometry:b}):d.GeoJSON.asFeature(b)},asFeature:function(a){return"Feature"===a.type?a:{type:"Feature",properties:{},geometry:a}}});var g={toGeoJSON:function(){return d.GeoJSON.getFeature(this,{type:"Point",coordinates:d.GeoJSON.latLngToCoords(this.getLatLng())})}};d.Marker.include(g),d.Circle.include(g),d.CircleMarker.include(g),d.Polyline.prototype.toGeoJSON=function(){var a=!d.Polyline._flat(this._latlngs),b=d.GeoJSON.latLngsToCoords(this._latlngs,a?1:0);return d.GeoJSON.getFeature(this,{type:(a?"Multi":"")+"LineString",coordinates:b})},d.Polygon.prototype.toGeoJSON=function(){var a=!d.Polyline._flat(this._latlngs),b=a&&!d.Polyline._flat(this._latlngs[0]),c=d.GeoJSON.latLngsToCoords(this._latlngs,b?2:a?1:0,!0);return a||(c=[c]),d.GeoJSON.getFeature(this,{type:(b?"Multi":"")+"Polygon",coordinates:c})},d.LayerGroup.include({toMultiPoint:function(){var a=[];return this.eachLayer(function(b){a.push(b.toGeoJSON().geometry.coordinates)}),d.GeoJSON.getFeature(this,{type:"MultiPoint",coordinates:a})},toGeoJSON:function(){var a=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===a)return this.toMultiPoint();var b="GeometryCollection"===a,c=[];return this.eachLayer(function(a){if(a.toGeoJSON){var e=a.toGeoJSON();c.push(b?e.geometry:d.GeoJSON.asFeature(e))}}),b?d.GeoJSON.getFeature(this,{geometries:c,type:"GeometryCollection"}):{type:"FeatureCollection",features:c}}}),d.geoJSON=function(a,b){return new d.GeoJSON(a,b)},d.geoJson=d.geoJSON;var h="_leaflet_events";d.DomEvent={on:function(a,b,c,e){if("object"==typeof b)for(var f in b)this._on(a,f,b[f],c);else{b=d.Util.splitWords(b);for(var g=0,h=b.length;g<h;g++)this._on(a,b[g],c,e)}return this},off:function(a,b,c,e){if("object"==typeof b)for(var f in b)this._off(a,f,b[f],c);else{b=d.Util.splitWords(b);for(var g=0,h=b.length;g<h;g++)this._off(a,b[g],c,e)}return this},_on:function(b,c,e,f){var g=c+d.stamp(e)+(f?"_"+d.stamp(f):"");if(b[h]&&b[h][g])return this;var i=function(c){return e.call(f||b,c||a.event)},j=i;return d.Browser.pointer&&0===c.indexOf("touch")?this.addPointerListener(b,c,i,g):d.Browser.touch&&"dblclick"===c&&this.addDoubleTapListener?this.addDoubleTapListener(b,i,g):"addEventListener"in b?"mousewheel"===c?b.addEventListener("onwheel"in b?"wheel":"mousewheel",i,!1):"mouseenter"===c||"mouseleave"===c?(i=function(c){c=c||a.event,d.DomEvent._isExternalTarget(b,c)&&j(c)},b.addEventListener("mouseenter"===c?"mouseover":"mouseout",i,!1)):("click"===c&&d.Browser.android&&(i=function(a){return d.DomEvent._filterClick(a,j)}),b.addEventListener(c,i,!1)):"attachEvent"in b&&b.attachEvent("on"+c,i),b[h]=b[h]||{},b[h][g]=i,this},_off:function(a,b,c,e){var f=b+d.stamp(c)+(e?"_"+d.stamp(e):""),g=a[h]&&a[h][f];return g?(d.Browser.pointer&&0===b.indexOf("touch")?this.removePointerListener(a,b,f):d.Browser.touch&&"dblclick"===b&&this.removeDoubleTapListener?this.removeDoubleTapListener(a,f):"removeEventListener"in a?"mousewheel"===b?a.removeEventListener("onwheel"in a?"wheel":"mousewheel",g,!1):a.removeEventListener("mouseenter"===b?"mouseover":"mouseleave"===b?"mouseout":b,g,!1):"detachEvent"in a&&a.detachEvent("on"+b,g),a[h][f]=null,this):this},stopPropagation:function(a){return a.stopPropagation?a.stopPropagation():a.originalEvent?a.originalEvent._stopped=!0:a.cancelBubble=!0,d.DomEvent._skipped(a),this},disableScrollPropagation:function(a){return d.DomEvent.on(a,"mousewheel",d.DomEvent.stopPropagation)},disableClickPropagation:function(a){var b=d.DomEvent.stopPropagation;return d.DomEvent.on(a,d.Draggable.START.join(" "),b),d.DomEvent.on(a,{click:d.DomEvent._fakeStop,dblclick:b})},preventDefault:function(a){return a.preventDefault?a.preventDefault():a.returnValue=!1,this},stop:function(a){return d.DomEvent.preventDefault(a).stopPropagation(a)},getMousePosition:function(a,b){if(!b)return new d.Point(a.clientX,a.clientY);var c=b.getBoundingClientRect();return new d.Point(a.clientX-c.left-b.clientLeft,a.clientY-c.top-b.clientTop)},_wheelPxFactor:d.Browser.win&&d.Browser.chrome?2:d.Browser.gecko?a.devicePixelRatio:1,getWheelDelta:function(a){return d.Browser.edge?a.wheelDeltaY/2:a.deltaY&&0===a.deltaMode?-a.deltaY/d.DomEvent._wheelPxFactor:a.deltaY&&1===a.deltaMode?20*-a.deltaY:a.deltaY&&2===a.deltaMode?60*-a.deltaY:a.deltaX||a.deltaZ?0:a.wheelDelta?(a.wheelDeltaY||a.wheelDelta)/2:a.detail&&Math.abs(a.detail)<32765?20*-a.detail:a.detail?a.detail/-32765*60:0},_skipEvents:{},_fakeStop:function(a){d.DomEvent._skipEvents[a.type]=!0},_skipped:function(a){var b=this._skipEvents[a.type];return this._skipEvents[a.type]=!1,b},_isExternalTarget:function(a,b){var c=b.relatedTarget;if(!c)return!0;try{for(;c&&c!==a;)c=c.parentNode}catch(a){return!1}return c!==a},_filterClick:function(a,b){var c=a.timeStamp||a.originalEvent&&a.originalEvent.timeStamp,e=d.DomEvent._lastClick&&c-d.DomEvent._lastClick;return e&&e>100&&e<500||a.target._simulatedClick&&!a._simulated?void d.DomEvent.stop(a):(d.DomEvent._lastClick=c,void b(a))}},d.DomEvent.addListener=d.DomEvent.on,d.DomEvent.removeListener=d.DomEvent.off,d.Draggable=d.Evented.extend({options:{clickTolerance:3},statics:{START:d.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(a,b,c){this._element=a,this._dragStartTarget=b||a,this._preventOutline=c},enable:function(){this._enabled||(d.DomEvent.on(this._dragStartTarget,d.Draggable.START.join(" "),this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(d.DomEvent.off(this._dragStartTarget,d.Draggable.START.join(" "),this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(a){if(!a._simulated&&this._enabled&&(this._moved=!1,!d.DomUtil.hasClass(this._element,"leaflet-zoom-anim")&&!(d.Draggable._dragging||a.shiftKey||1!==a.which&&1!==a.button&&!a.touches)&&this._enabled&&(d.Draggable._dragging=!0,this._preventOutline&&d.DomUtil.preventOutline(this._element),d.DomUtil.disableImageDrag(),d.DomUtil.disableTextSelection(),!this._moving))){this.fire("down");var c=a.touches?a.touches[0]:a;this._startPoint=new d.Point(c.clientX,c.clientY),d.DomEvent.on(b,d.Draggable.MOVE[a.type],this._onMove,this).on(b,d.Draggable.END[a.type],this._onUp,this)}},_onMove:function(c){if(!c._simulated&&this._enabled){if(c.touches&&c.touches.length>1)return void(this._moved=!0);var e=c.touches&&1===c.touches.length?c.touches[0]:c,f=new d.Point(e.clientX,e.clientY),g=f.subtract(this._startPoint);(g.x||g.y)&&(Math.abs(g.x)+Math.abs(g.y)<this.options.clickTolerance||(d.DomEvent.preventDefault(c),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=d.DomUtil.getPosition(this._element).subtract(g),d.DomUtil.addClass(b.body,"leaflet-dragging"),this._lastTarget=c.target||c.srcElement,a.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),d.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(g),this._moving=!0,d.Util.cancelAnimFrame(this._animRequest),this._lastEvent=c,this._animRequest=d.Util.requestAnimFrame(this._updatePosition,this,!0)))}},_updatePosition:function(){var a={originalEvent:this._lastEvent};this.fire("predrag",a),d.DomUtil.setPosition(this._element,this._newPos),this.fire("drag",a)},_onUp:function(a){if(!a._simulated&&this._enabled){d.DomUtil.removeClass(b.body,"leaflet-dragging"),this._lastTarget&&(d.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var c in d.Draggable.MOVE)d.DomEvent.off(b,d.Draggable.MOVE[c],this._onMove,this).off(b,d.Draggable.END[c],this._onUp,this);d.DomUtil.enableImageDrag(),d.DomUtil.enableTextSelection(),this._moved&&this._moving&&(d.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,d.Draggable._dragging=!1}}}),d.Handler=d.Class.extend({initialize:function(a){this._map=a},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}}),d.Map.mergeOptions({dragging:!0,inertia:!d.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0}),d.Map.Drag=d.Handler.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new d.Draggable(a._mapPane,a._container),this._draggable.on({down:this._onDown,dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),a.on("zoomend",this._onZoomEnd,this),a.whenReady(this._onZoomEnd,this))}d.DomUtil.addClass(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){d.DomUtil.removeClass(this._map._container,"leaflet-grab"),d.DomUtil.removeClass(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDown:function(){this._map._stop()},_onDragStart:function(){var a=this._map;if(this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var b=d.latLngBounds(this._map.options.maxBounds);this._offsetLimit=d.bounds(this._map.latLngToContainerPoint(b.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(b.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;a.fire("movestart").fire("dragstart"),a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(a){if(this._map.options.inertia){var b=this._lastTime=+new Date,c=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(c),this._times.push(b),b-this._times[0]>50&&(this._positions.shift(),this._times.shift())}this._map.fire("move",a).fire("drag",a)},_onZoomEnd:function(){var a=this._map.getSize().divideBy(2),b=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=b.subtract(a).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(a,b){return a-(a-b)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var a=this._draggable._newPos.subtract(this._draggable._startPos),b=this._offsetLimit;a.x<b.min.x&&(a.x=this._viscousLimit(a.x,b.min.x)),a.y<b.min.y&&(a.y=this._viscousLimit(a.y,b.min.y)),a.x>b.max.x&&(a.x=this._viscousLimit(a.x,b.max.x)),a.y>b.max.y&&(a.y=this._viscousLimit(a.y,b.max.y)),this._draggable._newPos=this._draggable._startPos.add(a)}},_onPreDragWrap:function(){var a=this._worldWidth,b=Math.round(a/2),c=this._initialWorldOffset,d=this._draggable._newPos.x,e=(d-b+c)%a+b-c,f=(d+b+c)%a-b-c,g=Math.abs(e+c)<Math.abs(f+c)?e:f;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=g},_onDragEnd:function(a){var b=this._map,c=b.options,e=!c.inertia||this._times.length<2;if(b.fire("dragend",a),e)b.fire("moveend");else{var f=this._lastPos.subtract(this._positions[0]),g=(this._lastTime-this._times[0])/1e3,h=c.easeLinearity,i=f.multiplyBy(h/g),j=i.distanceTo([0,0]),k=Math.min(c.inertiaMaxSpeed,j),l=i.multiplyBy(k/j),m=k/(c.inertiaDeceleration*h),n=l.multiplyBy(-m/2).round();n.x||n.y?(n=b._limitOffset(n,b.options.maxBounds),d.Util.requestAnimFrame(function(){b.panBy(n,{duration:m,easeLinearity:h,noMoveStart:!0,animate:!0})})):b.fire("moveend")}}}),d.Map.addInitHook("addHandler","dragging",d.Map.Drag),d.Map.mergeOptions({doubleClickZoom:!0}),d.Map.DoubleClickZoom=d.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var b=this._map,c=b.getZoom(),d=b.options.zoomDelta,e=a.originalEvent.shiftKey?c-d:c+d;"center"===b.options.doubleClickZoom?b.setZoom(e):b.setZoomAround(a.containerPoint,e)}}),d.Map.addInitHook("addHandler","doubleClickZoom",d.Map.DoubleClickZoom),d.Map.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60}),d.Map.ScrollWheelZoom=d.Handler.extend({addHooks:function(){d.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){d.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(a){var b=d.DomEvent.getWheelDelta(a),c=this._map.options.wheelDebounceTime;this._delta+=b,this._lastMousePos=this._map.mouseEventToContainerPoint(a),this._startTime||(this._startTime=+new Date);var e=Math.max(c-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(d.bind(this._performZoom,this),e),d.DomEvent.stop(a)},_performZoom:function(){var a=this._map,b=a.getZoom(),c=this._map.options.zoomSnap||0;a._stop();var d=this._delta/(4*this._map.options.wheelPxPerZoomLevel),e=4*Math.log(2/(1+Math.exp(-Math.abs(d))))/Math.LN2,f=c?Math.ceil(e/c)*c:e,g=a._limitZoom(b+(this._delta>0?f:-f))-b;this._delta=0,this._startTime=null,g&&("center"===a.options.scrollWheelZoom?a.setZoom(b+g):a.setZoomAround(this._lastMousePos,b+g))}}),d.Map.addInitHook("addHandler","scrollWheelZoom",d.Map.ScrollWheelZoom),d.extend(d.DomEvent,{_touchstart:d.Browser.msPointer?"MSPointerDown":d.Browser.pointer?"pointerdown":"touchstart",_touchend:d.Browser.msPointer?"MSPointerUp":d.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(a,b,c){function i(a){var b;if(b=d.Browser.pointer?d.DomEvent._pointersCount:a.touches.length,!(b>1)){var c=Date.now(),i=c-(e||c);f=a.touches?a.touches[0]:a,g=i>0&&i<=h,e=c}}function j(){if(g&&!f.cancelBubble){if(d.Browser.pointer){var c,h,a={};for(h in f)c=f[h],a[h]=c&&c.bind?c.bind(f):c;f=a}f.type="dblclick",b(f),e=null}}var e,f,g=!1,h=250,k="_leaflet_",l=this._touchstart,m=this._touchend;return a[k+l+c]=i,a[k+m+c]=j,a[k+"dblclick"+c]=b,a.addEventListener(l,i,!1),a.addEventListener(m,j,!1),d.Browser.edge||a.addEventListener("dblclick",b,!1),this},removeDoubleTapListener:function(a,b){var c="_leaflet_",e=a[c+this._touchstart+b],f=a[c+this._touchend+b],g=a[c+"dblclick"+b];return a.removeEventListener(this._touchstart,e,!1),a.removeEventListener(this._touchend,f,!1),d.Browser.edge||a.removeEventListener("dblclick",g,!1),this}}),d.extend(d.DomEvent,{POINTER_DOWN:d.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:d.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:d.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:d.Browser.msPointer?"MSPointerCancel":"pointercancel",TAG_WHITE_LIST:["INPUT","SELECT","OPTION"],_pointers:{},_pointersCount:0,addPointerListener:function(a,b,c,d){return"touchstart"===b?this._addPointerStart(a,c,d):"touchmove"===b?this._addPointerMove(a,c,d):"touchend"===b&&this._addPointerEnd(a,c,d),this},removePointerListener:function(a,b,c){var d=a["_leaflet_"+b+c];return"touchstart"===b?a.removeEventListener(this.POINTER_DOWN,d,!1):"touchmove"===b?a.removeEventListener(this.POINTER_MOVE,d,!1):"touchend"===b&&(a.removeEventListener(this.POINTER_UP,d,!1),a.removeEventListener(this.POINTER_CANCEL,d,!1)),this},_addPointerStart:function(a,c,e){var f=d.bind(function(a){if("mouse"!==a.pointerType&&a.pointerType!==a.MSPOINTER_TYPE_MOUSE){if(!(this.TAG_WHITE_LIST.indexOf(a.target.tagName)<0))return;d.DomEvent.preventDefault(a)}this._handlePointer(a,c)},this);if(a["_leaflet_touchstart"+e]=f,a.addEventListener(this.POINTER_DOWN,f,!1),!this._pointerDocListener){var g=d.bind(this._globalPointerUp,this);b.documentElement.addEventListener(this.POINTER_DOWN,d.bind(this._globalPointerDown,this),!0),b.documentElement.addEventListener(this.POINTER_MOVE,d.bind(this._globalPointerMove,this),!0),b.documentElement.addEventListener(this.POINTER_UP,g,!0),b.documentElement.addEventListener(this.POINTER_CANCEL,g,!0),this._pointerDocListener=!0}},_globalPointerDown:function(a){this._pointers[a.pointerId]=a,this._pointersCount++},_globalPointerMove:function(a){this._pointers[a.pointerId]&&(this._pointers[a.pointerId]=a)},_globalPointerUp:function(a){delete this._pointers[a.pointerId],this._pointersCount--},_handlePointer:function(a,b){a.touches=[];for(var c in this._pointers)a.touches.push(this._pointers[c]);a.changedTouches=[a],b(a)},_addPointerMove:function(a,b,c){var e=d.bind(function(a){(a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType||0!==a.buttons)&&this._handlePointer(a,b)},this);a["_leaflet_touchmove"+c]=e,a.addEventListener(this.POINTER_MOVE,e,!1)},_addPointerEnd:function(a,b,c){var e=d.bind(function(a){this._handlePointer(a,b)},this);a["_leaflet_touchend"+c]=e,a.addEventListener(this.POINTER_UP,e,!1),a.addEventListener(this.POINTER_CANCEL,e,!1)}}),d.Map.mergeOptions({touchZoom:d.Browser.touch&&!d.Browser.android23,bounceAtZoomLimits:!0}),d.Map.TouchZoom=d.Handler.extend({addHooks:function(){d.DomUtil.addClass(this._map._container,"leaflet-touch-zoom"),d.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){d.DomUtil.removeClass(this._map._container,"leaflet-touch-zoom"),d.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var c=this._map;if(a.touches&&2===a.touches.length&&!c._animatingZoom&&!this._zooming){var e=c.mouseEventToContainerPoint(a.touches[0]),f=c.mouseEventToContainerPoint(a.touches[1]);this._centerPoint=c.getSize()._divideBy(2),this._startLatLng=c.containerPointToLatLng(this._centerPoint),"center"!==c.options.touchZoom&&(this._pinchStartLatLng=c.containerPointToLatLng(e.add(f)._divideBy(2))),this._startDist=e.distanceTo(f),this._startZoom=c.getZoom(),this._moved=!1,this._zooming=!0,c._stop(),d.DomEvent.on(b,"touchmove",this._onTouchMove,this).on(b,"touchend",this._onTouchEnd,this),d.DomEvent.preventDefault(a)}},_onTouchMove:function(a){if(a.touches&&2===a.touches.length&&this._zooming){var b=this._map,c=b.mouseEventToContainerPoint(a.touches[0]),e=b.mouseEventToContainerPoint(a.touches[1]),f=c.distanceTo(e)/this._startDist;if(this._zoom=b.getScaleZoom(f,this._startZoom),!b.options.bounceAtZoomLimits&&(this._zoom<b.getMinZoom()&&f<1||this._zoom>b.getMaxZoom()&&f>1)&&(this._zoom=b._limitZoom(this._zoom)),"center"===b.options.touchZoom){if(this._center=this._startLatLng,1===f)return}else{var g=c._add(e)._divideBy(2)._subtract(this._centerPoint);if(1===f&&0===g.x&&0===g.y)return;this._center=b.unproject(b.project(this._pinchStartLatLng,this._zoom).subtract(g),this._zoom)}this._moved||(b._moveStart(!0),this._moved=!0),d.Util.cancelAnimFrame(this._animRequest);var h=d.bind(b._move,b,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=d.Util.requestAnimFrame(h,this,!0),d.DomEvent.preventDefault(a)}},_onTouchEnd:function(){return this._moved&&this._zooming?(this._zooming=!1,d.Util.cancelAnimFrame(this._animRequest),d.DomEvent.off(b,"touchmove",this._onTouchMove).off(b,"touchend",this._onTouchEnd),void(this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom)))):void(this._zooming=!1)}}),d.Map.addInitHook("addHandler","touchZoom",d.Map.TouchZoom),d.Map.mergeOptions({tap:!0,tapTolerance:15}),d.Map.Tap=d.Handler.extend({addHooks:function(){d.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){d.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(a.touches){if(d.DomEvent.preventDefault(a),this._fireClick=!0,a.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var c=a.touches[0],e=c.target;this._startPos=this._newPos=new d.Point(c.clientX,c.clientY),e.tagName&&"a"===e.tagName.toLowerCase()&&d.DomUtil.addClass(e,"leaflet-active"),this._holdTimeout=setTimeout(d.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",c))},this),1e3),this._simulateEvent("mousedown",c),d.DomEvent.on(b,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(a){if(clearTimeout(this._holdTimeout),d.DomEvent.off(b,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&a&&a.changedTouches){var c=a.changedTouches[0],e=c.target;e&&e.tagName&&"a"===e.tagName.toLowerCase()&&d.DomUtil.removeClass(e,"leaflet-active"),this._simulateEvent("mouseup",c),this._isTapValid()&&this._simulateEvent("click",c)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(a){var b=a.touches[0];this._newPos=new d.Point(b.clientX,b.clientY),this._simulateEvent("mousemove",b)},_simulateEvent:function(c,d){var e=b.createEvent("MouseEvents");e._simulated=!0,d.target._simulatedClick=!0,e.initMouseEvent(c,!0,!0,a,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null),d.target.dispatchEvent(e)}}),d.Browser.touch&&!d.Browser.pointer&&d.Map.addInitHook("addHandler","tap",d.Map.Tap),d.Map.mergeOptions({boxZoom:!0}),d.Map.BoxZoom=d.Handler.extend({initialize:function(a){this._map=a,this._container=a._container,this._pane=a._panes.overlayPane},addHooks:function(){d.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){d.DomEvent.off(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_resetState:function(){this._moved=!1},_onMouseDown:function(a){return!(!a.shiftKey||1!==a.which&&1!==a.button)&&(this._resetState(),d.DomUtil.disableTextSelection(),d.DomUtil.disableImageDrag(),this._startPoint=this._map.mouseEventToContainerPoint(a),void d.DomEvent.on(b,{contextmenu:d.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this))},_onMouseMove:function(a){this._moved||(this._moved=!0,this._box=d.DomUtil.create("div","leaflet-zoom-box",this._container),d.DomUtil.addClass(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(a);var b=new d.Bounds(this._point,this._startPoint),c=b.getSize();d.DomUtil.setPosition(this._box,b.min),this._box.style.width=c.x+"px",this._box.style.height=c.y+"px"},_finish:function(){this._moved&&(d.DomUtil.remove(this._box),d.DomUtil.removeClass(this._container,"leaflet-crosshair")),d.DomUtil.enableTextSelection(),d.DomUtil.enableImageDrag(),d.DomEvent.off(b,{contextmenu:d.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(a){if((1===a.which||1===a.button)&&(this._finish(),this._moved)){setTimeout(d.bind(this._resetState,this),0);var b=new d.LatLngBounds(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(b).fire("boxzoomend",{boxZoomBounds:b})}},_onKeyDown:function(a){27===a.keyCode&&this._finish()}}),d.Map.addInitHook("addHandler","boxZoom",d.Map.BoxZoom),d.Map.mergeOptions({keyboard:!0,keyboardPanDelta:80}),d.Map.Keyboard=d.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(a){this._map=a,this._setPanDelta(a.options.keyboardPanDelta),this._setZoomDelta(a.options.zoomDelta)},addHooks:function(){var a=this._map._container;a.tabIndex<=0&&(a.tabIndex="0"),d.DomEvent.on(a,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),d.DomEvent.off(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var c=b.body,d=b.documentElement,e=c.scrollTop||d.scrollTop,f=c.scrollLeft||d.scrollLeft;this._map._container.focus(),a.scrollTo(f,e)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(a){var d,e,b=this._panKeys={},c=this.keyCodes;for(d=0,e=c.left.length;d<e;d++)b[c.left[d]]=[-1*a,0];for(d=0,e=c.right.length;d<e;d++)b[c.right[d]]=[a,0];for(d=0,e=c.down.length;d<e;d++)b[c.down[d]]=[0,a];for(d=0,e=c.up.length;d<e;d++)b[c.up[d]]=[0,-1*a]},_setZoomDelta:function(a){var d,e,b=this._zoomKeys={},c=this.keyCodes;for(d=0,e=c.zoomIn.length;d<e;d++)b[c.zoomIn[d]]=a;for(d=0,e=c.zoomOut.length;d<e;d++)b[c.zoomOut[d]]=-a},_addHooks:function(){d.DomEvent.on(b,"keydown",this._onKeyDown,this)},_removeHooks:function(){d.DomEvent.off(b,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var e,b=a.keyCode,c=this._map;if(b in this._panKeys){if(c._panAnim&&c._panAnim._inProgress)return;e=this._panKeys[b],a.shiftKey&&(e=d.point(e).multiplyBy(3)),c.panBy(e),c.options.maxBounds&&c.panInsideBounds(c.options.maxBounds)}else if(b in this._zoomKeys)c.setZoom(c.getZoom()+(a.shiftKey?3:1)*this._zoomKeys[b]);else{if(27!==b)return;c.closePopup()}d.DomEvent.stop(a)}}}),d.Map.addInitHook("addHandler","keyboard",d.Map.Keyboard),d.Handler.MarkerDrag=d.Handler.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new d.Draggable(a,a,!0)),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),d.DomUtil.addClass(a,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&d.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(a){var b=this._marker,c=b._shadow,e=d.DomUtil.getPosition(b._icon),f=b._map.layerPointToLatLng(e);c&&d.DomUtil.setPosition(c,e),b._latlng=f,a.latlng=f,a.oldLatLng=this._oldLatLng,b.fire("move",a).fire("drag",a)},_onDragEnd:function(a){delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",a)}}),d.Control=d.Class.extend({options:{position:"topright"},initialize:function(a){d.setOptions(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var b=this._map;return b&&b.removeControl(this),this.options.position=a,b&&b.addControl(this),this},getContainer:function(){return this._container},addTo:function(a){this.remove(),this._map=a;var b=this._container=this.onAdd(a),c=this.getPosition(),e=a._controlCorners[c];return d.DomUtil.addClass(b,"leaflet-control"),c.indexOf("bottom")!==-1?e.insertBefore(b,e.firstChild):e.appendChild(b),this},remove:function(){return this._map?(d.DomUtil.remove(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this):this},_refocusOnMap:function(a){this._map&&a&&a.screenX>0&&a.screenY>0&&this._map.getContainer().focus()}}),d.control=function(a){return new d.Control(a)},d.Map.include({addControl:function(a){return a.addTo(this),this},removeControl:function(a){return a.remove(),this},_initControlPos:function(){function e(e,f){var g=b+e+" "+b+f;a[e+f]=d.DomUtil.create("div",g,c)}var a=this._controlCorners={},b="leaflet-",c=this._controlContainer=d.DomUtil.create("div",b+"control-container",this._container);e("top","left"),e("top","right"),e("bottom","left"),e("bottom","right")},_clearControlPos:function(){d.DomUtil.remove(this._controlContainer)}}),d.Control.Zoom=d.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(a){var b="leaflet-control-zoom",c=d.DomUtil.create("div",b+" leaflet-bar"),e=this.options;return this._zoomInButton=this._createButton(e.zoomInText,e.zoomInTitle,b+"-in",c,this._zoomIn),this._zoomOutButton=this._createButton(e.zoomOutText,e.zoomOutTitle,b+"-out",c,this._zoomOut),this._updateDisabled(),a.on("zoomend zoomlevelschange",this._updateDisabled,this),c},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(a){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(a.shiftKey?3:1))},_zoomOut:function(a){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(a.shiftKey?3:1))},_createButton:function(a,b,c,e,f){var g=d.DomUtil.create("a",c,e);return g.innerHTML=a,g.href="#",g.title=b,d.DomEvent.on(g,"mousedown dblclick",d.DomEvent.stopPropagation).on(g,"click",d.DomEvent.stop).on(g,"click",f,this).on(g,"click",this._refocusOnMap,this),g},_updateDisabled:function(){var a=this._map,b="leaflet-disabled";d.DomUtil.removeClass(this._zoomInButton,b),d.DomUtil.removeClass(this._zoomOutButton,b),(this._disabled||a._zoom===a.getMinZoom())&&d.DomUtil.addClass(this._zoomOutButton,b),(this._disabled||a._zoom===a.getMaxZoom())&&d.DomUtil.addClass(this._zoomInButton,b)}}),d.Map.mergeOptions({zoomControl:!0}),d.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new d.Control.Zoom,this.addControl(this.zoomControl))}),d.control.zoom=function(a){return new d.Control.Zoom(a)},d.Control.Attribution=d.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(a){d.setOptions(this,a),this._attributions={}},onAdd:function(a){a.attributionControl=this,this._container=d.DomUtil.create("div","leaflet-control-attribution"),d.DomEvent&&d.DomEvent.disableClickPropagation(this._container);for(var b in a._layers)a._layers[b].getAttribution&&this.addAttribution(a._layers[b].getAttribution());return this._update(),this._container;
},setPrefix:function(a){return this.options.prefix=a,this._update(),this},addAttribution:function(a){return a?(this._attributions[a]||(this._attributions[a]=0),this._attributions[a]++,this._update(),this):this},removeAttribution:function(a){return a?(this._attributions[a]&&(this._attributions[a]--,this._update()),this):this},_update:function(){if(this._map){var a=[];for(var b in this._attributions)this._attributions[b]&&a.push(b);var c=[];this.options.prefix&&c.push(this.options.prefix),a.length&&c.push(a.join(", ")),this._container.innerHTML=c.join(" | ")}}}),d.Map.mergeOptions({attributionControl:!0}),d.Map.addInitHook(function(){this.options.attributionControl&&(new d.Control.Attribution).addTo(this)}),d.control.attribution=function(a){return new d.Control.Attribution(a)},d.Control.Scale=d.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(a){var b="leaflet-control-scale",c=d.DomUtil.create("div",b),e=this.options;return this._addScales(e,b+"-line",c),a.on(e.updateWhenIdle?"moveend":"move",this._update,this),a.whenReady(this._update,this),c},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,b,c){a.metric&&(this._mScale=d.DomUtil.create("div",b,c)),a.imperial&&(this._iScale=d.DomUtil.create("div",b,c))},_update:function(){var a=this._map,b=a.getSize().y/2,c=a.distance(a.containerPointToLatLng([0,b]),a.containerPointToLatLng([this.options.maxWidth,b]));this._updateScales(c)},_updateScales:function(a){this.options.metric&&a&&this._updateMetric(a),this.options.imperial&&a&&this._updateImperial(a)},_updateMetric:function(a){var b=this._getRoundNum(a),c=b<1e3?b+" m":b/1e3+" km";this._updateScale(this._mScale,c,b/a)},_updateImperial:function(a){var c,d,e,b=3.2808399*a;b>5280?(c=b/5280,d=this._getRoundNum(c),this._updateScale(this._iScale,d+" mi",d/c)):(e=this._getRoundNum(b),this._updateScale(this._iScale,e+" ft",e/b))},_updateScale:function(a,b,c){a.style.width=Math.round(this.options.maxWidth*c)+"px",a.innerHTML=b},_getRoundNum:function(a){var b=Math.pow(10,(Math.floor(a)+"").length-1),c=a/b;return c=c>=10?10:c>=5?5:c>=3?3:c>=2?2:1,b*c}}),d.control.scale=function(a){return new d.Control.Scale(a)},d.Control.Layers=d.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1},initialize:function(a,b,c){d.setOptions(this,c),this._layers=[],this._lastZIndex=0,this._handlingClick=!1;for(var e in a)this._addLayer(a[e],e);for(e in b)this._addLayer(b[e],e,!0)},onAdd:function(a){return this._initLayout(),this._update(),this._map=a,a.on("zoomend",this._checkDisabledLayers,this),this._container},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(a,b){return this._addLayer(a,b),this._map?this._update():this},addOverlay:function(a,b){return this._addLayer(a,b,!0),this._map?this._update():this},removeLayer:function(a){a.off("add remove",this._onLayerChange,this);var b=this._getLayer(d.stamp(a));return b&&this._layers.splice(this._layers.indexOf(b),1),this._map?this._update():this},expand:function(){d.DomUtil.addClass(this._container,"leaflet-control-layers-expanded"),this._form.style.height=null;var a=this._map.getSize().y-(this._container.offsetTop+50);return a<this._form.clientHeight?(d.DomUtil.addClass(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=a+"px"):d.DomUtil.removeClass(this._form,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return d.DomUtil.removeClass(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var a="leaflet-control-layers",b=this._container=d.DomUtil.create("div",a);b.setAttribute("aria-haspopup",!0),d.DomEvent.disableClickPropagation(b),d.Browser.touch||d.DomEvent.disableScrollPropagation(b);var c=this._form=d.DomUtil.create("form",a+"-list");if(this.options.collapsed){d.Browser.android||d.DomEvent.on(b,{mouseenter:this.expand,mouseleave:this.collapse},this);var e=this._layersLink=d.DomUtil.create("a",a+"-toggle",b);e.href="#",e.title="Layers",d.Browser.touch?d.DomEvent.on(e,"click",d.DomEvent.stop).on(e,"click",this.expand,this):d.DomEvent.on(e,"focus",this.expand,this),d.DomEvent.on(c,"click",function(){setTimeout(d.bind(this._onInputClick,this),0)},this),this._map.on("click",this.collapse,this)}else this.expand();this._baseLayersList=d.DomUtil.create("div",a+"-base",c),this._separator=d.DomUtil.create("div",a+"-separator",c),this._overlaysList=d.DomUtil.create("div",a+"-overlays",c),b.appendChild(c)},_getLayer:function(a){for(var b=0;b<this._layers.length;b++)if(this._layers[b]&&d.stamp(this._layers[b].layer)===a)return this._layers[b]},_addLayer:function(a,b,c){a.on("add remove",this._onLayerChange,this),this._layers.push({layer:a,name:b,overlay:c}),this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex))},_update:function(){if(!this._container)return this;d.DomUtil.empty(this._baseLayersList),d.DomUtil.empty(this._overlaysList);var a,b,c,e,f=0;for(c=0;c<this._layers.length;c++)e=this._layers[c],this._addItem(e),b=b||e.overlay,a=a||!e.overlay,f+=e.overlay?0:1;return this.options.hideSingleBase&&(a=a&&f>1,this._baseLayersList.style.display=a?"":"none"),this._separator.style.display=b&&a?"":"none",this},_onLayerChange:function(a){this._handlingClick||this._update();var b=this._getLayer(d.stamp(a.target)),c=b.overlay?"add"===a.type?"overlayadd":"overlayremove":"add"===a.type?"baselayerchange":null;c&&this._map.fire(c,b)},_createRadioElement:function(a,c){var d='<input type="radio" class="leaflet-control-layers-selector" name="'+a+'"'+(c?' checked="checked"':"")+"/>",e=b.createElement("div");return e.innerHTML=d,e.firstChild},_addItem:function(a){var f,c=b.createElement("label"),e=this._map.hasLayer(a.layer);a.overlay?(f=b.createElement("input"),f.type="checkbox",f.className="leaflet-control-layers-selector",f.defaultChecked=e):f=this._createRadioElement("leaflet-base-layers",e),f.layerId=d.stamp(a.layer),d.DomEvent.on(f,"click",this._onInputClick,this);var g=b.createElement("span");g.innerHTML=" "+a.name;var h=b.createElement("div");c.appendChild(h),h.appendChild(f),h.appendChild(g);var i=a.overlay?this._overlaysList:this._baseLayersList;return i.appendChild(c),this._checkDisabledLayers(),c},_onInputClick:function(){var b,c,d,a=this._form.getElementsByTagName("input"),e=[],f=[];this._handlingClick=!0;for(var g=a.length-1;g>=0;g--)b=a[g],c=this._getLayer(b.layerId).layer,d=this._map.hasLayer(c),b.checked&&!d?e.push(c):!b.checked&&d&&f.push(c);for(g=0;g<f.length;g++)this._map.removeLayer(f[g]);for(g=0;g<e.length;g++)this._map.addLayer(e[g]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var b,d,a=this._form.getElementsByTagName("input"),e=this._map.getZoom(),f=a.length-1;f>=0;f--)b=a[f],d=this._getLayer(b.layerId).layer,b.disabled=d.options.minZoom!==c&&e<d.options.minZoom||d.options.maxZoom!==c&&e>d.options.maxZoom},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),d.control.layers=function(a,b,c){return new d.Control.Layers(a,b,c)},d.PosAnimation=d.Evented.extend({run:function(a,b,c,e){this.stop(),this._el=a,this._inProgress=!0,this._duration=c||.25,this._easeOutPower=1/Math.max(e||.5,.2),this._startPos=d.DomUtil.getPosition(a),this._offset=b.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=d.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(a){var b=+new Date-this._startTime,c=1e3*this._duration;b<c?this._runFrame(this._easeOut(b/c),a):(this._runFrame(1),this._complete())},_runFrame:function(a,b){var c=this._startPos.add(this._offset.multiplyBy(a));b&&c._round(),d.DomUtil.setPosition(this._el,c),this.fire("step")},_complete:function(){d.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}}),d.Map.include({setView:function(a,b,e){if(b=b===c?this._zoom:this._limitZoom(b),a=this._limitCenter(d.latLng(a),b,this.options.maxBounds),e=e||{},this._stop(),this._loaded&&!e.reset&&e!==!0){e.animate!==c&&(e.zoom=d.extend({animate:e.animate},e.zoom),e.pan=d.extend({animate:e.animate,duration:e.duration},e.pan));var f=this._zoom!==b?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,b,e.zoom):this._tryAnimatedPan(a,e.pan);if(f)return clearTimeout(this._sizeTimer),this}return this._resetView(a,b),this},panBy:function(a,b){if(a=d.point(a).round(),b=b||{},!a.x&&!a.y)return this.fire("moveend");if(b.animate!==!0&&!this.getSize().contains(a))return this._resetView(this.unproject(this.project(this.getCenter()).add(a)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new d.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),b.noMoveStart||this.fire("movestart"),b.animate!==!1){d.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var c=this._getMapPanePos().subtract(a).round();this._panAnim.run(this._mapPane,c,b.duration||.25,b.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){d.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(a,b){var c=this._getCenterOffset(a)._floor();return!((b&&b.animate)!==!0&&!this.getSize().contains(c))&&(this.panBy(c,b),!0)}}),d.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4});var i=d.DomUtil.TRANSITION&&d.Browser.any3d&&!d.Browser.mobileOpera;i&&d.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),d.DomEvent.on(this._proxy,d.DomUtil.TRANSITION_END,this._catchTransitionEnd,this))}),d.Map.include(i?{_createAnimProxy:function(){var a=this._proxy=d.DomUtil.create("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(a),this.on("zoomanim",function(b){var c=d.DomUtil.TRANSFORM,e=a.style[c];d.DomUtil.setTransform(a,this.project(b.center,b.zoom),this.getZoomScale(b.zoom,1)),e===a.style[c]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",function(){var b=this.getCenter(),c=this.getZoom();d.DomUtil.setTransform(a,this.project(b,c),this.getZoomScale(c,1))},this)},_catchTransitionEnd:function(a){this._animatingZoom&&a.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(a,b,c){if(this._animatingZoom)return!0;if(c=c||{},!this._zoomAnimated||c.animate===!1||this._nothingToAnimate()||Math.abs(b-this._zoom)>this.options.zoomAnimationThreshold)return!1;var e=this.getZoomScale(b),f=this._getCenterOffset(a)._divideBy(1-1/e);return!(c.animate!==!0&&!this.getSize().contains(f))&&(d.Util.requestAnimFrame(function(){this._moveStart(!0)._animateZoom(a,b,!0)},this),!0)},_animateZoom:function(a,b,c,e){c&&(this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=b,d.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:a,zoom:b,noUpdate:e}),setTimeout(d.bind(this._onZoomTransitionEnd,this),250)},_onZoomTransitionEnd:function(){this._animatingZoom&&(d.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),d.Util.requestAnimFrame(function(){this._moveEnd(!0)},this))}}:{}),d.Map.include({flyTo:function(a,b,e){function o(a){var b=a?-1:1,c=a?k:j,d=k*k-j*j+b*n*n*l*l,e=2*c*n*l,f=d/e,g=Math.sqrt(f*f+1)-f,h=g<1e-9?-18:Math.log(g);return h}function p(a){return(Math.exp(a)-Math.exp(-a))/2}function q(a){return(Math.exp(a)+Math.exp(-a))/2}function r(a){return p(a)/q(a)}function t(a){return j*(q(s)/q(s+m*a))}function u(a){return j*(q(s)*r(s+m*a)-p(s))/n}function v(a){return 1-Math.pow(1-a,1.5)}function z(){var c=(Date.now()-w)/y,e=v(c)*x;c<=1?(this._flyToFrame=d.Util.requestAnimFrame(z,this),this._move(this.unproject(f.add(g.subtract(f).multiplyBy(u(e)/l)),i),this.getScaleZoom(j/t(e),i),{flyTo:!0})):this._move(a,b)._moveEnd(!0)}if(e=e||{},e.animate===!1||!d.Browser.any3d)return this.setView(a,b,e);this._stop();var f=this.project(this.getCenter()),g=this.project(a),h=this.getSize(),i=this._zoom;a=d.latLng(a),b=b===c?i:b;var j=Math.max(h.x,h.y),k=j*this.getZoomScale(i,b),l=g.distanceTo(f)||1,m=1.42,n=m*m,s=o(0),w=Date.now(),x=(o(1)-s)/m,y=e.duration?1e3*e.duration:1e3*x*.8;return this._moveStart(!0),z.call(this),this},flyToBounds:function(a,b){var c=this._getBoundsCenterZoom(a,b);return this.flyTo(c.center,c.zoom,b)}}),d.Map.include({_defaultLocateOptions:{timeout:1e4,watch:!1},locate:function(a){if(a=this._locateOptions=d.extend({},this._defaultLocateOptions,a),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var b=d.bind(this._handleGeolocationResponse,this),c=d.bind(this._handleGeolocationError,this);return a.watch?this._locationWatchId=navigator.geolocation.watchPosition(b,c,a):navigator.geolocation.getCurrentPosition(b,c,a),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(a){var b=a.code,c=a.message||(1===b?"permission denied":2===b?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:b,message:"Geolocation error: "+c+"."})},_handleGeolocationResponse:function(a){var b=a.coords.latitude,c=a.coords.longitude,e=new d.LatLng(b,c),f=e.toBounds(a.coords.accuracy),g=this._locateOptions;if(g.setView){var h=this.getBoundsZoom(f);this.setView(e,g.maxZoom?Math.min(h,g.maxZoom):h)}var i={latlng:e,bounds:f,timestamp:a.timestamp};for(var j in a.coords)"number"==typeof a.coords[j]&&(i[j]=a.coords[j]);this.fire("locationfound",i)}})}(window,document),function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports,require("leaflet")):"function"==typeof define&&define.amd?define(["exports","leaflet"],b):b((a.L=a.L||{},a.L.esri=a.L.esri||{}),a.L)}(this,function(a,b){"use strict";function h(a){var b="";a.f=a.f||"json";for(var c in a)if(a.hasOwnProperty(c)){var f,d=a[c],e=Object.prototype.toString.call(d);b.length&&(b+="&"),f="[object Array]"===e?"[object Object]"===Object.prototype.toString.call(d[0])?JSON.stringify(d):d.join(","):"[object Object]"===e?JSON.stringify(d):"[object Date]"===e?d.valueOf():d,b+=encodeURIComponent(c)+"="+encodeURIComponent(f)}return b}function i(a,c){var d=new window.XMLHttpRequest;return d.onerror=function(e){d.onreadystatechange=b.Util.falseFn,a.call(c,{error:{code:500,message:"XMLHttpRequest error"}},null)},d.onreadystatechange=function(){var e,f;if(4===d.readyState){try{e=JSON.parse(d.responseText)}catch(a){e=null,f={code:500,message:"Could not parse response as JSON. This could also be caused by a CORS or XMLHttpRequest error."}}!f&&e.error&&(f=e.error,e=null),d.onerror=b.Util.falseFn,a.call(c,f,e)}},d.ontimeout=function(){this.onerror()},d}function j(a,b,c,d){var e=i(c,d);return e.open("POST",a),"undefined"!=typeof d&&null!==d&&"undefined"!=typeof d.options&&(e.timeout=d.options.timeout),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.send(h(b)),e}function k(a,b,c,d){var e=i(c,d);return e.open("GET",a+"?"+h(b),!0),"undefined"!=typeof d&&null!==d&&"undefined"!=typeof d.options&&(e.timeout=d.options.timeout),e.send(null),e}function l(a,b,c,d){var e=h(b),g=i(c,d),j=(a+"?"+e).length;if(j<=2e3&&f.cors?g.open("GET",a+"?"+e):j>2e3&&f.cors&&(g.open("POST",a),g.setRequestHeader("Content-Type","application/x-www-form-urlencoded")),"undefined"!=typeof d&&null!==d&&"undefined"!=typeof d.options&&(g.timeout=d.options.timeout),j<=2e3&&f.cors)g.send(null);else{if(!(j>2e3&&f.cors))return j<=2e3&&!f.cors?m(a,b,c,d):void L("a request to "+a+" was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy http://esri.github.io/esri-leaflet/api-reference/request.html");g.send(e)}return g}function m(a,c,d,e){window._EsriLeafletCallbacks=window._EsriLeafletCallbacks||{};var f="c"+g;c.callback="window._EsriLeafletCallbacks."+f,window._EsriLeafletCallbacks[f]=function(a){if(window._EsriLeafletCallbacks[f]!==!0){var b,c=Object.prototype.toString.call(a);"[object Object]"!==c&&"[object Array]"!==c&&(b={error:{code:500,message:"Expected array or object as JSONP response"}},a=null),!b&&a.error&&(b=a,a=null),d.call(e,b,a),window._EsriLeafletCallbacks[f]=!0}};var i=b.DomUtil.create("script",null,document.body);return i.type="text/javascript",i.src=a+"?"+h(c),i.id=f,g++,{id:f,url:i.src,abort:function(){window._EsriLeafletCallbacks._callback[f]({code:0,message:"Request aborted."})}}}function p(a,b){for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}function q(a){return p(a[0],a[a.length-1])||a.push(a[0]),a}function r(a){var f,b=0,c=0,d=a.length,e=a[c];for(c;c<d-1;c++)f=a[c+1],b+=(f[0]-e[0])*(f[1]+e[1]),e=f;return b>=0}function s(a,b,c,d){var e=(d[0]-c[0])*(a[1]-c[1])-(d[1]-c[1])*(a[0]-c[0]),f=(b[0]-a[0])*(a[1]-c[1])-(b[1]-a[1])*(a[0]-c[0]),g=(d[1]-c[1])*(b[0]-a[0])-(d[0]-c[0])*(b[1]-a[1]);if(0!==g){var h=e/g,i=f/g;if(h>=0&&h<=1&&i>=0&&i<=1)return!0}return!1}function t(a,b){for(var c=0;c<a.length-1;c++)for(var d=0;d<b.length-1;d++)if(s(a[c],a[c+1],b[d],b[d+1]))return!0;return!1}function u(a,b){for(var c=!1,d=-1,e=a.length,f=e-1;++d<e;f=d)(a[d][1]<=b[1]&&b[1]<a[f][1]||a[f][1]<=b[1]&&b[1]<a[d][1])&&b[0]<(a[f][0]-a[d][0])*(b[1]-a[d][1])/(a[f][1]-a[d][1])+a[d][0]&&(c=!c);return c}function v(a,b){var c=t(a,b),d=u(a,b[0]);return!(c||!d)}function w(a){for(var d,e,f,b=[],c=[],g=0;g<a.length;g++){var h=q(a[g].slice(0));if(!(h.length<4))if(r(h)){var i=[h];b.push(i)}else c.push(h)}for(var j=[];c.length;){f=c.pop();var k=!1;for(d=b.length-1;d>=0;d--)if(e=b[d][0],v(e,f)){b[d].push(f),k=!0;break}k||j.push(f)}for(;j.length;){f=j.pop();var l=!1;for(d=b.length-1;d>=0;d--)if(e=b[d][0],t(e,f)){b[d].push(f),l=!0;break}l||b.push([f.reverse()])}return 1===b.length?{type:"Polygon",coordinates:b[0]}:{type:"MultiPolygon",coordinates:b}}function x(a){var b=[],c=a.slice(0),d=q(c.shift().slice(0));if(d.length>=4){r(d)||d.reverse(),b.push(d);for(var e=0;e<c.length;e++){var f=q(c[e].slice(0));f.length>=4&&(r(f)&&f.reverse(),b.push(f))}}return b}function y(a){for(var b=[],c=0;c<a.length;c++)for(var d=x(a[c]),e=d.length-1;e>=0;e--){var f=d[e].slice(0);b.push(f)}return b}function z(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function A(a,b){var c={};return"number"==typeof a.x&&"number"==typeof a.y&&(c.type="Point",c.coordinates=[a.x,a.y]),a.points&&(c.type="MultiPoint",c.coordinates=a.points.slice(0)),a.paths&&(1===a.paths.length?(c.type="LineString",c.coordinates=a.paths[0].slice(0)):(c.type="MultiLineString",c.coordinates=a.paths.slice(0))),a.rings&&(c=w(a.rings.slice(0))),(a.geometry||a.attributes)&&(c.type="Feature",c.geometry=a.geometry?A(a.geometry):null,c.properties=a.attributes?z(a.attributes):null,a.attributes&&(c.id=a.attributes[b]||a.attributes.OBJECTID||a.attributes.FID)),c}function B(a,b){b=b||"OBJECTID";var e,c={wkid:4326},d={};switch(a.type){case"Point":d.x=a.coordinates[0],d.y=a.coordinates[1],d.spatialReference=c;break;case"MultiPoint":d.points=a.coordinates.slice(0),d.spatialReference=c;break;case"LineString":d.paths=[a.coordinates.slice(0)],d.spatialReference=c;break;case"MultiLineString":d.paths=a.coordinates.slice(0),d.spatialReference=c;break;case"Polygon":d.rings=x(a.coordinates.slice(0)),d.spatialReference=c;break;case"MultiPolygon":d.rings=y(a.coordinates.slice(0)),d.spatialReference=c;break;case"Feature":a.geometry&&(d.geometry=B(a.geometry,b)),d.attributes=a.properties?z(a.properties):{},a.id&&(d.attributes[b]=a.id);break;case"FeatureCollection":for(d=[],e=0;e<a.features.length;e++)d.push(B(a.features[e],b));break;case"GeometryCollection":for(d=[],e=0;e<a.geometries.length;e++)d.push(B(a.geometries[e],b))}return d}function C(a,b){return B(a,b)}function D(a,b){return A(a,b)}function E(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function F(a){var c=b.latLng(a.ymin,a.xmin),d=b.latLng(a.ymax,a.xmax);return b.latLngBounds(c,d)}function G(a){return a=b.latLngBounds(a),{xmin:a.getSouthWest().lng,ymin:a.getSouthWest().lat,xmax:a.getNorthEast().lng,ymax:a.getNorthEast().lat,spatialReference:{wkid:4326}}}function H(a,b){var c;if(b)c=b;else if(a.objectIdFieldName)c=a.objectIdFieldName;else if(a.fields){for(var d=0;d<=a.fields.length-1;d++)if("esriFieldTypeOID"===a.fields[d].type){c=a.fields[d].name;break}}else c="OBJECTID";var e={type:"FeatureCollection",features:[]},f=a.features||a.results;if(f.length)for(var g=f.length-1;g>=0;g--){var h=D(f[g],c);e.features.push(h)}return e}function I(a){return a=b.Util.trim(a),"/"!==a[a.length-1]&&(a+="/"),a}function J(a){return/\.arcgis\.com.*?FeatureServer/g.test(a)}function K(a){var b;switch(a){case"Point":b="esriGeometryPoint";break;case"MultiPoint":b="esriGeometryMultipoint";break;case"LineString":b="esriGeometryPolyline";break;case"MultiLineString":b="esriGeometryPolyline";break;case"Polygon":b="esriGeometryPolygon";break;case"MultiPolygon":b="esriGeometryPolygon"}return b}function L(){console&&console.warn&&console.warn.apply(console,arguments)}function M(a){return a.getSize().x-20+"px"}function N(a){if(a.attributionControl&&!a.attributionControl._esriAttributionAdded){a.attributionControl.setPrefix('<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a> | Powered by <a href="https://www.esri.com">Esri</a>');var c=document.createElement("style");c.type="text/css",c.innerHTML=".esri-truncated-attribution:hover {white-space: normal;",document.getElementsByTagName("head")[0].appendChild(c),b.DomUtil.addClass(a.attributionControl._container,"esri-truncated-attribution:hover");var d=document.createElement("style");d.type="text/css",d.innerHTML=".esri-truncated-attribution {vertical-align: -3px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;display: inline-block;transition: 0s white-space;transition-delay: 1s;max-width:"+b.esri.Util.calcAttributionWidth(a)+";",document.getElementsByTagName("head")[0].appendChild(d),b.DomUtil.addClass(a.attributionControl._container,"esri-truncated-attribution"),a.on("resize",function(c){a.attributionControl._container.style.maxWidth=b.esri.Util.calcAttributionWidth(c.target)}),a.attributionControl._esriAttributionAdded=!0}}function O(a,c){m(a,{},b.Util.bind(function(a,d){if(!a){c._esriAttributions=[];for(var e=0;e<d.contributors.length;e++)for(var f=d.contributors[e],g=0;g<f.coverageAreas.length;g++){var h=f.coverageAreas[g],i=b.latLng(h.bbox[0],h.bbox[1]),j=b.latLng(h.bbox[2],h.bbox[3]);c._esriAttributions.push({attribution:f.attribution,score:h.score,bounds:b.latLngBounds(i,j),minZoom:h.zoomMin,maxZoom:h.zoomMax})}c._esriAttributions.sort(function(a,b){return b.score-a.score});var k={target:c};P(k)}},this))}function P(a){var c=a.target,d=c._esriAttributions;if(c&&c.attributionControl&&d){for(var e="",f=c.getBounds(),g=b.latLngBounds(f.getSouthWest().wrap(),f.getNorthEast().wrap()),h=c.getZoom(),i=0;i<d.length;i++){var j=d[i],k=j.attribution;!e.match(k)&&j.bounds.intersects(g)&&h>=j.minZoom&&h<=j.maxZoom&&(e+=", "+k)}e=e.substr(2);var l=c.attributionControl._container.querySelector(".esri-dynamic-attribution");l.innerHTML=e,l.style.maxWidth=M(c),c.fire("attributionupdated",{attribution:e})}}function S(a){return new R(a)}function U(a){return new T(a)}function W(a){return new V(a)}function Y(a){return new X(a)}function $(a){return new Z(a)}function aa(a){return new _(a)}function ca(a){return new ba(a)}function ea(a){return new da(a)}function ga(a){return new fa(a)}function ia(a){return new ha(a)}function la(a,b){return new ka(a,b)}function na(a,b){return new ma(a,b)}function ra(a,b){return new qa(a,b)}function ta(a,b){return new sa(a,b)}function va(a){this.values=[].concat(a||[])}function ya(a){return new xa(a)}b="default"in b?b.default:b;var c="2.0.3",d=window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest,e=""===document.documentElement.style.pointerEvents,f={cors:d,pointerEvents:e},g=0,n=f.cors?k:m;n.CORS=k,n.JSONP=m;var o={request:l,get:n,post:j},Q={shallowClone:E,warn:L,cleanUrl:I,isArcgisOnline:J,geojsonTypeToArcGIS:K,responseToFeatureCollection:H,geojsonToArcGIS:C,arcgisToGeoJSON:D,boundsToExtent:G,extentToBounds:F,calcAttributionWidth:M,setEsriAttribution:N,_getAttributionData:O,_updateMapAttribution:P},R=b.Class.extend({options:{proxy:!1,useCors:d},generateSetter:function(a,c){return b.Util.bind(function(b){return this.params[a]=b,this},c)},initialize:function(a){if(a.request&&a.options?(this._service=a,b.Util.setOptions(this,a.options)):(b.Util.setOptions(this,a),this.options.url=I(a.url)),this.params=b.Util.extend({},this.params||{}),this.setters)for(var c in this.setters){var d=this.setters[c];this[c]=this.generateSetter(d,this)}},token:function(a){return this._service?this._service.authenticate(a):this.params.token=a,this},request:function(a,b){return this._service?this._service.request(this.path,this.params,a,b):this._request("request",this.path,this.params,a,b)},_request:function(a,b,c,d,e){var f=this.options.proxy?this.options.proxy+"?"+this.options.url+b:this.options.url+b;return"get"!==a&&"request"!==a||this.options.useCors?o[a](f,c,d,e):o.get.JSONP(f,c,d,e)}}),T=R.extend({setters:{offset:"resultOffset",limit:"resultRecordCount",fields:"outFields",precision:"geometryPrecision",featureIds:"objectIds",returnGeometry:"returnGeometry",token:"token"},path:"query",params:{returnGeometry:!0,where:"1=1",outSr:4326,outFields:"*"},within:function(a){return this._setGeometry(a),this.params.spatialRel="esriSpatialRelContains",this},intersects:function(a){return this._setGeometry(a),this.params.spatialRel="esriSpatialRelIntersects",this},contains:function(a){return this._setGeometry(a),this.params.spatialRel="esriSpatialRelWithin",this},crosses:function(a){return this._setGeometry(a),this.params.spatialRel="esriSpatialRelCrosses",this},touches:function(a){return this._setGeometry(a),this.params.spatialRel="esriSpatialRelTouches",this},overlaps:function(a){return this._setGeometry(a),this.params.spatialRel="esriSpatialRelOverlaps",this},nearby:function(a,c){return a=b.latLng(a),this.params.geometry=[a.lng,a.lat],this.params.geometryType="esriGeometryPoint",this.params.spatialRel="esriSpatialRelIntersects",this.params.units="esriSRUnit_Meter",this.params.distance=c,this.params.inSr=4326,this},where:function(a){return this.params.where=a,this},between:function(a,b){return this.params.time=[a.valueOf(),b.valueOf()],this},simplify:function(a,b){var c=Math.abs(a.getBounds().getWest()-a.getBounds().getEast());return this.params.maxAllowableOffset=c/a.getSize().y*b,this},orderBy:function(a,b){return b=b||"ASC",this.params.orderByFields=this.params.orderByFields?this.params.orderByFields+",":"",this.params.orderByFields+=[a,b].join(" "),this},run:function(a,b){return this._cleanParams(),this.options.isModern||Q.isArcgisOnline(this.options.url)?(this.params.f="geojson",this.request(function(c,d){this._trapSQLerrors(c),a.call(b,c,d,d)},this)):this.request(function(c,d){this._trapSQLerrors(c),a.call(b,c,d&&Q.responseToFeatureCollection(d),d)},this)},count:function(a,b){return this._cleanParams(),this.params.returnCountOnly=!0,this.request(function(b,c){a.call(this,b,c&&c.count,c)},b)},ids:function(a,b){return this._cleanParams(),this.params.returnIdsOnly=!0,this.request(function(b,c){a.call(this,b,c&&c.objectIds,c)},b)},bounds:function(a,b){return this._cleanParams(),this.params.returnExtentOnly=!0,this.request(function(c,d){a.call(b,c,d&&d.extent&&Q.extentToBounds(d.extent),d)},b)},pixelSize:function(a){return a=b.point(a),this.params.pixelSize=[a.x,a.y],this},layer:function(a){return this.path=a+"/query",this},_trapSQLerrors:function(a){a&&"400"===a.code&&Q.warn("one common syntax error in query requests is encasing string values in double quotes instead of single quotes")},_cleanParams:function(){delete this.params.returnIdsOnly,delete this.params.returnExtentOnly,delete this.params.returnCountOnly},_setGeometry:function(a){return this.params.inSr=4326,a instanceof b.LatLngBounds?(this.params.geometry=Q.boundsToExtent(a),void(this.params.geometryType="esriGeometryEnvelope")):(a.getLatLng&&(a=a.getLatLng()),a instanceof b.LatLng&&(a={type:"Point",coordinates:[a.lng,a.lat]}),a instanceof b.GeoJSON&&(a=a.getLayers()[0].feature.geometry,this.params.geometry=Q.geojsonToArcGIS(a),this.params.geometryType=Q.geojsonTypeToArcGIS(a.type)),a.toGeoJSON&&(a=a.toGeoJSON()),"Feature"===a.type&&(a=a.geometry),"Point"===a.type||"LineString"===a.type||"Polygon"===a.type?(this.params.geometry=Q.geojsonToArcGIS(a),void(this.params.geometryType=Q.geojsonTypeToArcGIS(a.type))):void Q.warn("invalid geometry passed to spatial query. Should be an L.LatLng, L.LatLngBounds or L.Marker or a GeoJSON Point Line or Polygon object"))}}),V=R.extend({setters:{contains:"contains",text:"searchText",fields:"searchFields",spatialReference:"sr",sr:"sr",layers:"layers",returnGeometry:"returnGeometry",maxAllowableOffset:"maxAllowableOffset",precision:"geometryPrecision",dynamicLayers:"dynamicLayers",returnZ:"returnZ",returnM:"returnM",gdbVersion:"gdbVersion",token:"token"},path:"find",params:{sr:4326,contains:!0,returnGeometry:!0,returnZ:!0,returnM:!1},layerDefs:function(a,b){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[a,b].join(":"),this},simplify:function(a,b){var c=Math.abs(a.getBounds().getWest()-a.getBounds().getEast());return this.params.maxAllowableOffset=c/a.getSize().y*b,this},run:function(a,b){return this.request(function(c,d){a.call(b,c,d&&Q.responseToFeatureCollection(d),d)},b)}}),X=R.extend({path:"identify",between:function(a,b){return this.params.time=[a.valueOf(),b.valueOf()],this}}),Z=X.extend({setters:{layers:"layers",precision:"geometryPrecision",tolerance:"tolerance",returnGeometry:"returnGeometry"},params:{sr:4326,layers:"all",tolerance:3,returnGeometry:!0},on:function(a){var b=Q.boundsToExtent(a.getBounds()),c=a.getSize();return this.params.imageDisplay=[c.x,c.y,96],this.params.mapExtent=[b.xmin,b.ymin,b.xmax,b.ymax],this},at:function(a){return a=b.latLng(a),this.params.geometry=[a.lng,a.lat],this.params.geometryType="esriGeometryPoint",this},layerDef:function(a,b){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[a,b].join(":"),this},simplify:function(a,b){var c=Math.abs(a.getBounds().getWest()-a.getBounds().getEast());return this.params.maxAllowableOffset=c/a.getSize().y*(1-b),this},run:function(a,b){return this.request(function(c,d){if(c)return void a.call(b,c,void 0,d);var e=Q.responseToFeatureCollection(d);d.results=d.results.reverse();for(var f=0;f<e.features.length;f++){var g=e.features[f];g.layerId=d.results[f].layerId}a.call(b,void 0,e,d)})}}),_=X.extend({setters:{setMosaicRule:"mosaicRule",setRenderingRule:"renderingRule",setPixelSize:"pixelSize",returnCatalogItems:"returnCatalogItems",returnGeometry:"returnGeometry"},params:{returnGeometry:!1},at:function(a){return a=b.latLng(a),this.params.geometry=JSON.stringify({x:a.lng,y:a.lat,spatialReference:{wkid:4326}}),this.params.geometryType="esriGeometryPoint",this},getMosaicRule:function(){return this.params.mosaicRule},getRenderingRule:function(){return this.params.renderingRule},getPixelSize:function(){return this.params.pixelSize},run:function(a,b){return this.request(function(c,d){a.call(b,c,d&&this._responseToGeoJSON(d),d)},this)},_responseToGeoJSON:function(a){var b=a.location,c=a.catalogItems,d=a.catalogItemVisibilities,e={
pixel:{type:"Feature",geometry:{type:"Point",coordinates:[b.x,b.y]},crs:{type:"EPSG",properties:{code:b.spatialReference.wkid}},properties:{OBJECTID:a.objectId,name:a.name,value:a.value},id:a.objectId}};if(a.properties&&a.properties.Values&&(e.pixel.properties.values=a.properties.Values),c&&c.features&&(e.catalogItems=Q.responseToFeatureCollection(c),d&&d.length===e.catalogItems.features.length))for(var f=d.length-1;f>=0;f--)e.catalogItems.features[f].properties.catalogItemVisibility=d[f];return e}}),ba=b.Evented.extend({options:{proxy:!1,useCors:d,timeout:0},initialize:function(a){a=a||{},this._requestQueue=[],this._authenticating=!1,b.Util.setOptions(this,a),this.options.url=I(this.options.url)},get:function(a,b,c,d){return this._request("get",a,b,c,d)},post:function(a,b,c,d){return this._request("post",a,b,c,d)},request:function(a,b,c,d){return this._request("request",a,b,c,d)},metadata:function(a,b){return this._request("get","",{},a,b)},authenticate:function(a){return this._authenticating=!1,this.options.token=a,this._runQueue(),this},getTimeout:function(){return this.options.timeout},setTimeout:function(a){this.options.timeout=a},_request:function(a,b,c,d,e){this.fire("requeststart",{url:this.options.url+b,params:c,method:a},!0);var f=this._createServiceCallback(a,b,c,d,e);if(this.options.token&&(c.token=this.options.token),this._authenticating)return void this._requestQueue.push([a,b,c,d,e]);var g=this.options.proxy?this.options.proxy+"?"+this.options.url+b:this.options.url+b;return"get"!==a&&"request"!==a||this.options.useCors?o[a](g,c,f,e):o.get.JSONP(g,c,f,e)},_createServiceCallback:function(a,c,d,e,f){return b.Util.bind(function(g,h){!g||499!==g.code&&498!==g.code||(this._authenticating=!0,this._requestQueue.push([a,c,d,e,f]),this.fire("authenticationrequired",{authenticate:b.Util.bind(this.authenticate,this)},!0),g.authenticate=b.Util.bind(this.authenticate,this)),e.call(f,g,h),g?this.fire("requesterror",{url:this.options.url+c,params:d,message:g.message,code:g.code,method:a},!0):this.fire("requestsuccess",{url:this.options.url+c,params:d,response:h,method:a},!0),this.fire("requestend",{url:this.options.url+c,params:d,method:a},!0)},this)},_runQueue:function(){for(var a=this._requestQueue.length-1;a>=0;a--){var b=this._requestQueue[a],c=b.shift();this[c].apply(this,b)}this._requestQueue=[]}}),da=ba.extend({identify:function(){return $(this)},find:function(){return W(this)},query:function(){return U(this)}}),fa=ba.extend({query:function(){return U(this)},identify:function(){return aa(this)}}),ha=ba.extend({options:{idAttribute:"OBJECTID"},query:function(){return U(this)},addFeature:function(a,b,c){return delete a.id,a=C(a),this.post("addFeatures",{features:[a]},function(a,d){var e=d&&d.addResults?d.addResults[0]:void 0;b&&b.call(c,a||d.addResults[0].error,e)},c)},updateFeature:function(a,b,c){return a=C(a,this.options.idAttribute),this.post("updateFeatures",{features:[a]},function(a,d){var e=d&&d.updateResults?d.updateResults[0]:void 0;b&&b.call(c,a||d.updateResults[0].error,e)},c)},deleteFeature:function(a,b,c){return this.post("deleteFeatures",{objectIds:a},function(a,d){var e=d&&d.deleteResults?d.deleteResults[0]:void 0;b&&b.call(c,a||d.deleteResults[0].error,e)},c)},deleteFeatures:function(a,b,c){return this.post("deleteFeatures",{objectIds:a},function(a,d){var e=d&&d.deleteResults?d.deleteResults:void 0;b&&b.call(c,a||d.deleteResults[0].error,e)},c)}}),ja="https:"!==window.location.protocol?"http:":"https:",ka=b.TileLayer.extend({statics:{TILES:{Streets:{urlTemplate:ja+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Street_Map"}},Topographic:{urlTemplate:ja+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Topo_Map"}},Oceans:{urlTemplate:ja+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/Ocean_Basemap"}},OceansLabels:{urlTemplate:ja+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:e?"esri-labels":"tilePane"}},NationalGeographic:{urlTemplate:ja+"//{s}.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"National Geographic, DeLorme, HERE, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, increment P Corp."}},DarkGray:{urlTemplate:ja+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},DarkGrayLabels:{urlTemplate:ja+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:e?"esri-labels":"tilePane",attribution:""}},Gray:{urlTemplate:ja+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},GrayLabels:{urlTemplate:ja+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:e?"esri-labels":"tilePane",attribution:""}},Imagery:{urlTemplate:ja+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"DigitalGlobe, GeoEye, i-cubed, USDA, USGS, AEX, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community"}},ImageryLabels:{urlTemplate:ja+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:e?"esri-labels":"tilePane",attribution:""}},ImageryTransportation:{urlTemplate:ja+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:e?"esri-labels":"tilePane"}},ShadedRelief:{urlTemplate:ja+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS"}},ShadedReliefLabels:{urlTemplate:ja+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places_Alternate/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:12,subdomains:["server","services"],pane:e?"esri-labels":"tilePane",attribution:""}},Terrain:{urlTemplate:ja+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS, NOAA"}},TerrainLabels:{urlTemplate:ja+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],pane:e?"esri-labels":"tilePane",attribution:""}},USATopo:{urlTemplate:ja+"//{s}.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:15,subdomains:["server","services"],attribution:"USGS, National Geographic Society, i-cubed"}}}},initialize:function(a,c){var d;if("object"==typeof a&&a.urlTemplate&&a.options)d=a;else{if("string"!=typeof a||!ka.TILES[a])throw new Error('L.esri.BasemapLayer: Invalid parameter. Use one of "Streets", "Topographic", "Oceans", "OceansLabels", "NationalGeographic", "Gray", "GrayLabels", "DarkGray", "DarkGrayLabels", "Imagery", "ImageryLabels", "ImageryTransportation", "ShadedRelief", "ShadedReliefLabels", "Terrain", "TerrainLabels" or "USATopo"');d=ka.TILES[a]}var e=b.Util.extend(d.options,c);b.Util.setOptions(this,e),this.options.token&&(d.urlTemplate+="?token="+this.options.token),b.TileLayer.prototype.initialize.call(this,d.urlTemplate,e)},onAdd:function(a){N(a),"esri-labels"===this.options.pane&&this._initPane(),this.options.attributionUrl&&O(this.options.attributionUrl,a),a.on("moveend",P),b.TileLayer.prototype.onAdd.call(this,a)},onRemove:function(a){a.off("moveend",P),b.TileLayer.prototype.onRemove.call(this,a)},_initPane:function(){if(!this._map.getPane(this.options.pane)){var a=this._map.createPane(this.options.pane);a.style.pointerEvents="none",a.style.zIndex=500}},getAttribution:function(){if(this.options.attribution)var a='<span class="esri-dynamic-attribution">'+this.options.attribution+"</span>";return a}}),ma=b.TileLayer.extend({options:{zoomOffsetAllowance:.1,errorTileUrl:"http://downloads2.esri.com/support/TechArticles/blank256.png"},statics:{MercatorZoomLevels:{0:156543.033928,1:78271.5169639999,2:39135.7584820001,3:19567.8792409999,4:9783.93962049996,5:4891.96981024998,6:2445.98490512499,7:1222.99245256249,8:611.49622628138,9:305.748113140558,10:152.874056570411,11:76.4370282850732,12:38.2185141425366,13:19.1092570712683,14:9.55462853563415,15:4.77731426794937,16:2.38865713397468,17:1.19432856685505,18:.597164283559817,19:.298582141647617,20:.14929107082381,21:.07464553541191,22:.0373227677059525,23:.0186613838529763}},initialize:function(a){a.url=I(a.url),a=b.Util.setOptions(this,a),this.tileUrl=a.url+"tile/{z}/{y}/{x}",this.service=ea(a),this.service.addEventParent(this);var c=new RegExp(/tiles.arcgis(online)?\.com/g);c.test(a.url)&&(this.tileUrl=this.tileUrl.replace("://tiles","://tiles{s}"),a.subdomains=["1","2","3","4"]),this.options.token&&(this.tileUrl+="?token="+this.options.token),b.TileLayer.prototype.initialize.call(this,this.tileUrl,a)},getTileUrl:function(a){return b.Util.template(this.tileUrl,b.extend({s:this._getSubdomain(a),z:this._lodMap&&this._lodMap[a.z]?this._lodMap[a.z]:a.z,x:a.x,y:a.y},this.options))},createTile:function(a,c){var d=document.createElement("img");return b.DomEvent.on(d,"load",b.bind(this._tileOnLoad,this,c,d)),b.DomEvent.on(d,"error",b.bind(this._tileOnError,this,c,d)),this.options.crossOrigin&&(d.crossOrigin=""),d.alt="",!this._lodMap||this._lodMap&&this._lodMap[a.z]?d.src=this.getTileUrl(a):this.once("lodmap",function(){d.src=this.getTileUrl(a)},this),d},onAdd:function(a){N(a),a.options.crs!==b.CRS.EPSG3857||this._lodMap||(this._lodMap={},this.metadata(function(b,c){if(!b&&c.spatialReference){var d=c.spatialReference.latestWkid||c.spatialReference.wkid;if(!this.options.attribution&&a.attributionControl&&c.copyrightText&&(this.options.attribution=c.copyrightText,a.attributionControl.addAttribution(this.getAttribution())),102100===d||3857===d){for(var e=c.tileInfo.lods,f=ma.MercatorZoomLevels,g=0;g<e.length;g++){var h=e[g];for(var i in f){var j=f[i];if(this._withinPercentage(h.resolution,j,this.options.zoomOffsetAllowance)){this._lodMap[i]=h.level;break}}}this.fire("lodmap")}else L("L.esri.TiledMapLayer is using a non-mercator spatial reference. Support may be available through Proj4Leaflet http://esri.github.io/esri-leaflet/examples/non-mercator-projection.html")}},this)),b.TileLayer.prototype.onAdd.call(this,a)},metadata:function(a,b){return this.service.metadata(a,b),this},identify:function(){return this.service.identify()},find:function(){return this.service.find()},query:function(){return this.service.query()},authenticate:function(a){var b="?token="+a;return this.tileUrl=this.options.token?this.tileUrl.replace(/\?token=(.+)/g,b):this.tileUrl+b,this.options.token=a,this.service.authenticate(a),this},_withinPercentage:function(a,b,c){var d=Math.abs(a/b-1);return d<c}}),oa=b.ImageOverlay.extend({onAdd:function(a){this._topLeft=a.getPixelBounds().min,b.ImageOverlay.prototype.onAdd.call(this,a)},_reset:function(){this._map.options.crs===b.CRS.EPSG3857?b.ImageOverlay.prototype._reset.call(this):b.DomUtil.setPosition(this._image,this._topLeft.subtract(this._map.getPixelOrigin()))}}),pa=b.Layer.extend({options:{opacity:1,position:"front",f:"image",useCors:d,attribution:null,interactive:!1,alt:""},onAdd:function(a){N(a),this._update=b.Util.throttle(this._update,this.options.updateInterval,this),a.on("moveend",this._update,this),this._currentImage&&this._currentImage._bounds.equals(this._map.getBounds())?a.addLayer(this._currentImage):this._currentImage&&(this._map.removeLayer(this._currentImage),this._currentImage=null),this._update(),this._popup&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this.metadata(function(b,c){!b&&!this.options.attribution&&a.attributionControl&&c.copyrightText&&(this.options.attribution=c.copyrightText,a.attributionControl.addAttribution(this.getAttribution()))},this)},onRemove:function(a){this._currentImage&&this._map.removeLayer(this._currentImage),this._popup&&(this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._map.off("moveend",this._update,this)},bindPopup:function(a,c){return this._shouldRenderPopup=!1,this._lastClick=!1,this._popup=b.popup(c),this._popupFunction=a,this._map&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this},unbindPopup:function(){return this._map&&(this._map.closePopup(this._popup),this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._popup=!1,this},bringToFront:function(){return this.options.position="front",this._currentImage&&this._currentImage.bringToFront(),this},bringToBack:function(){return this.options.position="back",this._currentImage&&this._currentImage.bringToBack(),this},getAttribution:function(){return this.options.attribution},getOpacity:function(){return this.options.opacity},setOpacity:function(a){return this.options.opacity=a,this._currentImage.setOpacity(a),this},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(a,b){return this.options.from=a,this.options.to=b,this._update(),this},metadata:function(a,b){return this.service.metadata(a,b),this},authenticate:function(a){return this.service.authenticate(a),this},_renderImage:function(a,b,c){if(this._map){c&&(a="data:"+c+";base64,"+a);var d=new oa(a,b,{opacity:0,crossOrigin:this.options.useCors,alt:this.options.alt,pane:this.options.pane||this.getPane(),interactive:this.options.interactive}).addTo(this._map);d.once("load",function(a){if(this._map){var c=a.target,d=this._currentImage;c._bounds.equals(b)&&c._bounds.equals(this._map.getBounds())?(this._currentImage=c,"front"===this.options.position?this.bringToFront():this.bringToBack(),this._map&&this._currentImage._map?this._currentImage.setOpacity(this.options.opacity):this._currentImage._map.removeLayer(this._currentImage),d&&this._map&&this._map.removeLayer(d),d&&d._map&&d._map.removeLayer(d)):this._map.removeLayer(c)}this.fire("load",{bounds:b})},this),this.fire("loading",{bounds:b})}},_update:function(){if(this._map){var a=this._map.getZoom(),b=this._map.getBounds();if(!(this._animatingZoom||this._map._panTransition&&this._map._panTransition._inProgress)){if(a>this.options.maxZoom||a<this.options.minZoom)return void this._currentImage._map.removeLayer(this._currentImage);var c=this._buildExportParams();this._requestExport(c,b)}}},_renderPopup:function(a,c,d,e){if(a=b.latLng(a),this._shouldRenderPopup&&this._lastClick.equals(a)){var f=this._popupFunction(c,d,e);f&&this._popup.setLatLng(a).setContent(f).openOn(this._map)}},_resetPopupState:function(a){this._shouldRenderPopup=!1,this._lastClick=a.latlng}}),qa=pa.extend({options:{updateInterval:150,format:"jpgpng",transparent:!0,f:"json"},query:function(){return this.service.query()},identify:function(){return this.service.identify()},initialize:function(a){a.url=I(a.url),this.service=ga(a),this.service.addEventParent(this),b.Util.setOptions(this,a)},setPixelType:function(a){return this.options.pixelType=a,this._update(),this},getPixelType:function(){return this.options.pixelType},setBandIds:function(a){return b.Util.isArray(a)?this.options.bandIds=a.join(","):this.options.bandIds=a.toString(),this._update(),this},getBandIds:function(){return this.options.bandIds},setNoData:function(a,c){return b.Util.isArray(a)?this.options.noData=a.join(","):this.options.noData=a.toString(),c&&(this.options.noDataInterpretation=c),this._update(),this},getNoData:function(){return this.options.noData},getNoDataInterpretation:function(){return this.options.noDataInterpretation},setRenderingRule:function(a){this.options.renderingRule=a,this._update()},getRenderingRule:function(){return this.options.renderingRule},setMosaicRule:function(a){this.options.mosaicRule=a,this._update()},getMosaicRule:function(){return this.options.mosaicRule},_getPopupData:function(a){var c=b.Util.bind(function(c,d,e){c||setTimeout(b.Util.bind(function(){this._renderPopup(a.latlng,c,d,e)},this),300)},this),d=this.identify().at(a.latlng);this.options.mosaicRule&&d.setMosaicRule(this.options.mosaicRule),d.run(c),this._shouldRenderPopup=!0,this._lastClick=a.latlng},_buildExportParams:function(){var a=this._map.getBounds(),b=this._map.getSize(),c=this._map.options.crs.project(a._northEast),d=this._map.options.crs.project(a._southWest),e=this._map.latLngToLayerPoint(a._northEast),f=this._map.latLngToLayerPoint(a._southWest);(e.y>0||f.y<b.y)&&(b.y=f.y-e.y);var g=parseInt(this._map.options.crs.code.split(":")[1],10),h={bbox:[d.x,d.y,c.x,c.y].join(","),size:b.x+","+b.y,format:this.options.format,transparent:this.options.transparent,bboxSR:g,imageSR:g};return this.options.from&&this.options.to&&(h.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.options.pixelType&&(h.pixelType=this.options.pixelType),this.options.interpolation&&(h.interpolation=this.options.interpolation),this.options.compressionQuality&&(h.compressionQuality=this.options.compressionQuality),this.options.bandIds&&(h.bandIds=this.options.bandIds),this.options.noData&&(h.noData=this.options.noData),this.options.noDataInterpretation&&(h.noDataInterpretation=this.options.noDataInterpretation),this.service.options.token&&(h.token=this.service.options.token),this.options.renderingRule&&(h.renderingRule=JSON.stringify(this.options.renderingRule)),this.options.mosaicRule&&(h.mosaicRule=JSON.stringify(this.options.mosaicRule)),h},_requestExport:function(a,c){"json"===this.options.f?this.service.request("exportImage",a,function(a,b){a||(this.options.token&&(b.href+="?token="+this.options.token),this._renderImage(b.href,c))},this):(a.f="image",this._renderImage(this.options.url+"exportImage"+b.Util.getParamString(a),c))}}),sa=pa.extend({options:{updateInterval:150,layers:!1,layerDefs:!1,timeOptions:!1,format:"png24",transparent:!0,f:"json"},initialize:function(a){a.url=I(a.url),this.service=ea(a),this.service.addEventParent(this),(a.proxy||a.token)&&"json"!==a.f&&(a.f="json"),b.Util.setOptions(this,a)},getDynamicLayers:function(){return this.options.dynamicLayers},setDynamicLayers:function(a){return this.options.dynamicLayers=a,this._update(),this},getLayers:function(){return this.options.layers},setLayers:function(a){return this.options.layers=a,this._update(),this},getLayerDefs:function(){return this.options.layerDefs},setLayerDefs:function(a){return this.options.layerDefs=a,this._update(),this},getTimeOptions:function(){return this.options.timeOptions},setTimeOptions:function(a){return this.options.timeOptions=a,this._update(),this},query:function(){return this.service.query()},identify:function(){return this.service.identify()},find:function(){return this.service.find()},_getPopupData:function(a){var c=b.Util.bind(function(c,d,e){c||setTimeout(b.Util.bind(function(){this._renderPopup(a.latlng,c,d,e)},this),300)},this),d=this.identify().on(this._map).at(a.latlng);this.options.layers?d.layers("visible:"+this.options.layers.join(",")):d.layers("visible"),d.run(c),this._shouldRenderPopup=!0,this._lastClick=a.latlng},_buildExportParams:function(){var a=this._map.getBounds(),b=this._map.getSize(),c=this._map.options.crs.project(a.getNorthEast()),d=this._map.options.crs.project(a.getSouthWest()),e=parseInt(this._map.options.crs.code.split(":")[1],10),f=this._map.latLngToLayerPoint(a._northEast),g=this._map.latLngToLayerPoint(a._southWest);(f.y>0||g.y<b.y)&&(b.y=g.y-f.y);var h={bbox:[d.x,d.y,c.x,c.y].join(","),size:b.x+","+b.y,dpi:96,format:this.options.format,transparent:this.options.transparent,bboxSR:e,imageSR:e};return this.options.dynamicLayers&&(h.dynamicLayers=this.options.dynamicLayers),this.options.layers&&(h.layers="show:"+this.options.layers.join(",")),this.options.layerDefs&&(h.layerDefs=JSON.stringify(this.options.layerDefs)),this.options.timeOptions&&(h.timeOptions=JSON.stringify(this.options.timeOptions)),this.options.from&&this.options.to&&(h.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.service.options.token&&(h.token=this.service.options.token),h},_requestExport:function(a,c){"json"===this.options.f?this.service.request("export",a,function(a,b){a||(this.options.token&&(b.href+="?token="+this.options.token),b.href?this._renderImage(b.href,c):this._renderImage(b.imageData,c,b.contentType))},this):(a.f="image",this._renderImage(this.options.url+"export"+b.Util.getParamString(a),c))}}),ua=b.Layer.extend({options:{cellSize:512,updateInterval:150},initialize:function(a){a=b.setOptions(this,a),this._zooming=!1},onAdd:function(a){this._map=a,this._update=b.Util.throttle(this._update,this.options.updateInterval,this),this._reset(),this._update()},onRemove:function(){this._map.removeEventListener(this.getEvents(),this),this._removeCells()},getEvents:function(){var a={moveend:this._update,zoomstart:this._zoomstart,zoomend:this._reset};return a},addTo:function(a){return a.addLayer(this),this},removeFrom:function(a){return a.removeLayer(this),this},_zoomstart:function(){this._zooming=!0},_reset:function(){this._removeCells(),this._cells={},this._activeCells={},this._cellsToLoad=0,this._cellsTotal=0,this._cellNumBounds=this._getCellNumBounds(),this._resetWrap(),this._zooming=!1},_resetWrap:function(){var a=this._map,b=a.options.crs;if(!b.infinite){var c=this._getCellSize();b.wrapLng&&(this._wrapLng=[Math.floor(a.project([0,b.wrapLng[0]]).x/c),Math.ceil(a.project([0,b.wrapLng[1]]).x/c)]),b.wrapLat&&(this._wrapLat=[Math.floor(a.project([b.wrapLat[0],0]).y/c),Math.ceil(a.project([b.wrapLat[1],0]).y/c)])}},_getCellSize:function(){return this.options.cellSize},_update:function(){if(this._map){var a=this._map.getPixelBounds(),c=this._getCellSize(),d=b.bounds(a.min.divideBy(c).floor(),a.max.divideBy(c).floor());this._removeOtherCells(d),this._addCells(d),this.fire("cellsupdated")}},_addCells:function(a){var f,g,h,c=[],d=a.getCenter(),e=this._map.getZoom();for(f=a.min.y;f<=a.max.y;f++)for(g=a.min.x;g<=a.max.x;g++)h=b.point(g,f),h.z=e,this._isValidCell(h)&&c.push(h);var i=c.length;if(0!==i)for(this._cellsToLoad+=i,this._cellsTotal+=i,c.sort(function(a,b){return a.distanceTo(d)-b.distanceTo(d)}),g=0;g<i;g++)this._addCell(c[g])},_isValidCell:function(a){var c=this._map.options.crs;if(!c.infinite){var d=this._cellNumBounds;if(!c.wrapLng&&(a.x<d.min.x||a.x>d.max.x)||!c.wrapLat&&(a.y<d.min.y||a.y>d.max.y))return!1}if(!this.options.bounds)return!0;var e=this._cellCoordsToBounds(a);return b.latLngBounds(this.options.bounds).intersects(e)},_cellCoordsToBounds:function(a){var c=this._map,d=this.options.cellSize,e=a.multiplyBy(d),f=e.add([d,d]),g=c.wrapLatLng(c.unproject(e,a.z)),h=c.wrapLatLng(c.unproject(f,a.z));return b.latLngBounds(g,h)},_cellCoordsToKey:function(a){return a.x+":"+a.y},_keyToCellCoords:function(a){var c=a.split(":"),d=parseInt(c[0],10),e=parseInt(c[1],10);return b.point(d,e)},_removeOtherCells:function(a){for(var b in this._cells)a.contains(this._keyToCellCoords(b))||this._removeCell(b)},_removeCell:function(a){var b=this._activeCells[a];b&&(delete this._activeCells[a],this.cellLeave&&this.cellLeave(b.bounds,b.coords),this.fire("cellleave",{bounds:b.bounds,coords:b.coords}))},_removeCells:function(){for(var a in this._cells){var b=this._cells[a].bounds,c=this._cells[a].coords;this.cellLeave&&this.cellLeave(b,c),this.fire("cellleave",{bounds:b,coords:c})}},_addCell:function(a){this._wrapCoords(a);var b=this._cellCoordsToKey(a),c=this._cells[b];c&&!this._activeCells[b]&&(this.cellEnter&&this.cellEnter(c.bounds,a),this.fire("cellenter",{bounds:c.bounds,coords:a}),this._activeCells[b]=c),c||(c={coords:a,bounds:this._cellCoordsToBounds(a)},this._cells[b]=c,this._activeCells[b]=c,this.createCell&&this.createCell(c.bounds,a),this.fire("cellcreate",{bounds:c.bounds,coords:a}))},_wrapCoords:function(a){a.x=this._wrapLng?b.Util.wrapNum(a.x,this._wrapLng):a.x,a.y=this._wrapLat?b.Util.wrapNum(a.y,this._wrapLat):a.y},_getCellNumBounds:function(){var a=this._map.getPixelWorldBounds(),c=this._getCellSize();return a?b.bounds(a.min.divideBy(c).floor(),a.max.divideBy(c).ceil().subtract([1,1])):null}});va.prototype.query=function(a){var b=this.getIndex(a);return this.values[b]},va.prototype.getIndex=function(b){this.dirty&&this.sort();for(var e,f,c=0,d=this.values.length-1;c<=d;)if(e=(c+d)/2|0,f=this.values[Math.round(e)],+f.value<+b)c=e+1;else{if(!(+f.value>+b))return e;d=e-1}return Math.abs(~d)},va.prototype.between=function(b,c){var d=this.getIndex(b),e=this.getIndex(c);if(0===d&&0===e)return[];for(;this.values[d-1]&&this.values[d-1].value===b;)d--;for(;this.values[e+1]&&this.values[e+1].value===c;)e++;return this.values[e]&&this.values[e].value===c&&this.values[e+1]&&e++,this.values.slice(d,e)},va.prototype.insert=function(b){return this.values.splice(this.getIndex(b.value),0,b),this},va.prototype.bulkAdd=function(b,c){return this.values=this.values.concat([].concat(b||[])),c?this.sort():this.dirty=!0,this},va.prototype.sort=function(){return this.values.sort(function(a,b){return+b.value-+a.value}).reverse(),this.dirty=!1,this};var wa=ua.extend({options:{attribution:null,where:"1=1",fields:["*"],from:!1,to:!1,timeField:!1,timeFilterMode:"server",simplifyFactor:0,precision:6},initialize:function(a){if(ua.prototype.initialize.call(this,a),a.url=I(a.url),a=b.setOptions(this,a),this.service=ia(a),this.service.addEventParent(this),"*"!==this.options.fields[0]){for(var c=!1,d=0;d<this.options.fields.length;d++)this.options.fields[d].match(/^(OBJECTID|FID|OID|ID)$/i)&&(c=!0);c===!1&&L("no known esriFieldTypeOID field detected in fields Array.  Please add an attribute field containing unique IDs to ensure the layer can be drawn correctly.")}this.options.timeField.start&&this.options.timeField.end?(this._startTimeIndex=new va,this._endTimeIndex=new va):this.options.timeField&&(this._timeIndex=new va),this._cache={},this._currentSnapshot=[],this._activeRequests=0},onAdd:function(a){return N(a),this.service.metadata(function(b,c){if(!b){var d=c.supportedQueryFormats;d&&d.indexOf("geoJSON")!==-1&&(this.service.options.isModern=!0),!this.options.attribution&&a.attributionControl&&c.copyrightText&&(this.options.attribution=c.copyrightText,a.attributionControl.addAttribution(this.getAttribution()))}},this),a.on("zoomend",this._handleZoomChange,this),ua.prototype.onAdd.call(this,a)},onRemove:function(a){return a.off("zoomend",this._handleZoomChange,this),ua.prototype.onRemove.call(this,a)},getAttribution:function(){return this.options.attribution},createCell:function(a,b){this._requestFeatures(a,b)},_requestFeatures:function(a,c,d){return this._activeRequests++,1===this._activeRequests&&this.fire("loading",{bounds:a},!0),this._buildQuery(a).run(function(e,f,g){g&&g.exceededTransferLimit&&this.fire("drawlimitexceeded"),!e&&f&&f.features.length&&b.Util.requestAnimFrame(b.Util.bind(function(){this._addFeatures(f.features,c),this._postProcessFeatures(a)},this)),e||!f||f.features.length||this._postProcessFeatures(a),e&&this._postProcessFeatures(a),d&&d.call(this,e,f)},this)},_postProcessFeatures:function(a){this._activeRequests--,this._activeRequests<=0&&this.fire("load",{bounds:a})},_cacheKey:function(a){return a.z+":"+a.x+":"+a.y},_addFeatures:function(a,b){var c=this._cacheKey(b);this._cache[c]=this._cache[c]||[];for(var d=a.length-1;d>=0;d--){var e=a[d].id;this._currentSnapshot.push(e),this._cache[c].push(e)}this.options.timeField&&this._buildTimeIndexes(a),this.createLayers(a)},_buildQuery:function(a){var b=this.service.query().intersects(a).where(this.options.where).fields(this.options.fields).precision(this.options.precision);return this.options.simplifyFactor&&b.simplify(this._map,this.options.simplifyFactor),"server"===this.options.timeFilterMode&&this.options.from&&this.options.to&&b.between(this.options.from,this.options.to),b},setWhere:function(a,c,d){this.options.where=a&&a.length?a:"1=1";for(var e=[],f=[],g=0,h=null,i=b.Util.bind(function(a,i){if(a&&(h=a),i)for(var j=i.features.length-1;j>=0;j--)f.push(i.features[j].id);g--,g<=0&&(this._currentSnapshot=f,b.Util.requestAnimFrame(b.Util.bind(function(){this.removeLayers(e),this.addLayers(f),c&&c.call(d,h)},this)))},this),j=this._currentSnapshot.length-1;j>=0;j--)e.push(this._currentSnapshot[j]);for(var k in this._activeCells){g++;var l=this._keyToCellCoords(k),m=this._cellCoordsToBounds(l);this._requestFeatures(m,k,i)}return this},getWhere:function(){return this.options.where},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(a,c,d,e){var f=this.options.from,g=this.options.to,h=0,i=null,j=b.Util.bind(function(b){b&&(i=b),this._filterExistingFeatures(f,g,a,c),h--,d&&h<=0&&d.call(e,i)},this);if(this.options.from=a,this.options.to=c,this._filterExistingFeatures(f,g,a,c),"server"===this.options.timeFilterMode)for(var k in this._activeCells){h++;var l=this._keyToCellCoords(k),m=this._cellCoordsToBounds(l);this._requestFeatures(m,k,j)}return this},refresh:function(){for(var a in this._activeCells){var b=this._keyToCellCoords(a),c=this._cellCoordsToBounds(b);this._requestFeatures(c,a)}this.redraw&&this.once("load",function(){this.eachFeature(function(a){this._redraw(a.feature.id)},this)},this)},_filterExistingFeatures:function(a,c,d,e){var f=a&&c?this._getFeaturesInTimeRange(a,c):this._currentSnapshot,g=this._getFeaturesInTimeRange(d,e);if(g.indexOf)for(var h=0;h<g.length;h++){var i=f.indexOf(g[h]);i>=0&&f.splice(i,1)}b.Util.requestAnimFrame(b.Util.bind(function(){this.removeLayers(f),this.addLayers(g)},this))},_getFeaturesInTimeRange:function(a,b){var d,c=[];if(this.options.timeField.start&&this.options.timeField.end){var e=this._startTimeIndex.between(a,b),f=this._endTimeIndex.between(a,b);d=e.concat(f)}else d=this._timeIndex.between(a,b);for(var g=d.length-1;g>=0;g--)c.push(d[g].id);return c},_buildTimeIndexes:function(a){var b,c;if(this.options.timeField.start&&this.options.timeField.end){var d=[],e=[];for(b=a.length-1;b>=0;b--)c=a[b],d.push({id:c.id,value:new Date(c.properties[this.options.timeField.start])}),e.push({id:c.id,value:new Date(c.properties[this.options.timeField.end])});this._startTimeIndex.bulkAdd(d),this._endTimeIndex.bulkAdd(e)}else{var f=[];for(b=a.length-1;b>=0;b--)c=a[b],f.push({id:c.id,value:new Date(c.properties[this.options.timeField])});this._timeIndex.bulkAdd(f)}},_featureWithinTimeRange:function(a){if(!this.options.from||!this.options.to)return!0;var b=+this.options.from.valueOf(),c=+this.options.to.valueOf();if("string"==typeof this.options.timeField){var d=+a.properties[this.options.timeField];return d>=b&&d<=c}if(this.options.timeField.start&&this.options.timeField.end){var e=+a.properties[this.options.timeField.start],f=+a.properties[this.options.timeField.end];return e>=b&&e<=c||f>=b&&f<=c;
}},_visibleZoom:function(){if(!this._map)return!1;var a=this._map.getZoom();return!(a>this.options.maxZoom||a<this.options.minZoom)},_handleZoomChange:function(){if(this._visibleZoom())for(var a in this._activeCells){var b=this._activeCells[a].coords,c=this._cacheKey(b);this._cache[c]&&this.addLayers(this._cache[c])}else this.removeLayers(this._currentSnapshot),this._currentSnapshot=[]},authenticate:function(a){return this.service.authenticate(a),this},metadata:function(a,b){return this.service.metadata(a,b),this},query:function(){return this.service.query()},_getMetadata:function(a){if(this._metadata){var c;a(c,this._metadata)}else this.metadata(b.Util.bind(function(b,c){this._metadata=c,a(b,this._metadata)},this))},addFeature:function(a,c,d){this._getMetadata(b.Util.bind(function(e,f){return e?void(c&&c.call(this,e,null)):void this.service.addFeature(a,b.Util.bind(function(b,e){b||(a.properties[f.objectIdField]=e.objectId,a.id=e.objectId,this.createLayers([a])),c&&c.call(d,b,e)},this))},this))},updateFeature:function(a,b,c){this.service.updateFeature(a,function(d,e){d||(this.removeLayers([a.id],!0),this.createLayers([a])),b&&b.call(c,d,e)},this)},deleteFeature:function(a,b,c){this.service.deleteFeature(a,function(a,d){!a&&d.objectId&&this.removeLayers([d.objectId],!0),b&&b.call(c,a,d)},this)},deleteFeatures:function(a,b,c){return this.service.deleteFeatures(a,function(a,d){if(!a&&d.length>0)for(var e=0;e<d.length;e++)this.removeLayers([d[e].objectId],!0);b&&b.call(c,a,d)},this)}}),xa=wa.extend({options:{cacheLayers:!0},initialize:function(a){wa.prototype.initialize.call(this,a),this._originalStyle=this.options.style,this._layers={}},onRemove:function(a){for(var b in this._layers)a.removeLayer(this._layers[b]),this.fire("removefeature",{feature:this._layers[b].feature,permanent:!1},!0);return wa.prototype.onRemove.call(this,a)},createNewLayer:function(a){var c=b.GeoJSON.geometryToLayer(a,this.options);return c.defaultOptions=c.options,c},_updateLayer:function(a,c){var d=[],e=this.options.coordsToLatLng||b.GeoJSON.coordsToLatLng;switch(c.properties&&(a.feature.properties=c.properties),c.geometry.type){case"Point":d=b.GeoJSON.coordsToLatLng(c.geometry.coordinates),a.setLatLng(d);break;case"LineString":d=b.GeoJSON.coordsToLatLngs(c.geometry.coordinates,0,e),a.setLatLngs(d);break;case"MultiLineString":d=b.GeoJSON.coordsToLatLngs(c.geometry.coordinates,1,e),a.setLatLngs(d);break;case"Polygon":d=b.GeoJSON.coordsToLatLngs(c.geometry.coordinates,1,e),a.setLatLngs(d);break;case"MultiPolygon":d=b.GeoJSON.coordsToLatLngs(c.geometry.coordinates,2,e),a.setLatLngs(d)}},createLayers:function(a){for(var b=a.length-1;b>=0;b--){var e,c=a[b],d=this._layers[c.id];this._visibleZoom()&&d&&!this._map.hasLayer(d)&&(this._map.addLayer(d),this.fire("addfeature",{feature:d.feature},!0)),d&&this.options.simplifyFactor>0&&(d.setLatLngs||d.setLatLng)&&this._updateLayer(d,c),d||(e=this.createNewLayer(c),e.feature=c,e.addEventParent(this),this.options.onEachFeature&&this.options.onEachFeature(e.feature,e),this._layers[e.feature.id]=e,this.setFeatureStyle(e.feature.id,this.options.style),this.fire("createfeature",{feature:e.feature},!0),this._visibleZoom()&&(!this.options.timeField||this.options.timeField&&this._featureWithinTimeRange(c))&&(this.fire("addfeature",{feature:e.feature},!0),this._map.addLayer(e)))}},addLayers:function(a){for(var b=a.length-1;b>=0;b--){var c=this._layers[a[b]];c&&(this.fire("addfeature",{feature:c.feature},!0),this._map.addLayer(c))}},removeLayers:function(a,b){for(var c=a.length-1;c>=0;c--){var d=a[c],e=this._layers[d];e&&(this.fire("removefeature",{feature:e.feature,permanent:b},!0),this._map.removeLayer(e)),e&&b&&delete this._layers[d]}},cellEnter:function(a,c){!this._zooming&&this._map&&b.Util.requestAnimFrame(b.Util.bind(function(){var a=this._cacheKey(c),b=this._cellCoordsToKey(c),d=this._cache[a];this._activeCells[b]&&d&&this.addLayers(d)},this))},cellLeave:function(a,c){this._zooming||b.Util.requestAnimFrame(b.Util.bind(function(){if(this._map){var a=this._cacheKey(c),b=this._cellCoordsToKey(c),d=this._cache[a],e=this._map.getBounds();if(!this._activeCells[b]&&d){for(var f=!0,g=0;g<d.length;g++){var h=this._layers[d[g]];h&&h.getBounds&&e.intersects(h.getBounds())&&(f=!1)}f&&this.removeLayers(d,!this.options.cacheLayers),!this.options.cacheLayers&&f&&(delete this._cache[a],delete this._cells[b],delete this._activeCells[b])}}},this))},resetStyle:function(){return this.options.style=this._originalStyle,this.eachFeature(function(a){this.resetFeatureStyle(a.feature.id)},this),this},setStyle:function(a){return this.options.style=a,this.eachFeature(function(b){this.setFeatureStyle(b.feature.id,a)},this),this},resetFeatureStyle:function(a){var c=this._layers[a],d=this._originalStyle||b.Path.prototype.options;return c&&(b.Util.extend(c.options,c.defaultOptions),this.setFeatureStyle(a,d)),this},setFeatureStyle:function(a,b){var c=this._layers[a];return"function"==typeof b&&(b=b(c.feature)),c.setStyle&&c.setStyle(b),this},eachFeature:function(a,b){for(var c in this._layers)a.call(b,this._layers[c]);return this},getFeature:function(a){return this._layers[a]},bringToBack:function(){this.eachFeature(function(a){a.bringToBack&&a.bringToBack()})},bringToFront:function(){this.eachFeature(function(a){a.bringToFront&&a.bringToFront()})},redraw:function(a){return a&&this._redraw(a),this},_redraw:function(a){var c=this._layers[a],d=c.feature;if(c&&c.setIcon&&this.options.pointToLayer&&this.options.pointToLayer){var e=this.options.pointToLayer(d,b.latLng(d.geometry.coordinates[1],d.geometry.coordinates[0])),f=e.options.icon;c.setIcon(f)}if(c&&c.setStyle&&this.options.pointToLayer){var g=this.options.pointToLayer(d,b.latLng(d.geometry.coordinates[1],d.geometry.coordinates[0])),h=g.options;this.setFeatureStyle(d.id,h)}c&&c.setStyle&&this.options.style&&this.resetStyle(d.id)}});a.VERSION=c,a.Support=f,a.Util=Q,a.get=n,a.post=j,a.request=l,a.Task=R,a.task=S,a.Query=T,a.query=U,a.Find=V,a.find=W,a.Identify=X,a.identify=Y,a.IdentifyFeatures=Z,a.identifyFeatures=$,a.IdentifyImage=_,a.identifyImage=aa,a.Service=ba,a.service=ca,a.MapService=da,a.mapService=ea,a.ImageService=fa,a.imageService=ga,a.FeatureLayerService=ha,a.featureLayerService=ia,a.BasemapLayer=ka,a.basemapLayer=la,a.TiledMapLayer=ma,a.tiledMapLayer=na,a.RasterLayer=pa,a.ImageMapLayer=qa,a.imageMapLayer=ra,a.DynamicMapLayer=sa,a.dynamicMapLayer=ta,a.FeatureManager=wa,a.FeatureLayer=xa,a.featureLayer=ya}),function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports,require("leaflet"),require("esri-leaflet")):"function"==typeof define&&define.amd?define(["exports","leaflet","esri-leaflet"],b):b((a.L=a.L||{},a.L.esri=a.L.esri||{},a.L.esri.Vector=a.L.esri.Vector||{}),a.L,a.L.esri)}(this,function(a,b,c){"use strict";function e(a,d){c.request(a,{},function(e,f){if(e)throw new Error("Unable to fetch vector tile style metadata");c.request(f.sources.esri.url,{},function(c,e){c||(f.sources.esri={type:"vector",scheme:"xyz",tilejson:e.tilejson||"2.0.0",format:e.tileInfo&&e.tileInfo.format||"pbf",index:e.tileMap?f.sources.esri.url+e.tileMap:null,tiles:[f.sources.esri.url+e.tiles[0]],description:e.description,name:e.name},f.glyphs.indexOf("http")===-1&&(f.glyphs=a.replace("styles/root.json",f.glyphs.replace("../","")),f.sprite=a.replace("styles/root.json",f.sprite.replace("../",""))),f.index=e.tileInfo.tileMap,d._mapboxGL=b.mapboxGL({accessToken:"ezree",style:f}),d._ready=!0,d.fire("ready",{},!0))},d)},d)}function g(a){return new f(a)}function i(a){return new h(a)}b="default"in b?b.default:b;var d="1.0.3";!function(b){if("object"==typeof a&&"undefined"!=typeof module)module.exports=b();else if("function"==typeof define&&define.amd)define([],b);else{var c;c="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,c.mapboxgl=b()}}(function(){var a;return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(a){a?(this.array=a.array,this.pos=a.pos):(this.array=new ArrayBuffer(this.defaultLength),this.length=this.defaultLength,this.setupViews())}b.exports=d,d.prototype={pos:0,itemSize:4,defaultLength:8192,arrayType:"ARRAY_BUFFER",get index(){return this.pos/this.itemSize},setupViews:function(){this.ubytes=new Uint8Array(this.array),this.bytes=new Int8Array(this.array),this.ushorts=new Uint16Array(this.array),this.shorts=new Int16Array(this.array)},bind:function(a){var b=a[this.arrayType];this.buffer?a.bindBuffer(b,this.buffer):(this.buffer=a.createBuffer(),a.bindBuffer(b,this.buffer),a.bufferData(b,this.array.slice(0,this.pos),a.STATIC_DRAW),this.array=null)},destroy:function(a){this.buffer&&a.deleteBuffer(this.buffer)},resize:function(){if(this.length<this.pos+this.itemSize){for(;this.length<this.pos+this.itemSize;)this.length=2*Math.round(1.5*this.length/2);this.array=new ArrayBuffer(this.length);var a=new Uint8Array(this.array);a.set(this.ubytes),this.setupViews()}}}},{}],2:[function(a,b,c){var d=a("./line_vertex_buffer"),e=a("./line_element_buffer"),f=a("./fill_vertex_buffer"),g=a("./triangle_element_buffer"),h=a("./outline_element_buffer"),i=a("./glyph_vertex_buffer"),j=a("./triangle_element_buffer"),k=a("./icon_vertex_buffer"),l=a("./triangle_element_buffer"),m=a("./collision_box_vertex_buffer"),n=a("./circle_vertex_buffer"),o=a("./triangle_element_buffer");b.exports=function(a){return a=a||{},{glyphVertex:new i(a.glyphVertex),glyphElement:new j(a.glyphElement),iconVertex:new k(a.iconVertex),iconElement:new l(a.iconElement),circleVertex:new n(a.circleVertex),circleElement:new o(a.circleElement),fillVertex:new f(a.fillVertex),fillElement:new g(a.fillElement),outlineElement:new h(a.outlineElement),lineVertex:new d(a.lineVertex),lineElement:new e(a.lineElement),collisionBoxVertex:new m(a.collisionBoxVertex)}}},{"./circle_vertex_buffer":3,"./collision_box_vertex_buffer":4,"./fill_vertex_buffer":5,"./glyph_vertex_buffer":6,"./icon_vertex_buffer":7,"./line_element_buffer":8,"./line_vertex_buffer":9,"./outline_element_buffer":10,"./triangle_element_buffer":11}],3:[function(a,b,c){function d(a){f.call(this,a)}var e=a("../../util/util"),f=a("./buffer");b.exports=d,d.prototype=e.inherit(f,{defaultLength:32768,itemSize:4,add:function(a,b,c,d){var e=this.pos,f=e/2;this.resize(),this.shorts[f+0]=2*a+(c+1)/2,this.shorts[f+1]=2*b+(d+1)/2,this.pos+=this.itemSize},bind:function(a,b,c){f.prototype.bind.call(this,a),a.vertexAttribPointer(b.a_pos,2,a.SHORT,!1,this.itemSize,c+0)}})},{"../../util/util":106,"./buffer":1}],4:[function(a,b,c){function d(a){f.call(this,a)}var e=a("../../util/util"),f=a("./buffer");b.exports=d,d.prototype=e.inherit(f,{itemSize:12,defaultLength:32768,add:function(a,b,c,d){var e=this.pos,f=e/2,g=this.index;return this.resize(),this.shorts[f+0]=a.x,this.shorts[f+1]=a.y,this.shorts[f+2]=Math.round(b.x),this.shorts[f+3]=Math.round(b.y),this.ubytes[e+8]=Math.floor(10*c),this.ubytes[e+9]=Math.floor(10*d),this.pos+=this.itemSize,g}})},{"../../util/util":106,"./buffer":1}],5:[function(a,b,c){function d(a){f.call(this,a)}var e=a("../../util/util"),f=a("./buffer");b.exports=d,d.prototype=e.inherit(f,{itemSize:4,add:function(a,b){var c=this.pos/2;this.resize(),this.shorts[c+0]=a,this.shorts[c+1]=b,this.pos+=this.itemSize}})},{"../../util/util":106,"./buffer":1}],6:[function(a,b,c){function d(a){f.call(this,a)}var e=a("../../util/util"),f=a("./buffer");b.exports=d,d.prototype=e.inherit(f,{defaultLength:32768,itemSize:16,add:function(a,b,c,d,e,f,g,h,i){var j=this.pos,k=j/2;this.resize(),this.shorts[k+0]=a,this.shorts[k+1]=b,this.shorts[k+2]=Math.round(64*c),this.shorts[k+3]=Math.round(64*d),this.ubytes[j+8]=Math.floor(e/4),this.ubytes[j+9]=Math.floor(f/4),this.ubytes[j+10]=Math.floor(10*i),this.ubytes[j+12]=Math.floor(10*g),this.ubytes[j+13]=Math.floor(10*Math.min(h,25)),this.pos+=this.itemSize},bind:function(a,b,c){f.prototype.bind.call(this,a);var d=this.itemSize;a.vertexAttribPointer(b.a_pos,2,a.SHORT,!1,d,c+0),a.vertexAttribPointer(b.a_offset,2,a.SHORT,!1,d,c+4),a.vertexAttribPointer(b.a_data1,4,a.UNSIGNED_BYTE,!1,d,c+8),a.vertexAttribPointer(b.a_data2,2,a.UNSIGNED_BYTE,!1,d,c+12)}})},{"../../util/util":106,"./buffer":1}],7:[function(a,b,c){function d(a){f.call(this,a)}var e=a("../../util/util"),f=a("./buffer");b.exports=d,d.prototype=e.inherit(f,{defaultLength:32768,itemSize:16,add:function(a,b,c,d,e,f,g,h,i){var j=this.pos,k=j/2;this.resize(),this.shorts[k+0]=a,this.shorts[k+1]=b,this.shorts[k+2]=Math.round(64*c),this.shorts[k+3]=Math.round(64*d),this.ubytes[j+8]=e/4,this.ubytes[j+9]=f/4,this.ubytes[j+10]=Math.floor(10*(i||0)),this.ubytes[j+12]=Math.floor(10*(g||0)),this.ubytes[j+13]=Math.floor(10*Math.min(h||25,25)),this.pos+=this.itemSize},bind:function(a,b,c){f.prototype.bind.call(this,a);var d=this.itemSize;a.vertexAttribPointer(b.a_pos,2,a.SHORT,!1,d,c+0),a.vertexAttribPointer(b.a_offset,2,a.SHORT,!1,d,c+4),a.vertexAttribPointer(b.a_data1,4,a.UNSIGNED_BYTE,!1,d,c+8),a.vertexAttribPointer(b.a_data2,2,a.UNSIGNED_BYTE,!1,d,c+12)}})},{"../../util/util":106,"./buffer":1}],8:[function(a,b,c){function d(a){f.call(this,a)}var e=a("../../util/util"),f=a("./buffer");b.exports=d,d.prototype=e.inherit(f,{itemSize:6,arrayType:"ELEMENT_ARRAY_BUFFER",add:function(a,b,c){var d=this.pos/2;this.resize(),this.ushorts[d+0]=a,this.ushorts[d+1]=b,this.ushorts[d+2]=c,this.pos+=this.itemSize}})},{"../../util/util":106,"./buffer":1}],9:[function(a,b,c){function d(a){f.call(this,a)}var e=a("../../util/util"),f=a("./buffer");b.exports=d,d.extrudeScale=63,d.prototype=e.inherit(f,{itemSize:8,defaultLength:32768,add:function(a,b,c,e,f){var g=this.pos,h=g/2,i=this.index,j=d.extrudeScale;return this.resize(),this.shorts[h+0]=2*Math.floor(a.x)|c,this.shorts[h+1]=2*Math.floor(a.y)|e,this.bytes[g+4]=Math.round(j*b.x),this.bytes[g+5]=Math.round(j*b.y),this.bytes[g+6]=(f||0)/128,this.bytes[g+7]=(f||0)%128,this.pos+=this.itemSize,i}})},{"../../util/util":106,"./buffer":1}],10:[function(a,b,c){function d(a){f.call(this,a)}var e=a("../../util/util"),f=a("./buffer");b.exports=d,d.prototype=e.inherit(f,{itemSize:4,arrayType:"ELEMENT_ARRAY_BUFFER",add:function(a,b){var c=this.pos/2;this.resize(),this.ushorts[c+0]=a,this.ushorts[c+1]=b,this.pos+=this.itemSize}})},{"../../util/util":106,"./buffer":1}],11:[function(a,b,c){function d(a){f.call(this,a)}var e=a("../../util/util"),f=a("./buffer");b.exports=d,d.prototype=e.inherit(f,{itemSize:6,arrayType:"ELEMENT_ARRAY_BUFFER",add:function(a,b,c){var d=this.pos/2;this.resize(),this.ushorts[d+0]=a,this.ushorts[d+1]=b,this.ushorts[d+2]=c,this.pos+=this.itemSize}})},{"../../util/util":106,"./buffer":1}],12:[function(a,b,c){function d(a){this.buffers=a,this.elementGroups=new e(a.circleVertex,a.circleElement)}var e=a("./element_groups");b.exports=d,d.prototype.addFeatures=function(){for(var a=4096,b=0;b<this.features.length;b++)for(var c=this.features[b].loadGeometry()[0],d=0;d<c.length;d++){this.elementGroups.makeRoomFor(6);var e=c[d].x,f=c[d].y;if(!(0>e||e>=a||0>f||f>=a)){var g=this.buffers.circleVertex.index-this.elementGroups.current.vertexStartIndex;this.buffers.circleVertex.add(e,f,-1,-1),this.buffers.circleVertex.add(e,f,1,-1),this.buffers.circleVertex.add(e,f,1,1),this.buffers.circleVertex.add(e,f,-1,1),this.elementGroups.elementBuffer.add(g,g+1,g+2),this.elementGroups.elementBuffer.add(g,g+3,g+2),this.elementGroups.current.vertexLength+=4,this.elementGroups.current.elementLength+=2}}}},{"./element_groups":14}],13:[function(a,b,c){function d(a,b,c,d,l){var m=new k("layout",a.type,a.layout,{}).values(),n={lastIntegerZoom:1/0,lastIntegerZoomTime:0,lastZoom:0},o={};for(var p in m)o[p]=m[p].calculate(c,n);"symbol"===a.type&&(m["text-size"]&&(o["text-max-size"]=m["text-size"].calculate(18,n),o["text-size"]=m["text-size"].calculate(c+1,n)),m["icon-size"]&&(o["icon-max-size"]=m["icon-size"].calculate(18,n),o["icon-size"]=m["icon-size"].calculate(c+1,n)));var q="line"===a.type?e:"fill"===a.type?f:"symbol"===a.type?g:"circle"===a.type?h:null,r=new q(b,new i[a.type](o),d,c,l);return r.id=a.id,r.type=a.type,r["source-layer"]=a["source-layer"],r.interactive=a.interactive,r.minZoom=a.minzoom,r.maxZoom=a.maxzoom,r.filter=j(a.filter),r.features=[],r}b.exports=d;var e=a("./line_bucket"),f=a("./fill_bucket"),g=a("./symbol_bucket"),h=a("./circle_bucket"),i=a("../style/layout_properties"),j=a("feature-filter"),k=a("../style/style_declaration_set")},{"../style/layout_properties":53,"../style/style_declaration_set":59,"./circle_bucket":12,"./fill_bucket":16,"./line_bucket":17,"./symbol_bucket":18,"feature-filter":108}],14:[function(a,b,c){function d(a,b,c){this.vertexBuffer=a,this.elementBuffer=b,this.secondElementBuffer=c,this.groups=[]}function e(a,b,c){this.vertexStartIndex=a,this.elementStartIndex=b,this.secondElementStartIndex=c,this.elementLength=0,this.vertexLength=0,this.secondElementLength=0}b.exports=d,d.prototype.makeRoomFor=function(a){(!this.current||this.current.vertexLength+a>65535)&&(this.current=new e(this.vertexBuffer.index,this.elementBuffer&&this.elementBuffer.index,this.secondElementBuffer&&this.secondElementBuffer.index),this.groups.push(this.current))}},{}],15:[function(a,b,c){function d(a,b){this.x=a.x,this.y=a.y,this.z=a.z-Math.log(b)/Math.LN2,this.rtree=o(9),this.toBeInserted=[]}function e(a,b,c){return"Point"===b?i(a,c):"LineString"===b?g(a,c):"Polygon"===b&&(f(a,c)||g(a,c))}function f(a,b){return!!(m(a,new p(b[0],b[1]))||m(a,new p(b[0],b[3]))||m(a,new p(b[2],b[1]))||m(a,new p(b[2],b[3])))||g(a,b)}function g(a,b){for(var c=0;c<a.length;c++)for(var d=a[c],e=0,f=d.length-1;e<d.length;f=e++){var g=d[e],j=d[f],k=new p(g.y,g.x),l=new p(j.y,j.x);if(h(g,j,b[0],b[2],b[1])||h(g,j,b[0],b[2],b[3])||h(k,l,b[1],b[3],b[0])||h(k,l,b[1],b[3],b[2]))return!0}return i(a,b)}function h(a,b,c,d,e){if(b.y===a.y)return b.y===e&&Math.min(a.x,b.x)<=d&&Math.max(a.x,b.x)>=c;var f=(e-a.y)/(b.y-a.y),g=a.x+f*(b.x-a.x);return g>=c&&d>=g&&1>=f&&f>=0}function i(a,b){for(var c=0;c<a.length;c++)for(var d=a[c],e=0;e<d.length;e++)if(d[e].x>=b[0]&&d[e].y>=b[1]&&d[e].x<=b[2]&&d[e].y<=b[3])return!0;return!1}function j(a,b,c,d){return"Point"===b?n(a,c,d):"LineString"===b?l(a,c,d):"Polygon"===b&&(m(a,c)||l(a,c,d))}function k(a,b,c){var d=b.distSqr(c);if(0===d)return a.distSqr(b);var e=((a.x-b.x)*(c.x-b.x)+(a.y-b.y)*(c.y-b.y))/d;return 0>e?a.distSqr(b):e>1?a.distSqr(c):a.distSqr(c.sub(b)._mult(e)._add(b))}function l(a,b,c){for(var d=c*c,e=0;e<a.length;e++)for(var f=a[e],g=1;g<f.length;g++){var h=f[g-1],i=f[g];if(k(b,h,i)<d)return!0}return!1}function m(a,b){for(var c,d,e,f=!1,g=0;g<a.length;g++){c=a[g];for(var h=0,i=c.length-1;h<c.length;i=h++)d=c[h],e=c[i],d.y>b.y!=e.y>b.y&&b.x<(e.x-d.x)*(b.y-d.y)/(e.y-d.y)+d.x&&(f=!f)}return f}function n(a,b,c){for(var d=c*c,e=0;e<a.length;e++)for(var f=a[e],g=0;g<f.length;g++)if(f[g].distSqr(b)<=d)return!0;return!1}var o=a("rbush"),p=a("point-geometry"),q=a("vector-tile"),r=a("../util/util");b.exports=d,d.prototype.insert=function(a,b,c){a.layers=b,a.feature=c,this.toBeInserted.push(a)},d.prototype._load=function(){this.rtree.load(this.toBeInserted),this.toBeInserted=[]},d.prototype.query=function(a,b){this.toBeInserted.length&&this._load();var c,d,f=a.params||{},g=a.x,h=a.y,i=[];"undefined"!=typeof g&&"undefined"!=typeof h?(c=(f.radius||0)*(a.tileExtent||4096)/a.scale,d=[g-c,h-c,g+c,h+c]):d=[a.minX,a.minY,a.maxX,a.maxY];for(var k=this.rtree.search(d),l=0;l<k.length;l++){var m=k[l].feature,n=k[l].layers,o=q.VectorTileFeature.types[m.type];if((!f.$type||o===f.$type)&&(!c||j(m.loadGeometry(),o,new p(g,h),c))&&e(m.loadGeometry(),o,d)){var s=m.toGeoJSON(this.x,this.y,this.z);f.includeGeometry||(s.geometry=null);for(var t=0;t<n.length;t++){var u=n[t];f.layerIds&&f.layerIds.indexOf(u)<0||i.push(r.extend({layer:u},s))}}}b(null,i)}},{"../util/util":106,"point-geometry":137,rbush:139,"vector-tile":144}],16:[function(a,b,c){function d(a){this.buffers=a,this.elementGroups=new e(a.fillVertex,a.fillElement,a.outlineElement)}var e=a("./element_groups");b.exports=d,d.prototype.addFeatures=function(){for(var a=this.features,b=0;b<a.length;b++){var c=a[b],d=c.loadGeometry();d&&this.addFeature(d)}},d.prototype.addFeature=function(a){for(var b=0;b<a.length;b++)this.addFill(a[b])},d.prototype.addFill=function(a){if(!(a.length<3)){var b=a.length;this.elementGroups.makeRoomFor(b+1);for(var c,d,e,f=this.elementGroups.current,g=this.buffers.fillVertex,h=this.buffers.fillElement,i=this.buffers.outlineElement,j=g.index-f.vertexStartIndex,k=0;k<a.length;k++)d=g.index-f.vertexStartIndex,e=a[k],g.add(e.x,e.y),f.vertexLength++,k>=2&&(e.x!==a[0].x||e.y!==a[0].y)&&(h.add(j,c,d),f.elementLength++),k>=1&&(i.add(c,d),f.secondElementLength++),c=d}}},{"./element_groups":14}],17:[function(a,b,c){function d(a,b){this.buffers=a,this.elementGroups=new e(a.lineVertex,a.lineElement),this.layoutProperties=b}var e=a("./element_groups");b.exports=d,d.prototype.addFeatures=function(){for(var a=this.features,b=0;b<a.length;b++){var c=a[b],d=c.loadGeometry();d&&this.addFeature(d)}},d.prototype.addFeature=function(a){for(var b=this.layoutProperties,c=0;c<a.length;c++)this.addLine(a[c],b["line-join"],b["line-cap"],b["line-miter-limit"],b["line-round-limit"])},d.prototype.addLine=function(a,b,c,d,e){for(var f=a.length;f>2&&a[f-1].equals(a[f-2]);)f--;if(!(a.length<2)){"bevel"===b&&(d=1.05);var g=a[0],h=a[f-1],i=g.equals(h);if(this.elementGroups.makeRoomFor(10*f),2!==f||!i){var j,k,l,m,n,o,p,q=c,r=i?"butt":c,s=1,t=0,u=!0;this.e1=this.e2=this.e3=-1,i&&(j=a[f-2],n=g.sub(j)._unit()._perp());for(var v=0;f>v;v++)if(l=i&&v===f-1?a[1]:a[v+1],!l||!a[v].equals(l)){n&&(m=n),j&&(k=j),j=a[v],k&&(t+=j.dist(k)),n=l?l.sub(j)._unit()._perp():m,m=m||n;var w=m.add(n)._unit(),x=w.x*n.x+w.y*n.y,y=1/x,z=k&&l,A=z?b:l?q:r;if(z&&"round"===A&&(e>y?A="miter":2>=y&&(A="fakeround")),"miter"===A&&y>d&&(A="bevel"),"bevel"===A&&(y>2&&(A="flipbevel"),d>y&&(A="miter")),"miter"===A)w._mult(y),this.addCurrentVertex(j,s,t,w,0,0,!1);else if("flipbevel"===A){if(y>100)w=n.clone();else{var B=m.x*n.y-m.y*n.x>0?-1:1,C=y*m.add(n).mag()/m.sub(n).mag();w._perp()._mult(C*B)}this.addCurrentVertex(j,s,t,w,0,0,!1),s=-s}else if("bevel"===A||"fakeround"===A){var D=s*(m.x*n.y-m.y*n.x)>0,E=-Math.sqrt(y*y-1);if(D?(p=0,o=E):(o=0,p=E),u||this.addCurrentVertex(j,s,t,m,o,p,!1),"fakeround"===A){for(var F,G=Math.floor(8*(.5-(x-.5))),H=0;G>H;H++)F=n.mult((H+1)/(G+1))._add(m)._unit(),this.addPieSliceVertex(j,s,t,F,D);this.addPieSliceVertex(j,s,t,w,D);for(var I=G-1;I>=0;I--)F=m.mult((I+1)/(G+1))._add(n)._unit(),this.addPieSliceVertex(j,s,t,F,D)}l&&this.addCurrentVertex(j,s,t,n,-o,-p,!1)}else"butt"===A?(u||this.addCurrentVertex(j,s,t,m,0,0,!1),l&&this.addCurrentVertex(j,s,t,n,0,0,!1)):"square"===A?(u||(this.addCurrentVertex(j,s,t,m,1,1,!1),this.e1=this.e2=-1,s=1),l&&this.addCurrentVertex(j,s,t,n,-1,-1,!1)):"round"===A&&(u||(this.addCurrentVertex(j,s,t,m,0,0,!1),this.addCurrentVertex(j,s,t,m,1,1,!0),this.e1=this.e2=-1,s=1),l&&(this.addCurrentVertex(j,s,t,n,-1,-1,!0),this.addCurrentVertex(j,s,t,n,0,0,!1)));u=!1}}}},d.prototype.addCurrentVertex=function(a,b,c,d,e,f,g){var h,i=g?1:0,j=this.buffers.lineVertex,k=this.buffers.lineElement,l=this.elementGroups.current,m=this.elementGroups.current.vertexStartIndex;h=d.mult(b),e&&h._sub(d.perp()._mult(e)),this.e3=j.add(a,h,i,0,c)-m,this.e1>=0&&this.e2>=0&&(k.add(this.e1,this.e2,this.e3),l.elementLength++),this.e1=this.e2,this.e2=this.e3,h=d.mult(-b),f&&h._sub(d.perp()._mult(f)),this.e3=j.add(a,h,i,1,c)-m,this.e1>=0&&this.e2>=0&&(k.add(this.e1,this.e2,this.e3),l.elementLength++),this.e1=this.e2,this.e2=this.e3,l.vertexLength+=2},d.prototype.addPieSliceVertex=function(a,b,c,d,e){var f=this.buffers.lineVertex,g=this.buffers.lineElement,h=this.elementGroups.current,i=this.elementGroups.current.vertexStartIndex,j=e;d=d.mult(b*(e?-1:1)),this.e3=f.add(a,d,0,j,c)-i,h.vertexLength+=1,this.e1>=0&&this.e2>=0&&(g.add(this.e1,this.e2,this.e3),h.elementLength++),e?this.e2=this.e3:this.e1=this.e3}},{"./element_groups":14}],18:[function(a,b,c){function d(a,b,c,d,e){this.buffers=a,this.layoutProperties=b,this.overscaling=c,this.zoom=d,this.collisionDebug=e;var f=512*c,g=4096;this.tilePixelRatio=g/f,this.compareText={},this.symbolInstances=[]}function e(a,b,c,d,e,f,g,h,i,j,k,l){this.x=a.x,this.y=a.y,this.hasText=!!c,this.hasIcon=!!d,this.hasText&&(this.glyphQuads=f?q(a,c,g,b,e,i):[],this.textCollisionFeature=new u(b,a,c,g,h,i)),this.hasIcon&&(this.iconQuads=f?r(a,d,j,b,e,l):[],this.iconCollisionFeature=new u(b,a,d,j,k,l))}var f=a("./element_groups"),g=a("../symbol/anchor"),h=a("../symbol/get_anchors"),i=a("../util/token"),j=a("../symbol/quads"),k=a("../symbol/shaping"),l=a("../symbol/resolve_text"),m=a("../symbol/resolve_icons"),n=a("../symbol/mergelines"),o=k.shapeText,p=k.shapeIcon,q=j.getGlyphQuads,r=j.getIconQuads,s=a("../symbol/clip_line"),t=a("point-geometry"),u=a("../symbol/collision_feature");b.exports=d,d.prototype.needsPlacement=!0,d.prototype.addFeatures=function(a){var b=this.layoutProperties,c=this.features,d=this.textFeatures,e=.5,f=.5;switch(b["text-anchor"]){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(b["text-anchor"]){case"bottom":case"bottom-right":case"bottom-left":f=1;break;case"top":case"top-right":case"top-left":f=0}for(var g="right"===b["text-justify"]?1:"left"===b["text-justify"]?0:.5,h=24,j=b["text-line-height"]*h,k="line"!==b["symbol-placement"]?b["text-max-width"]*h:0,l=b["text-letter-spacing"]*h,m=[b["text-offset"][0]*h,b["text-offset"][1]*h],q=b["text-font"].join(","),r=[],s=0;s<c.length;s++)r.push(c[s].loadGeometry());if("line"===b["symbol-placement"]){var t=n(c,d,r);r=t.geometries,c=t.features,d=t.textFeatures}for(var u,v,w=0;w<c.length;w++)if(r[w]){if(u=d[w]?o(d[w],this.stacks[q],k,j,e,f,g,l,m):null,b["icon-image"]){var x=i(c[w].properties,b["icon-image"]),y=this.icons[x];v=p(y,b),y&&(void 0===this.sdfIcons?this.sdfIcons=y.sdf:this.sdfIcons!==y.sdf&&console.warn("Style sheet warning: Cannot mix SDF and non-SDF icons in one bucket"))}else v=null;(u||v)&&this.addFeature(r[w],u,v)}this.placeFeatures(a,this.buffers,this.collisionDebug)},d.prototype.addFeature=function(a,b,c){var d=this.layoutProperties,f=24,i=d["text-size"]/f,j=this.tilePixelRatio*i,k=this.tilePixelRatio*d["text-max-size"]/f,l=this.tilePixelRatio*d["icon-size"],m=this.tilePixelRatio*d["symbol-spacing"],n=d["symbol-avoid-edges"],o=d["text-padding"]*this.tilePixelRatio,p=d["icon-padding"]*this.tilePixelRatio,q=d["text-max-angle"]/180*Math.PI,r="map"===d["text-rotation-alignment"]&&"line"===d["symbol-placement"],t="map"===d["icon-rotation-alignment"]&&"line"===d["symbol-placement"],u=d["text-allow-overlap"]||d["icon-allow-overlap"]||d["text-ignore-placement"]||d["icon-ignore-placement"],v="line"===d["symbol-placement"],w=m/2;v&&(a=s(a,0,0,4096,4096));for(var x=0;x<a.length;x++)for(var y=a[x],z=v?h(y,m,q,b,c,f,k,this.overscaling):[new g(y[0].x,y[0].y,0)],A=0,B=z.length;B>A;A++){var C=z[A];if(!(b&&v&&this.anchorIsTooClose(b.text,w,C))){var D=!(C.x<0||C.x>4096||C.y<0||C.y>4096);if(!n||D){var E=D||u;this.symbolInstances.push(new e(C,y,b,c,d,E,j,o,r,l,p,t))}}}},d.prototype.anchorIsTooClose=function(a,b,c){var d=this.compareText;if(a in d){for(var e=d[a],f=e.length-1;f>=0;f--)if(c.dist(e[f])<b)return!0}else d[a]=[];return d[a].push(c),!1},d.prototype.placeFeatures=function(a,b,c){this.buffers=b;var d=this.elementGroups={text:new f(b.glyphVertex,b.glyphElement),icon:new f(b.iconVertex,b.iconElement),sdfIcons:this.sdfIcons},e=this.layoutProperties,g=a.maxScale;d.text["text-size"]=e["text-size"],d.icon["icon-size"]=e["icon-size"];var h="map"===e["text-rotation-alignment"]&&"line"===e["symbol-placement"],i="map"===e["icon-rotation-alignment"]&&"line"===e["symbol-placement"],j=e["text-allow-overlap"]||e["icon-allow-overlap"]||e["text-ignore-placement"]||e["icon-ignore-placement"];if(j){var k=a.angle,l=Math.sin(k),m=Math.cos(k);this.symbolInstances.sort(function(a,b){var c=l*a.x+m*a.y,d=l*b.x+m*b.y;return d-c})}for(var n=0;n<this.symbolInstances.length;n++){var o=this.symbolInstances[n],p=o.hasText,q=o.hasIcon,r=e["text-optional"]||!p,s=e["icon-optional"]||!q,t=p&&!e["text-allow-overlap"]?a.placeCollisionFeature(o.textCollisionFeature):a.minScale,u=q&&!e["icon-allow-overlap"]?a.placeCollisionFeature(o.iconCollisionFeature):a.minScale;r||s?!s&&t?t=Math.max(u,t):!r&&u&&(u=Math.max(u,t)):u=t=Math.max(u,t),p&&(e["text-ignore-placement"]||a.insertCollisionFeature(o.textCollisionFeature,t),g>=t&&this.addSymbols(b.glyphVertex,b.glyphElement,d.text,o.glyphQuads,t,e["text-keep-upright"],h,a.angle)),q&&(e["icon-ignore-placement"]||a.insertCollisionFeature(o.iconCollisionFeature,u),g>=u&&this.addSymbols(b.iconVertex,b.iconElement,d.icon,o.iconQuads,u,e["icon-keep-upright"],i,a.angle))}c&&this.addToDebugBuffers(a)},d.prototype.addSymbols=function(a,b,c,d,e,f,g,h){c.makeRoomFor(4*d.length);for(var i=c.current,j=this.zoom,k=Math.max(Math.log(e)/Math.LN2+j,0),l=0;l<d.length;l++){var m=d[l],n=m.angle,o=(n+h+Math.PI)%(2*Math.PI);if(!(f&&g&&(o<=Math.PI/2||o>3*Math.PI/2))){var p=m.tl,q=m.tr,r=m.bl,s=m.br,t=m.tex,u=m.anchorPoint,v=Math.max(j+Math.log(m.minScale)/Math.LN2,k),w=Math.min(j+Math.log(m.maxScale)/Math.LN2,25);if(!(v>=w)){v===k&&(v=0);var x=a.index-i.vertexStartIndex;a.add(u.x,u.y,p.x,p.y,t.x,t.y,v,w,k),a.add(u.x,u.y,q.x,q.y,t.x+t.w,t.y,v,w,k),a.add(u.x,u.y,r.x,r.y,t.x,t.y+t.h,v,w,k),a.add(u.x,u.y,s.x,s.y,t.x+t.w,t.y+t.h,v,w,k),i.vertexLength+=4,b.add(x,x+1,x+2),b.add(x+1,x+2,x+3),i.elementLength+=2}}}},d.prototype.getDependencies=function(a,b,c){function d(a){return a||e?c(a):void(e=!0)}var e=!1;this.getTextDependencies(a,b,d),this.getIconDependencies(a,b,d)},d.prototype.getIconDependencies=function(a,b,c){function d(a,b){return a?c(a):(this.icons=b,void c())}if(this.layoutProperties["icon-image"]){var e=this.features,f=m(e,this.layoutProperties);f.length?b.send("get icons",{icons:f},d.bind(this)):c()}else c()},d.prototype.getTextDependencies=function(a,b,c){var d=this.features,e=this.layoutProperties["text-font"],f=this.stacks=a.stacks;void 0===f[e]&&(f[e]={});var g=f[e],h=l(d,this.layoutProperties,g);this.textFeatures=h.textFeatures,b.send("get glyphs",{uid:a.uid,fontstack:e,codepoints:h.codepoints},function(a,b){if(a)return c(a);for(var d in b)g[d]=b[d];c()})},d.prototype.addToDebugBuffers=function(a){this.elementGroups.collisionBox=new f(this.buffers.collisionBoxVertex),this.elementGroups.collisionBox.makeRoomFor(0);for(var b=this.buffers.collisionBoxVertex,c=-a.angle,d=a.yStretch,e=0;e<this.symbolInstances.length;e++)for(var g=0;2>g;g++){var h=this.symbolInstances[e][0===g?"textCollisionFeature":"iconCollisionFeature"];if(h)for(var i=h.boxes,j=0;j<i.length;j++){var k=i[j],l=k.anchorPoint,m=new t(k.x1,k.y1*d)._rotate(c),n=new t(k.x2,k.y1*d)._rotate(c),o=new t(k.x1,k.y2*d)._rotate(c),p=new t(k.x2,k.y2*d)._rotate(c),q=Math.max(0,Math.min(25,this.zoom+Math.log(k.maxScale)/Math.LN2)),r=Math.max(0,Math.min(25,this.zoom+Math.log(k.placementScale)/Math.LN2));b.add(l,m,q,r),b.add(l,n,q,r),b.add(l,n,q,r),b.add(l,p,q,r),b.add(l,p,q,r),b.add(l,o,q,r),b.add(l,o,q,r),b.add(l,m,q,r),this.elementGroups.collisionBox.current.vertexLength+=8}}}},{"../symbol/anchor":62,"../symbol/clip_line":65,"../symbol/collision_feature":67,"../symbol/get_anchors":69,"../symbol/mergelines":72,"../symbol/quads":73,"../symbol/resolve_icons":74,"../symbol/resolve_text":75,"../symbol/shaping":76,"../util/token":105,"./element_groups":14,"point-geometry":137}],19:[function(a,b,c){function d(a,b,c){this.column=a,this.row=b,this.zoom=c}b.exports=d,d.prototype={clone:function(){return new d(this.column,this.row,this.zoom)},zoomTo:function(a){return this.clone()._zoomTo(a)},sub:function(a){
return this.clone()._sub(a)},_zoomTo:function(a){var b=Math.pow(2,a-this.zoom);return this.column*=b,this.row*=b,this.zoom=a,this},_sub:function(a){return a=a.zoomTo(this.zoom),this.column-=a.column,this.row-=a.row,this}}},{}],20:[function(a,b,c){function d(a,b){if(isNaN(a)||isNaN(b))throw new Error("Invalid LngLat object: ("+a+", "+b+")");if(this.lng=+a,this.lat=+b,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}b.exports=d;var e=a("../util/util").wrap;d.prototype.wrap=function(){return new d(e(this.lng,-180,180),this.lat)},d.convert=function(a){return a instanceof d?a:Array.isArray(a)?new d(a[0],a[1]):a}},{"../util/util":106}],21:[function(a,b,c){function d(a,b){if(a)for(var c=b?[a,b]:a,d=0,e=c.length;e>d;d++)this.extend(c[d])}b.exports=d;var e=a("./lng_lat");d.prototype={extend:function(a){var b,c,f=this._sw,g=this._ne;if(a instanceof e)b=a,c=a;else{if(!(a instanceof d))return a?this.extend(e.convert(a)||d.convert(a)):this;if(b=a._sw,c=a._ne,!b||!c)return this}return f||g?(f.lng=Math.min(b.lng,f.lng),f.lat=Math.min(b.lat,f.lat),g.lng=Math.max(c.lng,g.lng),g.lat=Math.max(c.lat,g.lat)):(this._sw=new e(b.lng,b.lat),this._ne=new e(c.lng,c.lat)),this},getCenter:function(){return new e((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},getSouthWest:function(){return this._sw},getNorthEast:function(){return this._ne},getNorthWest:function(){return new e(this.getWest(),this.getNorth())},getSouthEast:function(){return new e(this.getEast(),this.getSouth())},getWest:function(){return this._sw.lng},getSouth:function(){return this._sw.lat},getEast:function(){return this._ne.lng},getNorth:function(){return this._ne.lat}},d.convert=function(a){return!a||a instanceof d?a:new d(a)}},{"./lng_lat":20}],22:[function(a,b,c){function d(a,b){this.tileSize=512,this._minZoom=a||0,this._maxZoom=b||22,this.latRange=[-85.05113,85.05113],this.width=0,this.height=0,this.zoom=0,this.center=new e(0,0),this.angle=0,this._altitude=1.5,this._pitch=0}var e=a("./lng_lat"),f=a("point-geometry"),g=a("./coordinate"),h=a("../util/util").wrap,i=a("../util/interpolate"),j=a("gl-matrix").vec4,k=a("gl-matrix").mat4;b.exports=d,d.prototype={get minZoom(){return this._minZoom},set minZoom(a){this._minZoom=a,this.zoom=Math.max(this.zoom,a)},get maxZoom(){return this._maxZoom},set maxZoom(a){this._maxZoom=a,this.zoom=Math.min(this.zoom,a)},get worldSize(){return this.tileSize*this.scale},get centerPoint(){return this.size._div(2)},get size(){return new f(this.width,this.height)},get bearing(){return-this.angle/Math.PI*180},set bearing(a){this.angle=-h(a,-180,180)*Math.PI/180},get pitch(){return this._pitch/Math.PI*180},set pitch(a){this._pitch=Math.min(60,a)/180*Math.PI},get altitude(){return this._altitude},set altitude(a){this._altitude=Math.max(.75,a)},get zoom(){return this._zoom},set zoom(a){a=Math.min(Math.max(a,this.minZoom),this.maxZoom),this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom,this._constrain()},get center(){return this._center},set center(a){this._center=a,this._constrain()},zoomScale:function(a){return Math.pow(2,a)},scaleZoom:function(a){return Math.log(a)/Math.LN2},project:function(a,b){return new f(this.lngX(a.lng,b),this.latY(a.lat,b))},unproject:function(a,b){return new e(this.xLng(a.x,b),this.yLat(a.y,b))},get x(){return this.lngX(this.center.lng)},get y(){return this.latY(this.center.lat)},get point(){return new f(this.x,this.y)},lngX:function(a,b){return(180+a)*(b||this.worldSize)/360},latY:function(a,b){var c=180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360));return(180-c)*(b||this.worldSize)/360},xLng:function(a,b){return 360*a/(b||this.worldSize)-180},yLat:function(a,b){var c=180-360*a/(b||this.worldSize);return 360/Math.PI*Math.atan(Math.exp(c*Math.PI/180))-90},panBy:function(a){var b=this.centerPoint._add(a);this.center=this.pointLocation(b)},setLocationAtPoint:function(a,b){var c=this.locationCoordinate(a),d=this.pointCoordinate(b),e=this.pointCoordinate(this.centerPoint),f=d._sub(c);this.center=this.coordinateLocation(e._sub(f))},setZoomAround:function(a,b){var c;b&&(c=this.locationPoint(b)),this.zoom=a,b&&this.setLocationAtPoint(b,c)},setBearingAround:function(a,b){var c;b&&(c=this.locationPoint(b)),this.bearing=a,b&&this.setLocationAtPoint(b,c)},locationPoint:function(a){return this.coordinatePoint(this.locationCoordinate(a))},pointLocation:function(a){return this.coordinateLocation(this.pointCoordinate(a))},locationCoordinate:function(a){var b=this.zoomScale(this.tileZoom)/this.worldSize,c=e.convert(a);return new g(this.lngX(c.lng)*b,this.latY(c.lat)*b,this.tileZoom)},coordinateLocation:function(a){var b=this.zoomScale(a.zoom);return new e(this.xLng(a.column,b),this.yLat(a.row,b))},pointCoordinate:function(a,b){void 0===b&&(b=0);var c=this.coordinatePointMatrix(this.tileZoom),d=k.invert(new Float64Array(16),c);if(!d)throw new Error("failed to invert matrix");var e=j.transformMat4([],[a.x,a.y,0,1],d),f=j.transformMat4([],[a.x,a.y,1,1],d),h=e[3],l=f[3],m=e[0]/h,n=f[0]/l,o=e[1]/h,p=f[1]/l,q=e[2]/h,r=f[2]/l,s=q===r?0:(b-q)/(r-q);return new g(i(m,n,s),i(o,p,s),this.tileZoom)},coordinatePoint:function(a){var b=this.coordinatePointMatrix(a.zoom),c=j.transformMat4([],[a.column,a.row,0,1],b);return new f(c[0]/c[3],c[1]/c[3])},coordinatePointMatrix:function(a){var b=this.getProjMatrix(),c=this.worldSize/this.zoomScale(a);return k.scale(b,b,[c,c,1]),k.multiply(b,this.getPixelMatrix(),b),b},getPixelMatrix:function(){var a=k.create();return k.scale(a,a,[this.width/2,-this.height/2,1]),k.translate(a,a,[1,-1,0]),a},_constrain:function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var a,b,c,d,e,g,h,i,j=this.size;this.latRange&&(a=this.latY(this.latRange[1]),b=this.latY(this.latRange[0]),e=b-a<j.y?j.y/(b-a):0),this.lngRange&&(c=this.lngX(this.lngRange[0]),d=this.lngX(this.lngRange[1]),g=d-c<j.x?j.x/(d-c):0);var k=Math.max(g||0,e||0);if(k)return this.center=this.unproject(new f(g?(d+c)/2:this.x,e?(b+a)/2:this.y)),this.zoom+=this.scaleZoom(k),void(this._constraining=!1);if(this.latRange){var l=this.y,m=j.y/2;a>l-m&&(i=a+m),l+m>b&&(i=b-m)}if(this.lngRange){var n=this.x,o=j.x/2;c>n-o&&(h=c+o),n+o>d&&(h=d-o)}(void 0!==h||void 0!==i)&&(this.center=this.unproject(new f(void 0!==h?h:this.x,void 0!==i?i:this.y))),this._constraining=!1}},getProjMatrix:function(){var a=new Float64Array(16),b=Math.atan(.5/this.altitude),c=Math.sin(b)*this.altitude/Math.sin(Math.PI/2-this._pitch-b),d=Math.cos(Math.PI/2-this._pitch)*c+this.altitude;return k.perspective(a,2*Math.atan(this.height/2/this.altitude),this.width/this.height,.1,d),k.translate(a,a,[0,0,-this.altitude]),k.scale(a,a,[1,-1,1/this.height]),k.rotateX(a,a,this._pitch),k.rotateZ(a,a,this.angle),k.translate(a,a,[-this.x,-this.y,0]),a}}},{"../util/interpolate":102,"../util/util":106,"./coordinate":19,"./lng_lat":20,"gl-matrix":116,"point-geometry":137}],23:[function(a,b,c){var d={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]};b.exports=function(a,b,c,e){e=e||1;var f,g,h,i,j,k,l,m,n=[];for(f=0,g=a.length;g>f;f++)if(j=d[a[f]]){for(m=null,h=0,i=j[1].length;i>h;h+=2)-1===j[1][h]&&-1===j[1][h+1]?m=null:(k=b+j[1][h]*e,l=c-j[1][h+1]*e,m&&n.push(m.x,m.y,k,l),m={x:k,y:l});b+=j[0]*e}return n}},{}],24:[function(a,b,c){var d=b.exports={};d.Map=a("./ui/map"),d.Control=a("./ui/control/control"),d.Navigation=a("./ui/control/navigation"),d.Attribution=a("./ui/control/attribution"),d.Popup=a("./ui/popup"),d.GeoJSONSource=a("./source/geojson_source"),d.VideoSource=a("./source/video_source"),d.ImageSource=a("./source/image_source"),d.Style=a("./style/style"),d.LngLat=a("./geo/lng_lat"),d.LngLatBounds=a("./geo/lng_lat_bounds"),d.Point=a("point-geometry"),d.Evented=a("./util/evented"),d.util=a("./util/util"),d.supported=a("./util/browser").supported;var e=a("./util/ajax");d.util.getJSON=e.getJSON,d.util.getArrayBuffer=e.getArrayBuffer;var f=a("./util/config");d.config=f,Object.defineProperty(d,"accessToken",{get:function(){return f.ACCESS_TOKEN},set:function(a){f.ACCESS_TOKEN=a}})},{"./geo/lng_lat":20,"./geo/lng_lat_bounds":21,"./source/geojson_source":39,"./source/image_source":41,"./source/video_source":48,"./style/style":56,"./ui/control/attribution":79,"./ui/control/control":80,"./ui/control/navigation":81,"./ui/map":91,"./ui/popup":92,"./util/ajax":94,"./util/browser":95,"./util/config":99,"./util/evented":100,"./util/util":106,"point-geometry":137}],25:[function(a,b,c){function d(a,b,c){var d,f=a.gl,g=b.paint["background-color"],h=b.paint["background-pattern"],i=b.paint["background-opacity"],j=h?a.spriteAtlas.getPosition(h.from,!0):null,k=h?a.spriteAtlas.getPosition(h.to,!0):null;if(j&&k){d=a.patternShader,f.switchShader(d,c),f.uniform1i(d.u_image,0),f.uniform2fv(d.u_pattern_tl_a,j.tl),f.uniform2fv(d.u_pattern_br_a,j.br),f.uniform2fv(d.u_pattern_tl_b,k.tl),f.uniform2fv(d.u_pattern_br_b,k.br),f.uniform1f(d.u_opacity,i);var l=a.transform,m=j.size,n=k.size,o=l.locationCoordinate(l.center),p=1/Math.pow(2,l.zoomFraction);f.uniform1f(d.u_mix,h.t);var q=e.create();e.scale(q,q,[1/(m[0]*h.fromScale),1/(m[1]*h.fromScale)]),e.translate(q,q,[o.column*l.tileSize%(m[0]*h.fromScale),o.row*l.tileSize%(m[1]*h.fromScale)]),e.rotate(q,q,-l.angle),e.scale(q,q,[p*l.width/2,-p*l.height/2]);var r=e.create();e.scale(r,r,[1/(n[0]*h.toScale),1/(n[1]*h.toScale)]),e.translate(r,r,[o.column*l.tileSize%(n[0]*h.toScale),o.row*l.tileSize%(n[1]*h.toScale)]),e.rotate(r,r,-l.angle),e.scale(r,r,[p*l.width/2,-p*l.height/2]),f.uniformMatrix3fv(d.u_patternmatrix_a,!1,q),f.uniformMatrix3fv(d.u_patternmatrix_b,!1,r),a.spriteAtlas.bind(f,!0)}else d=a.fillShader,f.switchShader(d,c),f.uniform4fv(d.u_color,g);f.disable(f.STENCIL_TEST),f.bindBuffer(f.ARRAY_BUFFER,a.backgroundBuffer),f.vertexAttribPointer(d.a_pos,a.backgroundBuffer.itemSize,f.SHORT,!1,0,0),f.drawArrays(f.TRIANGLE_STRIP,0,a.backgroundBuffer.itemCount),f.enable(f.STENCIL_TEST),f.stencilMask(0),f.stencilFunc(f.EQUAL,128,128)}var e=a("gl-matrix").mat3;b.exports=d},{"gl-matrix":116}],26:[function(a,b,c){function d(a,b,c,d){if(d.buffers){c=a.translateMatrix(c,d,b.paint["circle-translate"],b.paint["circle-translate-anchor"]);var f=d.elementGroups[b.ref||b.id];if(f){var g=a.gl;g.disable(g.STENCIL_TEST),g.switchShader(a.circleShader,c,d.exMatrix);var h=d.buffers.circleVertex,i=a.circleShader,j=d.buffers.circleElement,k=1/e.devicePixelRatio/b.paint["circle-radius"];g.uniform4fv(i.u_color,b.paint["circle-color"]),g.uniform1f(i.u_blur,Math.max(b.paint["circle-blur"],k)),g.uniform1f(i.u_size,b.paint["circle-radius"]);for(var l=0;l<f.groups.length;l++){var m=f.groups[l],n=m.vertexStartIndex*h.itemSize;h.bind(g,i,n),j.bind(g,i,n);var o=3*m.elementLength,p=m.elementStartIndex*j.itemSize;g.drawElements(g.TRIANGLES,o,g.UNSIGNED_SHORT,p)}g.enable(g.STENCIL_TEST)}}}var e=a("../util/browser.js");b.exports=d},{"../util/browser.js":95}],27:[function(a,b,c){function d(a,b,c,d){var e=d.elementGroups[b.ref||b.id].collisionBox;if(e){var f=a.gl,g=d.buffers.collisionBoxVertex,h=a.collisionBoxShader;f.enable(f.STENCIL_TEST),f.switchShader(h,c),g.bind(f,h),f.lineWidth(1);var i=12;f.vertexAttribPointer(h.a_pos,2,f.SHORT,!1,i,0),f.vertexAttribPointer(h.a_extrude,2,f.SHORT,!1,i,4),f.vertexAttribPointer(h.a_data,2,f.UNSIGNED_BYTE,!1,i,8),f.uniform1f(h.u_scale,Math.pow(2,a.transform.zoom-d.coord.z)),f.uniform1f(h.u_zoom,10*a.transform.zoom),f.uniform1f(h.u_maxzoom,10*(d.coord.z+1));var j=e.groups[0].vertexStartIndex,k=e.groups[0].vertexLength;f.drawArrays(f.LINES,j,k),f.disable(f.STENCIL_TEST)}}b.exports=d},{}],28:[function(a,b,c){function d(a,b){var c=a.gl;c.blendFunc(c.ONE,c.ONE_MINUS_SRC_ALPHA),c.switchShader(a.debugShader,b.posMatrix),c.bindBuffer(c.ARRAY_BUFFER,a.debugBuffer),c.vertexAttribPointer(a.debugShader.a_pos,a.debugBuffer.itemSize,c.SHORT,!1,0,0),c.uniform4f(a.debugShader.u_color,1,0,0,1),c.lineWidth(4),c.drawArrays(c.LINE_STRIP,0,a.debugBuffer.itemCount);var d=e(b.coord.toString(),50,200,5);c.bindBuffer(c.ARRAY_BUFFER,a.debugTextBuffer),c.bufferData(c.ARRAY_BUFFER,new Int16Array(d),c.STREAM_DRAW),c.vertexAttribPointer(a.debugShader.a_pos,a.debugTextBuffer.itemSize,c.SHORT,!1,0,0),c.lineWidth(8*f.devicePixelRatio),c.uniform4f(a.debugShader.u_color,1,1,1,1),c.drawArrays(c.LINES,0,d.length/a.debugTextBuffer.itemSize),c.lineWidth(2*f.devicePixelRatio),c.uniform4f(a.debugShader.u_color,0,0,0,1),c.drawArrays(c.LINES,0,d.length/a.debugTextBuffer.itemSize),c.blendFunc(c.ONE_MINUS_DST_ALPHA,c.ONE)}var e=a("../lib/debugtext"),f=a("../util/browser");b.exports=d},{"../lib/debugtext":23,"../util/browser":95}],29:[function(a,b,c){function d(a,b,c,d){if(d.buffers){var g=d.elementGroups[b.ref||b.id];if(g){var h,i,j,k,l=a.gl,m=a.translateMatrix(c,d,b.paint["fill-translate"],b.paint["fill-translate-anchor"]),n=b.paint["fill-color"];l.stencilMask(63),l.clear(l.STENCIL_BUFFER_BIT),l.stencilFunc(l.NOTEQUAL,128,128),l.stencilOpSeparate(l.FRONT,l.INCR_WRAP,l.KEEP,l.KEEP),l.stencilOpSeparate(l.BACK,l.DECR_WRAP,l.KEEP,l.KEEP),l.colorMask(!1,!1,!1,!1),l.switchShader(a.fillShader,m),h=d.buffers.fillVertex,h.bind(l),i=d.buffers.fillElement,i.bind(l);for(var o,p,q=0;q<g.groups.length;q++)j=g.groups[q],o=j.vertexStartIndex*h.itemSize,l.vertexAttribPointer(a.fillShader.a_pos,2,l.SHORT,!1,4,o+0),k=3*j.elementLength,p=j.elementStartIndex*i.itemSize,l.drawElements(l.TRIANGLES,k,l.UNSIGNED_SHORT,p);l.colorMask(!0,!0,!0,!0),l.stencilOp(l.KEEP,l.KEEP,l.KEEP),l.stencilMask(0);var r=b.paint["fill-outline-color"];if(b.paint["fill-antialias"]===!0&&(!b.paint["fill-pattern"]||r)){l.switchShader(a.outlineShader,m),l.lineWidth(2*e.devicePixelRatio),r?l.stencilFunc(l.EQUAL,128,128):l.stencilFunc(l.EQUAL,128,191),l.uniform2f(a.outlineShader.u_world,l.drawingBufferWidth,l.drawingBufferHeight),l.uniform4fv(a.outlineShader.u_color,r?r:n),h=d.buffers.fillVertex,i=d.buffers.outlineElement,i.bind(l);for(var s=0;s<g.groups.length;s++)j=g.groups[s],o=j.vertexStartIndex*h.itemSize,l.vertexAttribPointer(a.outlineShader.a_pos,2,l.SHORT,!1,4,o+0),k=2*j.secondElementLength,p=j.secondElementStartIndex*i.itemSize,l.drawElements(l.LINES,k,l.UNSIGNED_SHORT,p)}var t,u=b.paint["fill-pattern"],v=b.paint["fill-opacity"]||1;if(u){var w=a.spriteAtlas.getPosition(u.from,!0),x=a.spriteAtlas.getPosition(u.to,!0);if(!w||!x)return;t=a.patternShader,l.switchShader(t,c),l.uniform1i(t.u_image,0),l.uniform2fv(t.u_pattern_tl_a,w.tl),l.uniform2fv(t.u_pattern_br_a,w.br),l.uniform2fv(t.u_pattern_tl_b,x.tl),l.uniform2fv(t.u_pattern_br_b,x.br),l.uniform1f(t.u_opacity,v),l.uniform1f(t.u_mix,u.t);var y=d.tileExtent/d.tileSize/Math.pow(2,a.transform.tileZoom-d.coord.z),z=f.create();f.scale(z,z,[1/(w.size[0]*y*u.fromScale),1/(w.size[1]*y*u.fromScale)]);var A=f.create();f.scale(A,A,[1/(x.size[0]*y*u.toScale),1/(x.size[1]*y*u.toScale)]),l.uniformMatrix3fv(t.u_patternmatrix_a,!1,z),l.uniformMatrix3fv(t.u_patternmatrix_b,!1,A),a.spriteAtlas.bind(l,!0)}else t=a.fillShader,l.switchShader(t,c),l.uniform4fv(t.u_color,n);l.stencilFunc(l.NOTEQUAL,0,63),l.bindBuffer(l.ARRAY_BUFFER,a.tileExtentBuffer),l.vertexAttribPointer(t.a_pos,a.tileExtentBuffer.itemSize,l.SHORT,!1,0,0),l.drawArrays(l.TRIANGLE_STRIP,0,a.tileExtentBuffer.itemCount),l.stencilMask(0),l.stencilFunc(l.EQUAL,128,128)}}}var e=a("../util/browser"),f=a("gl-matrix").mat3;b.exports=d},{"../util/browser":95,"gl-matrix":116}],30:[function(a,b,c){var d=a("../util/browser"),e=a("gl-matrix").mat2;b.exports=function(a,b,c,f){if(f.buffers){var g=f.elementGroups[b.ref||b.id];if(g){var h=a.gl;if(!(b.paint["line-width"]<=0)){var i=1/d.devicePixelRatio,j=b.paint["line-blur"]+i,k=b.paint["line-width"]/2,l=-1,m=0,n=0;b.paint["line-gap-width"]>0&&(l=b.paint["line-gap-width"]/2+.5*i,k=b.paint["line-width"],m=l-i/2);var o=m+k+i/2+n,p=b.paint["line-color"],q=a.transform.scale/(1<<f.coord.z)/(f.tileExtent/f.tileSize),r=a.translateMatrix(c,f,b.paint["line-translate"],b.paint["line-translate-anchor"]),s=a.transform,t=e.create();e.scale(t,t,[1,Math.cos(s._pitch)]),e.rotate(t,t,a.transform.angle);var u,v=Math.sqrt(s.height*s.height/4*(1+s.altitude*s.altitude)),w=s.height/2*Math.tan(s._pitch),x=(v+w)/v-1,y=f.tileSize/a.transform.tileSize,z=b.paint["line-dasharray"],A=b.paint["line-pattern"];if(z){u=a.linesdfpatternShader,h.switchShader(u,r,f.exMatrix),h.uniform2fv(u.u_linewidth,[o,l]),h.uniform1f(u.u_ratio,q),h.uniform1f(u.u_blur,j),h.uniform4fv(u.u_color,p);var B=a.lineAtlas.getDash(z.from,"round"===b.layout["line-cap"]),C=a.lineAtlas.getDash(z.to,"round"===b.layout["line-cap"]);a.lineAtlas.bind(h);var D=Math.pow(2,Math.floor(Math.log(a.transform.scale)/Math.LN2)-f.coord.z)/8*y,E=[D/B.width/z.fromScale,-B.height/2],F=a.lineAtlas.width/(z.fromScale*B.width*256*d.devicePixelRatio)/2,G=[D/C.width/z.toScale,-C.height/2],H=a.lineAtlas.width/(z.toScale*C.width*256*d.devicePixelRatio)/2;h.uniform2fv(u.u_patternscale_a,E),h.uniform1f(u.u_tex_y_a,B.y),h.uniform2fv(u.u_patternscale_b,G),h.uniform1f(u.u_tex_y_b,C.y),h.uniform1i(u.u_image,0),h.uniform1f(u.u_sdfgamma,Math.max(F,H)),h.uniform1f(u.u_mix,z.t),h.uniform1f(u.u_extra,x),h.uniformMatrix2fv(u.u_antialiasingmatrix,!1,t)}else if(A){var I=a.spriteAtlas.getPosition(A.from,!0),J=a.spriteAtlas.getPosition(A.to,!0);if(!I||!J)return;var K=f.tileExtent/f.tileSize/Math.pow(2,a.transform.tileZoom-f.coord.z)*y;a.spriteAtlas.bind(h,!0),u=a.linepatternShader,h.switchShader(u,r,f.exMatrix),h.uniform2fv(u.u_linewidth,[o,l]),h.uniform1f(u.u_ratio,q),h.uniform1f(u.u_blur,j),h.uniform2fv(u.u_pattern_size_a,[I.size[0]*K*A.fromScale,J.size[1]]),h.uniform2fv(u.u_pattern_size_b,[J.size[0]*K*A.toScale,J.size[1]]),h.uniform2fv(u.u_pattern_tl_a,I.tl),h.uniform2fv(u.u_pattern_br_a,I.br),h.uniform2fv(u.u_pattern_tl_b,J.tl),h.uniform2fv(u.u_pattern_br_b,J.br),h.uniform1f(u.u_fade,A.t),h.uniform1f(u.u_opacity,b.paint["line-opacity"]),h.uniform1f(u.u_extra,x),h.uniformMatrix2fv(u.u_antialiasingmatrix,!1,t)}else u=a.lineShader,h.switchShader(u,r,f.exMatrix),h.uniform2fv(u.u_linewidth,[o,l]),h.uniform1f(u.u_ratio,q),h.uniform1f(u.u_blur,j),h.uniform1f(u.u_extra,x),h.uniformMatrix2fv(u.u_antialiasingmatrix,!1,t),h.uniform4fv(u.u_color,p);var L=f.buffers.lineVertex;L.bind(h);var M=f.buffers.lineElement;M.bind(h);for(var N=0;N<g.groups.length;N++){var O=g.groups[N],P=O.vertexStartIndex*L.itemSize;h.vertexAttribPointer(u.a_pos,2,h.SHORT,!1,8,P+0),h.vertexAttribPointer(u.a_data,4,h.BYTE,!1,8,P+4);var Q=3*O.elementLength,R=O.elementStartIndex*M.itemSize;h.drawElements(h.TRIANGLES,Q,h.UNSIGNED_SHORT,R)}}}}}},{"../util/browser":95,"gl-matrix":116}],31:[function(a,b,c){function d(a,b,c,d){var i=a.gl;i.disable(i.STENCIL_TEST);var j=a.rasterShader;i.switchShader(j,c),i.uniform1f(j.u_brightness_low,b.paint["raster-brightness-min"]),i.uniform1f(j.u_brightness_high,b.paint["raster-brightness-max"]),i.uniform1f(j.u_saturation_factor,g(b.paint["raster-saturation"])),i.uniform1f(j.u_contrast_factor,f(b.paint["raster-contrast"])),i.uniform3fv(j.u_spin_weights,e(b.paint["raster-hue-rotate"]));var k,l,m=d.source&&d.source._pyramid.findLoadedParent(d.coord,0,{}),n=h(d,m,b,a.transform);i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,d.texture),m?(i.activeTexture(i.TEXTURE1),i.bindTexture(i.TEXTURE_2D,m.texture),k=Math.pow(2,m.coord.z-d.coord.z),l=[d.coord.x*k%1,d.coord.y*k%1]):n[1]=0,i.uniform2fv(j.u_tl_parent,l||[0,0]),i.uniform1f(j.u_scale_parent,k||1),i.uniform1f(j.u_buffer_scale,1),i.uniform1f(j.u_opacity0,n[0]),i.uniform1f(j.u_opacity1,n[1]),i.uniform1i(j.u_image0,0),i.uniform1i(j.u_image1,1),i.bindBuffer(i.ARRAY_BUFFER,d.boundsBuffer||a.tileExtentBuffer),i.vertexAttribPointer(j.a_pos,2,i.SHORT,!1,8,0),i.vertexAttribPointer(j.a_texture_pos,2,i.SHORT,!1,8,4),i.drawArrays(i.TRIANGLE_STRIP,0,4),i.enable(i.STENCIL_TEST)}function e(a){a*=Math.PI/180;var b=Math.sin(a),c=Math.cos(a);return[(2*c+1)/3,(-Math.sqrt(3)*b-c+1)/3,(Math.sqrt(3)*b-c+1)/3]}function f(a){return a>0?1/(1-a):1+a}function g(a){return a>0?1-1/(1.001-a):-a}function h(a,b,c,d){if(!a.source)return[1,0];var e=(new Date).getTime(),f=c.paint["raster-fade-duration"],g=(e-a.timeAdded)/f,h=b?(e-b.timeAdded)/f:-1,j=a.source._pyramid.coveringZoomLevel(d),k=!!b&&Math.abs(b.coord.z-j)>Math.abs(a.coord.z-j),l=[];!b||k?(l[0]=i.clamp(g,0,1),l[1]=1-l[0]):(l[0]=i.clamp(1-h,0,1),l[1]=1-l[0]);var m=c.paint["raster-opacity"];return l[0]*=m,l[1]*=m,l}var i=a("../util/util");b.exports=d},{"../util/util":106}],32:[function(a,b,c){function d(a,b,c,d){if(d.buffers){var f=d.elementGroups[b.ref||b.id];if(f){var g=!(b.layout["text-allow-overlap"]||b.layout["icon-allow-overlap"]||b.layout["text-ignore-placement"]||b.layout["icon-ignore-placement"]),i=a.gl;g&&i.disable(i.STENCIL_TEST),f.text.groups.length&&e(a,b,c,d,f.text,"text",!0),f.icon.groups.length&&e(a,b,c,d,f.icon,"icon",f.sdfIcons),h(a,b,c,d),g&&i.enable(i.STENCIL_TEST)}}}function e(a,b,c,d,e,h,j){var k=a.gl;c=a.translateMatrix(c,d,b.paint[h+"-translate"],b.paint[h+"-translate-anchor"]);var l,m,n,o=a.transform,p="map"===b.layout[h+"-rotation-alignment"],q=p;q?(l=g.create(),m=d.tileExtent/d.tileSize/Math.pow(2,a.transform.zoom-d.coord.z),n=1/Math.cos(o._pitch)):(l=g.clone(d.exMatrix),m=a.transform.altitude,n=1),g.scale(l,l,[m,m,1]);var r=b.paint[h+"-size"],s=r/i[h];g.scale(l,l,[s,s,1]);var t,u,v,w,x=Math.sqrt(o.height*o.height/4*(1+o.altitude*o.altitude)),y=o.height/2*Math.tan(o._pitch),z=(x+y)/x-1,A="text"===h;if(A||a.style.sprite.loaded()){k.activeTexture(k.TEXTURE0),t=j?a.sdfShader:a.iconShader,A?(a.glyphAtlas.updateTexture(k),u=d.buffers.glyphVertex,v=d.buffers.glyphElement,w=[a.glyphAtlas.width/4,a.glyphAtlas.height/4]):(a.spriteAtlas.bind(k,p||a.options.rotating||a.options.zooming||1!==s||j||a.transform.pitch),u=d.buffers.iconVertex,v=d.buffers.iconElement,w=[a.spriteAtlas.width/4,a.spriteAtlas.height/4]),k.switchShader(t,c,l),k.uniform1i(t.u_texture,0),k.uniform2fv(t.u_texsize,w),k.uniform1i(t.u_skewed,q),k.uniform1f(t.u_extra,z);var B=Math.log(r/e[h+"-size"])/Math.LN2||0;k.uniform1f(t.u_zoom,10*(a.transform.zoom-B));var C=a.frameHistory.getFadeProperties(300);k.uniform1f(t.u_fadedist,10*C.fadedist),k.uniform1f(t.u_minfadezoom,Math.floor(10*C.minfadezoom)),k.uniform1f(t.u_maxfadezoom,Math.floor(10*C.maxfadezoom)),k.uniform1f(t.u_fadezoom,10*(a.transform.zoom+C.bump));var D,E,F,G;if(v.bind(k),j){var H=8,I=1.19,J=6,K=.105*i[h]/r/f.devicePixelRatio;k.uniform1f(t.u_gamma,K*n),k.uniform4fv(t.u_color,b.paint[h+"-color"]),k.uniform1f(t.u_buffer,.75);for(var L=0;L<e.groups.length;L++)D=e.groups[L],E=D.vertexStartIndex*u.itemSize,u.bind(k,t,E),F=3*D.elementLength,G=D.elementStartIndex*v.itemSize,k.drawElements(k.TRIANGLES,F,k.UNSIGNED_SHORT,G);if(b.paint[h+"-halo-width"]){k.uniform1f(t.u_gamma,(b.paint[h+"-halo-blur"]*I/s/H+K)*n),k.uniform4fv(t.u_color,b.paint[h+"-halo-color"]),k.uniform1f(t.u_buffer,(J-b.paint[h+"-halo-width"]/s)/H);for(var M=0;M<e.groups.length;M++)D=e.groups[M],E=D.vertexStartIndex*u.itemSize,u.bind(k,t,E),F=3*D.elementLength,G=D.elementStartIndex*v.itemSize,k.drawElements(k.TRIANGLES,F,k.UNSIGNED_SHORT,G)}}else{k.uniform1f(t.u_opacity,b.paint["icon-opacity"]);for(var N=0;N<e.groups.length;N++)D=e.groups[N],E=D.vertexStartIndex*u.itemSize,u.bind(k,t,E),F=3*D.elementLength,G=D.elementStartIndex*v.itemSize,k.drawElements(k.TRIANGLES,F,k.UNSIGNED_SHORT,G)}}}var f=a("../util/browser"),g=a("gl-matrix").mat4,h=a("./draw_collision_debug");b.exports=d;var i={icon:1,text:24}},{"../util/browser":95,"./draw_collision_debug":27,"gl-matrix":116}],33:[function(a,b,c){function d(a,b,c,d){function g(b,c,d,f){h.switchShader(a.dotShader,d),h.uniform1f(a.dotShader.u_size,4*e.devicePixelRatio),h.uniform1f(a.dotShader.u_blur,.25),h.uniform4fv(a.dotShader.u_color,[.1,0,0,.1]),b.bind(h,a.dotShader,0);for(var g=0;g<c.length;g++){var i=c[g],j=i.vertexStartIndex,k=i.vertexLength;h.vertexAttribPointer(a.dotShader.a_pos,2,h.SHORT,!1,f,0),h.drawArrays(h.POINTS,j,k)}}var h=a.gl;if(d&&d.buffers){var i=d.elementGroups[b.ref||b.id];if(i){if(h.blendFunc(h.ONE,h.ONE_MINUS_SRC_ALPHA),"fill"===b.type)g(d.buffers.fillVertex,i.groups,c,4);else if("symbol"===b.type)g(d.buffers.iconVertex,i.icon.groups,c,16),g(d.buffers.glyphVertex,i.text.groups,c,16);else if("line"===b.type){var j=f.clone(c);f.scale(j,j,[.5,.5,1]),g(d.buffers.lineVertex,i.groups,j,8)}h.blendFunc(h.ONE_MINUS_DST_ALPHA,h.ONE)}}}var e=a("../util/browser"),f=a("gl-matrix").mat4;b.exports=d},{"../util/browser":95,"gl-matrix":116}],34:[function(a,b,c){function d(){this.frameHistory=[]}b.exports=d,d.prototype.getFadeProperties=function(a){void 0===a&&(a=300);for(var b=(new Date).getTime();this.frameHistory.length>3&&this.frameHistory[1].time+a<b;)this.frameHistory.shift();this.frameHistory[1].time+a<b&&(this.frameHistory[0].z=this.frameHistory[1].z);var c=this.frameHistory.length;3>c&&console.warn("there should never be less than three frames in the history");var d=this.frameHistory[0].z,e=this.frameHistory[c-1],f=e.z,g=Math.min(d,f),h=Math.max(d,f),i=e.z-this.frameHistory[1].z,j=e.time-this.frameHistory[1].time,k=i/(j/a);isNaN(k)&&console.warn("fadedist should never be NaN");var l=(b-e.time)/a*k;return{fadedist:k,minfadezoom:g,maxfadezoom:h,
bump:l}},d.prototype.record=function(a){var b=(new Date).getTime();this.frameHistory.length||this.frameHistory.push({time:0,z:a},{time:0,z:a}),(2===this.frameHistory.length||this.frameHistory[this.frameHistory.length-1].z!==a)&&this.frameHistory.push({time:b,z:a})}},{}],35:[function(a,b,c){var d=a("./shaders"),e=a("../util/util");c.extend=function(a){var b=a.lineWidth,c=a.getParameter(a.ALIASED_LINE_WIDTH_RANGE);return a.lineWidth=function(d){b.call(a,e.clamp(d,c[0],c[1]))},a.getShader=function(a,b){var c=b===this.FRAGMENT_SHADER?"fragment":"vertex";if(!d[a]||!d[a][c])throw new Error("Could not find shader "+a);var e=this.createShader(b),f=d[a][c];if("undefined"==typeof orientation&&(f=f.replace(/ highp /g," ")),this.shaderSource(e,f),this.compileShader(e),!this.getShaderParameter(e,this.COMPILE_STATUS))throw new Error(this.getShaderInfoLog(e));return e},a.initializeShader=function(a,b,c){var d={program:this.createProgram(),fragment:this.getShader(a,this.FRAGMENT_SHADER),vertex:this.getShader(a,this.VERTEX_SHADER),attributes:[]};if(this.attachShader(d.program,d.vertex),this.attachShader(d.program,d.fragment),this.linkProgram(d.program),this.getProgramParameter(d.program,this.LINK_STATUS)){for(var e=0;e<b.length;e++)d[b[e]]=this.getAttribLocation(d.program,b[e]),d.attributes.push(d[b[e]]);for(var f=0;f<c.length;f++)d[c[f]]=this.getUniformLocation(d.program,c[f])}else console.error(this.getProgramInfoLog(d.program));return d},a.switchShader=function(a,b,c){if(b||console.trace("posMatrix does not have required argument"),this.currentShader!==a){this.useProgram(a.program);for(var d=this.currentShader?this.currentShader.attributes:[],e=a.attributes,f=0;f<d.length;f++)e.indexOf(d[f])<0&&this.disableVertexAttribArray(d[f]);for(var g=0;g<e.length;g++)d.indexOf(e[g])<0&&this.enableVertexAttribArray(e[g]);this.currentShader=a}a.posMatrix!==b&&(this.uniformMatrix4fv(a.u_matrix,!1,b),a.posMatrix=b),c&&a.exMatrix!==c&&a.u_exmatrix&&(this.uniformMatrix4fv(a.u_exmatrix,!1,c),a.exMatrix=c)},a.vertexAttrib2fv=function(b,c){a.vertexAttrib2f(b,c[0],c[1])},a.vertexAttrib3fv=function(b,c){a.vertexAttrib3f(b,c[0],c[1],c[2])},a.vertexAttrib4fv=function(b,c){a.vertexAttrib4f(b,c[0],c[1],c[2],c[3])},a}},{"../util/util":106,"./shaders":38}],36:[function(a,b,c){function d(a,b){this.width=a,this.height=b,this.nextRow=0,this.bytes=4,this.data=new Uint8Array(this.width*this.height*this.bytes),this.positions={}}b.exports=d,d.prototype.setSprite=function(a){this.sprite=a},d.prototype.getDash=function(a,b){var c=a.join(",")+b;return this.positions[c]||(this.positions[c]=this.addDash(a,b)),this.positions[c]},d.prototype.addDash=function(a,b){var c=b?7:0,d=2*c+1,e=128;if(this.nextRow+d>this.height)return console.warn("LineAtlas out of space"),null;for(var f=0,g=0;g<a.length;g++)f+=a[g];for(var h=this.width/f,i=h/2,j=a.length%2===1,k=-c;c>=k;k++)for(var l=this.nextRow+c+k,m=this.width*l,n=j?-a[a.length-1]:0,o=a[0],p=1,q=0;q<this.width;q++){for(;q/h>o;)n=o,o+=a[p],j&&p===a.length-1&&(o+=a[0]),p++;var r,s=Math.abs(q-n*h),t=Math.abs(q-o*h),u=Math.min(s,t),v=p%2===1;if(b){var w=c?k/c*(i+1):0;if(v){var x=i-Math.abs(w);r=Math.sqrt(u*u+x*x)}else r=i-Math.sqrt(u*u+w*w)}else r=(v?1:-1)*u;this.data[3+4*(m+q)]=Math.max(0,Math.min(255,r+e))}var y={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:f};return this.nextRow+=d,this.dirty=!0,y},d.prototype.bind=function(a){this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.RGBA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,this.width,this.height,0,a.RGBA,a.UNSIGNED_BYTE,this.data))},d.prototype.debug=function(){var a=document.createElement("canvas");document.body.appendChild(a),a.style.position="absolute",a.style.top=0,a.style.left=0,a.style.background="#ff0",a.width=this.width,a.height=this.height;for(var b=a.getContext("2d"),c=b.getImageData(0,0,this.width,this.height),d=0;d<this.data.length;d++)if(this.sdf){var e=4*d;c.data[e]=c.data[e+1]=c.data[e+2]=0,c.data[e+3]=this.data[d]}else c.data[d]=this.data[d];b.putImageData(c,0,0)}},{}],37:[function(a,b,c){function d(a,b){this.gl=e.extend(a),this.transform=b,this.reusableTextures={},this.preFbos={},this.frameHistory=new h,this.setup()}var e=a("./gl_util"),f=a("../util/browser"),g=a("gl-matrix").mat4,h=a("./frame_history");b.exports=d,d.prototype.resize=function(a,b){var c=this.gl;this.width=a*f.devicePixelRatio,this.height=b*f.devicePixelRatio,c.viewport(0,0,this.width,this.height)},d.prototype.setup=function(){var a=this.gl;a.verbose=!0,a.enable(a.BLEND),a.blendFunc(a.ONE_MINUS_DST_ALPHA,a.ONE),a.enable(a.STENCIL_TEST),this.debugShader=a.initializeShader("debug",["a_pos"],["u_matrix","u_color"]),this.rasterShader=a.initializeShader("raster",["a_pos","a_texture_pos"],["u_matrix","u_brightness_low","u_brightness_high","u_saturation_factor","u_spin_weights","u_contrast_factor","u_opacity0","u_opacity1","u_image0","u_image1","u_tl_parent","u_scale_parent","u_buffer_scale"]),this.circleShader=a.initializeShader("circle",["a_pos"],["u_matrix","u_exmatrix","u_blur","u_size","u_color"]),this.lineShader=a.initializeShader("line",["a_pos","a_data"],["u_matrix","u_linewidth","u_color","u_ratio","u_blur","u_extra","u_antialiasingmatrix"]),this.linepatternShader=a.initializeShader("linepattern",["a_pos","a_data"],["u_matrix","u_linewidth","u_ratio","u_pattern_size_a","u_pattern_size_b","u_pattern_tl_a","u_pattern_br_a","u_pattern_tl_b","u_pattern_br_b","u_blur","u_fade","u_opacity","u_extra","u_antialiasingmatrix"]),this.linesdfpatternShader=a.initializeShader("linesdfpattern",["a_pos","a_data"],["u_matrix","u_linewidth","u_color","u_ratio","u_blur","u_patternscale_a","u_tex_y_a","u_patternscale_b","u_tex_y_b","u_image","u_sdfgamma","u_mix","u_extra","u_antialiasingmatrix"]),this.dotShader=a.initializeShader("dot",["a_pos"],["u_matrix","u_size","u_color","u_blur"]),this.sdfShader=a.initializeShader("sdf",["a_pos","a_offset","a_data1","a_data2"],["u_matrix","u_exmatrix","u_texture","u_texsize","u_color","u_gamma","u_buffer","u_zoom","u_fadedist","u_minfadezoom","u_maxfadezoom","u_fadezoom","u_skewed","u_extra"]),this.iconShader=a.initializeShader("icon",["a_pos","a_offset","a_data1","a_data2"],["u_matrix","u_exmatrix","u_texture","u_texsize","u_zoom","u_fadedist","u_minfadezoom","u_maxfadezoom","u_fadezoom","u_opacity","u_skewed","u_extra"]),this.outlineShader=a.initializeShader("outline",["a_pos"],["u_matrix","u_color","u_world"]),this.patternShader=a.initializeShader("pattern",["a_pos"],["u_matrix","u_pattern_tl_a","u_pattern_br_a","u_pattern_tl_b","u_pattern_br_b","u_mix","u_patternmatrix_a","u_patternmatrix_b","u_opacity","u_image"]),this.fillShader=a.initializeShader("fill",["a_pos"],["u_matrix","u_color"]),this.collisionBoxShader=a.initializeShader("collisionbox",["a_pos","a_extrude","a_data"],["u_matrix","u_scale","u_zoom","u_maxzoom"]),this.identityMatrix=g.create(),this.backgroundBuffer=a.createBuffer(),this.backgroundBuffer.itemSize=2,this.backgroundBuffer.itemCount=4,a.bindBuffer(a.ARRAY_BUFFER,this.backgroundBuffer),a.bufferData(a.ARRAY_BUFFER,new Int16Array([-1,-1,1,-1,-1,1,1,1]),a.STATIC_DRAW),this.setExtent(4096),this.debugTextBuffer=a.createBuffer(),this.debugTextBuffer.itemSize=2},d.prototype.setExtent=function(a){if(a&&a!==this.tileExtent){this.tileExtent=a;var b=this.gl;this.tileExtentBuffer=b.createBuffer(),this.tileExtentBuffer.itemSize=4,this.tileExtentBuffer.itemCount=4,b.bindBuffer(b.ARRAY_BUFFER,this.tileExtentBuffer),b.bufferData(b.ARRAY_BUFFER,new Int16Array([0,0,0,0,this.tileExtent,0,32767,0,0,this.tileExtent,0,32767,this.tileExtent,this.tileExtent,32767,32767]),b.STATIC_DRAW),this.debugBuffer=b.createBuffer(),this.debugBuffer.itemSize=2,this.debugBuffer.itemCount=5,b.bindBuffer(b.ARRAY_BUFFER,this.debugBuffer),b.bufferData(b.ARRAY_BUFFER,new Int16Array([0,0,this.tileExtent-1,0,this.tileExtent-1,this.tileExtent-1,0,this.tileExtent-1,0,0]),b.STATIC_DRAW)}},d.prototype.clearColor=function(){var a=this.gl;a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT)},d.prototype.clearStencil=function(){var a=this.gl;a.clearStencil(0),a.stencilMask(255),a.clear(a.STENCIL_BUFFER_BIT)},d.prototype.drawClippingMask=function(a){var b=this.gl;b.switchShader(this.fillShader,a.posMatrix),b.colorMask(!1,!1,!1,!1),b.clearStencil(0),b.stencilMask(191),b.clear(b.STENCIL_BUFFER_BIT),b.stencilFunc(b.EQUAL,192,64),b.stencilMask(192),b.stencilOp(b.REPLACE,b.KEEP,b.KEEP),b.bindBuffer(b.ARRAY_BUFFER,this.tileExtentBuffer),b.vertexAttribPointer(this.fillShader.a_pos,this.tileExtentBuffer.itemSize,b.SHORT,!1,8,0),b.drawArrays(b.TRIANGLE_STRIP,0,this.tileExtentBuffer.itemCount),b.stencilFunc(b.EQUAL,128,128),b.stencilOp(b.KEEP,b.KEEP,b.REPLACE),b.stencilMask(0),b.colorMask(!0,!0,!0,!0)},d.prototype.prepareBuffers=function(){},d.prototype.bindDefaultFramebuffer=function(){var a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,null)};var i={symbol:a("./draw_symbol"),circle:a("./draw_circle"),line:a("./draw_line"),fill:a("./draw_fill"),raster:a("./draw_raster"),background:a("./draw_background"),debug:a("./draw_debug"),vertices:a("./draw_vertices")};d.prototype.render=function(a,b){this.style=a,this.options=b,this.lineAtlas=a.lineAtlas,this.spriteAtlas=a.spriteAtlas,this.spriteAtlas.setSprite(a.sprite),this.glyphAtlas=a.glyphAtlas,this.glyphAtlas.bind(this.gl),this.frameHistory.record(this.transform.zoom),this.prepareBuffers(),this.clearColor();for(var c=a._groups.length-1;c>=0;c--){var d=a._groups[c],e=a.sources[d.source];e?(this.clearStencil(),e.render(d,this)):void 0===d.source&&this.drawLayers(d,this.identityMatrix)}},d.prototype.drawTile=function(a,b){this.setExtent(a.tileExtent),this.drawClippingMask(a),this.drawLayers(b,a.posMatrix,a),this.options.debug&&i.debug(this,a)},d.prototype.drawLayers=function(a,b,c){for(var d=a.length-1;d>=0;d--){var e=a[d];e.hidden||(i[e.type](this,e,b,c),this.options.vertices&&i.vertices(this,e,b,c))}},d.prototype.drawStencilBuffer=function(){var a=this.gl;a.switchShader(this.fillShader,this.identityMatrix),a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA),a.stencilMask(0),a.stencilFunc(a.EQUAL,128,128),a.bindBuffer(a.ARRAY_BUFFER,this.backgroundBuffer),a.vertexAttribPointer(this.fillShader.a_pos,this.backgroundBuffer.itemSize,a.SHORT,!1,0,0),a.uniform4fv(this.fillShader.u_color,[0,0,0,.5]),a.drawArrays(a.TRIANGLE_STRIP,0,this.tileExtentBuffer.itemCount),a.blendFunc(a.ONE_MINUS_DST_ALPHA,a.ONE)},d.prototype.translateMatrix=function(a,b,c,d){if(!c[0]&&!c[1])return a;if("viewport"===d){var e=Math.sin(-this.transform.angle),f=Math.cos(-this.transform.angle);c=[c[0]*f-c[1]*e,c[0]*e+c[1]*f]}var h=this.transform.scale/(1<<b.coord.z)/(b.tileExtent/b.tileSize),i=[c[0]/h,c[1]/h,0],j=new Float32Array(16);return g.translate(j,a,i),j},d.prototype.saveTexture=function(a){var b=this.reusableTextures[a.size];b?b.push(a):this.reusableTextures[a.size]=[a]},d.prototype.getTexture=function(a){var b=this.reusableTextures[a];return b&&b.length>0?b.pop():null}},{"../util/browser":95,"./draw_background":25,"./draw_circle":26,"./draw_debug":28,"./draw_fill":29,"./draw_line":30,"./draw_raster":31,"./draw_symbol":32,"./draw_vertices":33,"./frame_history":34,"./gl_util":35,"gl-matrix":116}],38:[function(a,b,c){b.exports={debug:{vertex:"precision mediump float;attribute vec2 a_pos;uniform mat4 u_matrix;void main(){gl_Position=u_matrix*vec4(a_pos,step(32767.,a_pos.x),1);}",fragment:"precision mediump float;uniform vec4 u_color;void main(){gl_FragColor=u_color;}"},dot:{vertex:"precision mediump float;uniform mat4 u_matrix;uniform float u_size;attribute vec2 a_pos;void main(){gl_Position=u_matrix*vec4(a_pos,0,1);gl_PointSize=u_size;}",fragment:"precision mediump float;uniform vec4 u_color;uniform float u_blur;void main(){float a,b;a=length(gl_PointCoord-.5);b=smoothstep(.5,.5-u_blur,a);gl_FragColor=u_color*b;}"},fill:{vertex:"precision mediump float;attribute vec2 a_pos;uniform mat4 u_matrix;void main(){gl_Position=u_matrix*vec4(a_pos,0,1);}",fragment:"precision mediump float;uniform vec4 u_color;void main(){gl_FragColor=u_color;}"},circle:{vertex:"precision mediump float;uniform float u_size;attribute vec2 a_pos;uniform mat4 u_matrix,u_exmatrix;varying vec2 a;void main(){a=vec2(mod(a_pos,2.)*2.-1.);vec4 b=u_exmatrix*vec4(a*u_size,0,0);gl_Position=u_matrix*vec4(floor(a_pos*.5),0,1);gl_Position+=b*gl_Position.w;}",fragment:"precision mediump float;uniform vec4 u_color;uniform float u_blur,u_size;varying vec2 a;void main(){float b=smoothstep(1.-u_blur,1.,length(a));gl_FragColor=u_color*(1.-b);}"},line:{vertex:"precision mediump float;attribute vec2 a_pos;attribute vec4 a_data;uniform highp mat4 u_matrix;uniform float u_ratio,u_extra;uniform vec2 u_linewidth;uniform mat2 u_antialiasingmatrix;varying vec2 a;varying float b,c;void main(){vec2 d,e;d=a_data.xy;e=mod(a_pos,2.);e.y=sign(e.y-.5);a=e;vec4 f=vec4(u_linewidth.s*d*.015873016,0,0);gl_Position=u_matrix*vec4(floor(a_pos*.5)+f.xy/u_ratio,0,1);float g,h,i;g=gl_Position.y/gl_Position.w;h=length(d)/length(u_antialiasingmatrix*d);i=1./(1.-min(g*u_extra,.9));c=i*h;}",fragment:"precision mediump float;uniform vec2 u_linewidth;uniform vec4 u_color;uniform float u_blur;varying vec2 a;varying float b,c;void main(){float d,e,f;d=length(a)*u_linewidth.s;e=u_blur*c;f=clamp(min(d-(u_linewidth.t-e),u_linewidth.s-d)/e,0.,1.);gl_FragColor=u_color*f;}"},linepattern:{vertex:"precision mediump float;attribute vec2 a_pos;attribute vec4 a_data;uniform highp mat4 u_matrix;uniform float u_ratio,u_extra;uniform vec2 u_linewidth;uniform vec4 u_color;uniform mat2 u_antialiasingmatrix;varying vec2 a;varying float b,c;void main(){vec2 d,f,g,h;d=a_data.xy;float e,i,j,k;e=a_data.z*128.+a_data.w;f=mod(a_pos,2.);f.y=sign(f.y-.5);a=f;g=d*.015873016;h=u_linewidth.s*g;gl_Position=u_matrix*vec4(floor(a_pos*.5)+h.xy/u_ratio,0,1);b=e;i=gl_Position.y/gl_Position.w;j=length(d)/length(u_antialiasingmatrix*d);k=1./(1.-min(i*u_extra,.9));c=k*j;}",fragment:"precision mediump float;uniform vec2 u_linewidth,u_pattern_size_a,u_pattern_size_b,u_pattern_tl_a,u_pattern_br_a,u_pattern_tl_b,u_pattern_br_b;uniform float u_point,u_blur,u_fade,u_opacity;uniform sampler2D u_image;varying vec2 a;varying float b,c;void main(){float d,e,f,g,h,i,j;d=length(a)*u_linewidth.s;e=u_blur*c;f=clamp(min(d-(u_linewidth.t-e),u_linewidth.s-d)/e,0.,1.);g=mod(b/u_pattern_size_a.x,1.);h=mod(b/u_pattern_size_b.x,1.);i=.5+a.y*u_linewidth.s/u_pattern_size_a.y;j=.5+a.y*u_linewidth.s/u_pattern_size_b.y;vec2 k,l;k=mix(u_pattern_tl_a,u_pattern_br_a,vec2(g,i));l=mix(u_pattern_tl_b,u_pattern_br_b,vec2(h,j));vec4 m=mix(texture2D(u_image,k),texture2D(u_image,l),u_fade);f*=u_opacity;gl_FragColor=m*f;}"},linesdfpattern:{vertex:"precision mediump float;attribute vec2 a_pos;attribute vec4 a_data;uniform highp mat4 u_matrix;uniform vec2 u_linewidth,u_patternscale_a,u_patternscale_b;uniform float u_ratio,u_tex_y_a,u_tex_y_b,u_extra;uniform mat2 u_antialiasingmatrix;varying vec2 a,b,c;varying float d;void main(){vec2 e,g;e=a_data.xy;float f,i,j,k;f=a_data.z*128.+a_data.w;g=mod(a_pos,2.);g.y=sign(g.y-.5);a=g;vec4 h=vec4(u_linewidth.s*e*.015873016,0,0);gl_Position=u_matrix*vec4(floor(a_pos*.5)+h.xy/u_ratio,0,1);b=vec2(f*u_patternscale_a.x,g.y*u_patternscale_a.y+u_tex_y_a);c=vec2(f*u_patternscale_b.x,g.y*u_patternscale_b.y+u_tex_y_b);i=gl_Position.y/gl_Position.w;j=length(e)/length(u_antialiasingmatrix*e);k=1./(1.-min(i*u_extra,.9));d=k*j;}",fragment:"precision mediump float;uniform vec2 u_linewidth;uniform vec4 u_color;uniform float u_blur,u_sdfgamma,u_mix;uniform sampler2D u_image;varying vec2 a,b,c;varying float d;void main(){float e,f,g,h,i,j;e=length(a)*u_linewidth.s;f=u_blur*d;g=clamp(min(e-(u_linewidth.t-f),u_linewidth.s-e)/f,0.,1.);h=texture2D(u_image,b).a;i=texture2D(u_image,c).a;j=mix(h,i,u_mix);g*=smoothstep(.5-u_sdfgamma,.5+u_sdfgamma,j);gl_FragColor=u_color*g;}"},outline:{vertex:"precision mediump float;attribute vec2 a_pos;uniform highp mat4 u_matrix;uniform vec2 u_world;varying vec2 a;void main(){gl_Position=u_matrix*vec4(a_pos,0,1);a=(gl_Position.xy/gl_Position.w+1.)/2.*u_world;}",fragment:"precision mediump float;uniform vec4 u_color;varying vec2 a;void main(){float b,c;b=length(a-gl_FragCoord.xy);c=smoothstep(1.,0.,b);gl_FragColor=u_color*c;}"},pattern:{vertex:"precision mediump float;uniform mat4 u_matrix;uniform mat3 u_patternmatrix_a,u_patternmatrix_b;attribute vec2 a_pos;varying vec2 a,b;void main(){gl_Position=u_matrix*vec4(a_pos,0,1);a=(u_patternmatrix_a*vec3(a_pos,1)).xy;b=(u_patternmatrix_b*vec3(a_pos,1)).xy;}",fragment:"precision mediump float;uniform float u_opacity,u_mix;uniform vec2 u_pattern_tl_a,u_pattern_br_a,u_pattern_tl_b,u_pattern_br_b;uniform sampler2D u_image;varying vec2 a,b;void main(){vec2 c,d,f,g;c=mod(a,1.);d=mix(u_pattern_tl_a,u_pattern_br_a,c);vec4 e,h;e=texture2D(u_image,d);f=mod(b,1.);g=mix(u_pattern_tl_b,u_pattern_br_b,f);h=texture2D(u_image,g);gl_FragColor=mix(e,h,u_mix)*u_opacity;}"},raster:{vertex:"precision mediump float;uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent,u_buffer_scale;attribute vec2 a_pos,a_texture_pos;varying vec2 a,b;void main(){gl_Position=u_matrix*vec4(a_pos,0,1);a=(a_texture_pos/32767.-.5)/u_buffer_scale+.5;b=a*u_scale_parent+u_tl_parent;}",fragment:"precision mediump float;uniform float u_opacity0,u_opacity1,u_brightness_low,u_brightness_high,u_saturation_factor,u_contrast_factor;uniform sampler2D u_image0,u_image1;varying vec2 a,b;uniform vec3 u_spin_weights;void main(){vec4 c,d,e;c=texture2D(u_image0,a);d=texture2D(u_image1,b);e=c*u_opacity0+d*u_opacity1;vec3 f,h,i;f=e.rgb;f=vec3(dot(f,u_spin_weights.xyz),dot(f,u_spin_weights.zxy),dot(f,u_spin_weights.yzx));float g=(e.r+e.g+e.b)/3.;f+=(g-f)*u_saturation_factor;f=(f-.5)*u_contrast_factor+.5;h=vec3(u_brightness_low);i=vec3(u_brightness_high);gl_FragColor=vec4(mix(h,i,f),e.a);}"},icon:{vertex:"precision mediump float;attribute vec2 a_pos,a_offset;attribute vec4 a_data1,a_data2;uniform highp mat4 u_matrix;uniform mat4 u_exmatrix;uniform float u_zoom,u_fadedist,u_minfadezoom,u_maxfadezoom,u_fadezoom,u_opacity,u_extra;uniform bool u_skewed;uniform vec2 u_texsize;varying vec2 a;varying float b;void main(){vec2 c,e;c=a_data1.xy;float d,f,g,h,i,j;d=a_data1[2];e=a_data2.st;f=e[0];g=e[1];h=10.;i=2.-step(f,u_zoom)-(1.-step(g,u_zoom));j=clamp((u_fadezoom-d)/u_fadedist,0.,1.);if(u_fadedist>=0.)b=j;else b=1.-j;if(u_maxfadezoom<d)b=0.;if(u_minfadezoom>=d)b=1.;i+=step(b,0.);if(u_skewed){vec4 k=u_exmatrix*vec4(a_offset/64.,0,0);gl_Position=u_matrix*vec4(a_pos+k.xy,0,1);gl_Position.z+=i*gl_Position.w;}else{vec4 k=u_exmatrix*vec4(a_offset/64.,i,0);gl_Position=u_matrix*vec4(a_pos,0,1)+k;}a=c/u_texsize;b*=u_opacity;}",fragment:"precision mediump float;uniform sampler2D u_texture;varying vec2 a;varying float b;void main(){gl_FragColor=texture2D(u_texture,a)*b;}"},sdf:{vertex:"precision mediump float;attribute vec2 a_pos,a_offset;attribute vec4 a_data1,a_data2;uniform highp mat4 u_matrix;uniform mat4 u_exmatrix;uniform float u_zoom,u_fadedist,u_minfadezoom,u_maxfadezoom,u_fadezoom,u_extra;uniform bool u_skewed;uniform vec2 u_texsize;varying vec2 a;varying float b,c;void main(){vec2 d,f;d=a_data1.xy;float e,g,h,i,j,k,l;e=a_data1[2];f=a_data2.st;g=f[0];h=f[1];i=2.-step(g,u_zoom)-(1.-step(h,u_zoom));j=clamp((u_fadezoom-e)/u_fadedist,0.,1.);if(u_fadedist>=0.)b=j;else b=1.-j;if(u_maxfadezoom<e)b=0.;if(u_minfadezoom>=e)b=1.;i+=step(b,0.);if(u_skewed){vec4 k=u_exmatrix*vec4(a_offset/64.,0,0);gl_Position=u_matrix*vec4(a_pos+k.xy,0,1);gl_Position.z+=i*gl_Position.w;}else{vec4 k=u_exmatrix*vec4(a_offset/64.,i,0);gl_Position=u_matrix*vec4(a_pos,0,1)+k;}k=gl_Position.y/gl_Position.w;l=1./(1.-k*u_extra);c=l;a=d/u_texsize;}",fragment:"precision mediump float;uniform sampler2D u_texture;uniform vec4 u_color;uniform float u_buffer,u_gamma;varying vec2 a;varying float b,c;void main(){float d,e,f;d=u_gamma*c;e=texture2D(u_texture,a).a;f=smoothstep(u_buffer-d,u_buffer+d,e)*b;gl_FragColor=u_color*f;}"},collisionbox:{vertex:"precision mediump float;attribute vec2 a_pos,a_extrude,a_data;uniform mat4 u_matrix;uniform float u_scale;varying float a,b;void main(){gl_Position=u_matrix*vec4(a_pos+a_extrude/u_scale,0,1);a=a_data.x;b=a_data.y;}",fragment:"precision mediump float;uniform float u_zoom,u_maxzoom;varying float a,b;void main(){float c=.5;gl_FragColor=vec4(0,1,0,1)*c;if(b>u_zoom)gl_FragColor=vec4(1,0,0,1)*c;if(u_zoom>=a)gl_FragColor=vec4(0,0,0,1)*c*.25;if(b>=u_maxzoom)gl_FragColor=vec4(0,0,1,1)*c*.2;}"}}},{}],39:[function(a,b,c){function d(a){a=a||{},this._data=a.data,void 0!==a.maxzoom&&(this.maxzoom=a.maxzoom),this.geojsonVtOptions={maxZoom:this.maxzoom},void 0!==a.buffer&&(this.geojsonVtOptions.buffer=a.buffer),void 0!==a.tolerance&&(this.geojsonVtOptions.tolerance=a.tolerance),this._pyramid=new g({tileSize:512,minzoom:this.minzoom,maxzoom:this.maxzoom,cacheSize:20,load:this._loadTile.bind(this),abort:this._abortTile.bind(this),unload:this._unloadTile.bind(this),add:this._addTile.bind(this),remove:this._removeTile.bind(this)})}var e=a("../util/util"),f=a("../util/evented"),g=a("./tile_pyramid"),h=a("./source"),i=a("resolve-url");b.exports=d,d.prototype=e.inherit(f,{minzoom:0,maxzoom:14,_dirty:!0,setData:function(a){return this._data=a,this._dirty=!0,this.fire("change"),this.map&&this.update(this.map.transform),this},onAdd:function(a){this.map=a},loaded:function(){return this._loaded&&this._pyramid.loaded()},update:function(a){this._dirty&&this._updateData(),this._loaded&&this._pyramid.update(this.used,a)},reload:function(){this._loaded&&this._pyramid.reload()},render:h._renderTiles,featuresAt:h._vectorFeaturesAt,featuresIn:h._vectorFeaturesIn,_updateData:function(){this._dirty=!1;var a=this._data;"string"==typeof a&&(a=i(window.location.href,a)),this.workerID=this.dispatcher.send("parse geojson",{data:a,tileSize:512,source:this.id,geojsonVtOptions:this.geojsonVtOptions},function(a){return a?void this.fire("error",{error:a}):(this._loaded=!0,this._pyramid.reload(),void this.fire("change"))}.bind(this))},_loadTile:function(a){var b=a.coord.z>this.maxzoom?Math.pow(2,a.coord.z-this.maxzoom):1,c={uid:a.uid,coord:a.coord,zoom:a.coord.z,maxZoom:this.maxzoom,tileSize:512,source:this.id,overscaling:b,angle:this.map.transform.angle,pitch:this.map.transform.pitch,collisionDebug:this.map.collisionDebug};a.workerID=this.dispatcher.send("load geojson tile",c,function(b,c){if(a.unloadVectorData(this.map.painter),!a.aborted){if(b)return void this.fire("tile.error",{tile:a});a.loadVectorData(c),this.fire("tile.load",{tile:a})}}.bind(this),this.workerID)},_abortTile:function(a){a.aborted=!0},_addTile:function(a){this.fire("tile.add",{tile:a})},_removeTile:function(a){this.fire("tile.remove",{tile:a})},_unloadTile:function(a){a.unloadVectorData(this.map.painter),this.glyphAtlas.removeGlyphs(a.uid),this.dispatcher.send("remove tile",{uid:a.uid,source:this.id},null,a.workerID)}})},{"../util/evented":100,"../util/util":106,"./source":43,"./tile_pyramid":46,"resolve-url":140}],40:[function(a,b,c){function d(a){this.features=a,this.length=a.length}function e(a){this.type=a.type,this.rawGeometry=1===a.type?[a.geometry]:a.geometry,this.properties=a.tags,this.extent=4096}var f=a("point-geometry"),g=a("vector-tile").VectorTileFeature;b.exports=d,d.prototype.feature=function(a){return new e(this.features[a])},e.prototype.loadGeometry=function(){var a=this.rawGeometry;this.geometry=[];for(var b=0;b<a.length;b++){for(var c=a[b],d=[],e=0;e<c.length;e++)d.push(new f(c[e][0],c[e][1]));this.geometry.push(d)}return this.geometry},e.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var a=this.geometry,b=1/0,c=-(1/0),d=1/0,e=-(1/0),f=0;f<a.length;f++)for(var g=a[f],h=0;h<g.length;h++){var i=g[h];b=Math.min(b,i.x),c=Math.max(c,i.x),d=Math.min(d,i.y),e=Math.max(e,i.y)}return[b,d,c,e]},e.prototype.toGeoJSON=g.prototype.toGeoJSON},{"point-geometry":137,"vector-tile":144}],41:[function(a,b,c){function d(a){this.coordinates=a.coordinates,j.getImage(a.url,function(a,b){a||(this.image=b,this.image.addEventListener("load",function(){this.map._rerender()}.bind(this)),this._loaded=!0,this.map&&(this.createTile(),this.fire("change")))}.bind(this))}var e=a("../util/util"),f=a("./tile"),g=a("../geo/lng_lat"),h=a("point-geometry"),i=a("../util/evented"),j=a("../util/ajax");b.exports=d,d.prototype=e.inherit(i,{onAdd:function(a){this.map=a,this.image&&this.createTile()},createTile:function(){var a=this.map,b=this.coordinates.map(function(b){var c=g.convert(b);return a.transform.locationCoordinate(c).zoomTo(0)}),c=e.getCoordinatesCenter(b),d=4096,i=b.map(function(a){var b=a.zoomTo(c.zoom);return new h(Math.round((b.column-c.column)*d),Math.round((b.row-c.row)*d))}),j=a.painter.gl,k=32767,l=new Int16Array([i[0].x,i[0].y,0,0,i[1].x,i[1].y,k,0,i[3].x,i[3].y,0,k,i[2].x,i[2].y,k,k]);this.tile=new f,this.tile.buckets={},this.tile.boundsBuffer=j.createBuffer(),j.bindBuffer(j.ARRAY_BUFFER,this.tile.boundsBuffer),j.bufferData(j.ARRAY_BUFFER,l,j.STATIC_DRAW),this.center=c},loaded:function(){return this.image&&this.image.complete},update:function(){},reload:function(){},render:function(a,b){if(this._loaded&&this.loaded()){var c=this.center;this.tile.calculateMatrices(c.zoom,c.column,c.row,this.map.transform,b);var d=b.gl;this.tile.texture?(d.bindTexture(d.TEXTURE_2D,this.tile.texture),d.texSubImage2D(d.TEXTURE_2D,0,0,0,d.RGBA,d.UNSIGNED_BYTE,this.image)):(this.tile.texture=d.createTexture(),d.bindTexture(d.TEXTURE_2D,this.tile.texture),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,this.image)),b.drawLayers(a,this.tile.posMatrix,this.tile)}},featuresAt:function(a,b,c){return c(null,[])}})},{"../geo/lng_lat":20,"../util/ajax":94,"../util/evented":100,"../util/util":106,"./tile":44,"point-geometry":137}],42:[function(a,b,c){function d(a){e.extend(this,e.pick(a,["url","tileSize"])),h._loadTileJSON.call(this,a)}var e=a("../util/util"),f=a("../util/ajax"),g=a("../util/evented"),h=a("./source"),i=a("../util/mapbox").normalizeTileURL;b.exports=d,d.prototype=e.inherit(g,{minzoom:0,maxzoom:22,roundZoom:!0,tileSize:512,_loaded:!1,onAdd:function(a){this.map=a},loaded:function(){return this._pyramid&&this._pyramid.loaded()},update:function(a){this._pyramid&&this._pyramid.update(this.used,a,this.map.style.rasterFadeDuration)},reload:function(){},render:h._renderTiles,_loadTile:function(a){function b(b,c){if(delete a.request,!a.aborted){if(b)return void this.fire("tile.error",{tile:a});var d=this.map.painter.gl;a.texture=this.map.painter.getTexture(c.width),a.texture?(d.bindTexture(d.TEXTURE_2D,a.texture),d.texSubImage2D(d.TEXTURE_2D,0,0,0,d.RGBA,d.UNSIGNED_BYTE,c)):(a.texture=d.createTexture(),d.bindTexture(d.TEXTURE_2D,a.texture),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR_MIPMAP_NEAREST),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,c),a.texture.size=c.width),d.generateMipmap(d.TEXTURE_2D),a.timeAdded=(new Date).getTime(),this.map.animationLoop.set(this.style.rasterFadeDuration),a.source=this,a.loaded=!0,this.fire("tile.load",{tile:a})}}var c=i(a.coord.url(this.tiles),this.url);a.request=f.getImage(c,b.bind(this))},_abortTile:function(a){a.aborted=!0,a.request&&(a.request.abort(),delete a.request)},_addTile:function(a){this.fire("tile.add",{tile:a})},_removeTile:function(a){this.fire("tile.remove",{tile:a})},_unloadTile:function(a){a.texture&&this.map.painter.saveTexture(a.texture)},featuresAt:function(a,b,c){c(null,[])},featuresIn:function(a,b,c){c(null,[])}})},{"../util/ajax":94,"../util/evented":100,"../util/mapbox":103,"../util/util":106,"./source":43}],43:[function(a,b,c){var d=a("../util/util"),e=a("../util/ajax"),f=a("../util/browser"),g=a("./tile_pyramid"),h=a("./tile_coord"),i=a("../util/mapbox").normalizeSourceURL;c._loadTileJSON=function(a){var b=function(a){this._pyramid=new g({index:a,tileSize:this.tileSize,cacheSize:20,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom,reparseOverscaled:this.reparseOverscaled,load:this._loadTile.bind(this),abort:this._abortTile.bind(this),unload:this._unloadTile.bind(this),add:this._addTile.bind(this),remove:this._removeTile.bind(this),redoPlacement:this._redoTilePlacement?this._redoTilePlacement.bind(this):void 0})}.bind(this),c=function(a,c){return a?void this.fire("error",{error:a}):(d.extend(this,d.pick(c,["tiles","minzoom","maxzoom","attribution"])),void(c.index?e.getJSON(i(c.index),function(a,c){return a?void this.fire("error",{error:a}):(b(c.index),void this.fire("load"))}.bind(this)):(b(),this.fire("load"))))}.bind(this);a.url?e.getJSON(i(a.url),c):f.frame(c.bind(this,null,a))},c._renderTiles=function(a,b){if(this._pyramid)for(var c=this._pyramid.renderedIDs(),d=0;d<c.length;d++){var e=this._pyramid.getTile(c[d]),f=h.fromID(c[d]),g=f.z,i=f.x,j=f.y,k=f.w;g=Math.min(g,this.maxzoom),(e.tileExtent>4096||e.parentId)&&(e.tileExtent=4096),i+=k*(1<<g),e.calculateMatrices(g,i,j,b.transform,b),b.drawTile(e,a)}},c._vectorFeaturesAt=function(a,b,c){if(!this._pyramid)return c(null,[]);var d=this._pyramid.tileAt(a);return d?void this.dispatcher.send("query features",{uid:d.tile.uid,x:d.x,y:d.y,tileExtent:d.tile.tileExtent,scale:d.scale,source:this.id,params:b},c,d.tile.workerID):c(null,[])},c._vectorFeaturesIn=function(a,b,c){if(!this._pyramid)return c(null,[]);var e=this._pyramid.tilesIn(a);return e?void d.asyncAll(e,function(a,c){this.dispatcher.send("query features",{uid:a.tile.uid,source:this.id,minX:a.minX,maxX:a.maxX,minY:a.minY,maxY:a.maxY,params:b},c,a.tile.workerID)}.bind(this),function(a,b){c(a,Array.prototype.concat.apply([],b))}):c(null,[])},c.create=function(b){var c={vector:a("./vector_tile_source"),raster:a("./raster_tile_source"),geojson:a("./geojson_source"),video:a("./video_source"),image:a("./image_source")};for(var d in c)if(b instanceof c[d])return b;return new c[b.type](b)}},{"../util/ajax":94,"../util/browser":95,"../util/mapbox":103,"../util/util":106,"./geojson_source":39,"./image_source":41,"./raster_tile_source":42,"./tile_coord":45,"./tile_pyramid":46,"./vector_tile_source":47,"./video_source":48}],44:[function(a,b,c){function d(a,b){this.coord=a,this.uid=h.uniqueId(),this.loaded=!1,this.uses=0,this.tileSize=b}var e=a("gl-matrix"),f=e.mat2,g=e.mat4,h=a("../util/util"),i=a("../data/buffer/buffer_set");b.exports=d,d.prototype={tileExtent:4096,calculateMatrices:function(a,b,c,d){var e=Math.pow(2,a),h=d.worldSize/e;this.scale=h,this.posMatrix=new Float64Array(16),g.identity(this.posMatrix),g.translate(this.posMatrix,this.posMatrix,[b*h,c*h,0]),g.scale(this.posMatrix,this.posMatrix,[h/this.tileExtent,h/this.tileExtent,1]),g.multiply(this.posMatrix,d.getProjMatrix(),this.posMatrix),this.exMatrix=g.create(),g.ortho(this.exMatrix,0,d.width,d.height,0,0,-1),this.rotationMatrix=f.create(),f.rotate(this.rotationMatrix,this.rotationMatrix,d.angle),this.posMatrix=new Float32Array(this.posMatrix)},positionAt:function(a,b){return a=a.zoomTo(Math.min(this.coord.z,b)),{x:(a.column-this.coord.x)*this.tileExtent,y:(a.row-this.coord.y)*this.tileExtent,scale:this.scale}},loadVectorData:function(a){this.loaded=!0,a&&(this.buffers=new i(a.buffers),this.elementGroups=a.elementGroups,this.tileExtent=a.extent)},reloadSymbolData:function(a,b){if(this.buffers){this.buffers.glyphVertex.destroy(b.gl),this.buffers.glyphElement.destroy(b.gl),
this.buffers.iconVertex.destroy(b.gl),this.buffers.iconElement.destroy(b.gl),this.buffers.collisionBoxVertex.destroy(b.gl);var c=new i(a.buffers);this.buffers.glyphVertex=c.glyphVertex,this.buffers.glyphElement=c.glyphElement,this.buffers.iconVertex=c.iconVertex,this.buffers.iconElement=c.iconElement,this.buffers.collisionBoxVertex=c.collisionBoxVertex;for(var d in a.elementGroups)this.elementGroups[d]=a.elementGroups[d]}},unloadVectorData:function(a){for(var b in this.buffers)this.buffers[b].destroy(a.gl);this.buffers=null}}},{"../data/buffer/buffer_set":2,"../util/util":106,"gl-matrix":116}],45:[function(a,b,c){function d(a,b,c,d){isNaN(d)&&(d=0),this.z=+a,this.x=+b,this.y=+c,this.w=+d,d*=2,0>d&&(d=-1*d-1);var e=1<<this.z;this.id=32*(e*e*d+e*this.y+this.x)+this.z}function e(a,b){if(a.row>b.row){var c=a;a=b,b=c}return{x0:a.column,y0:a.row,x1:b.column,y1:b.row,dx:b.column-a.column,dy:b.row-a.row}}function f(a,b,c,d,e){var f=Math.max(c,Math.floor(b.y0)),g=Math.min(d,Math.ceil(b.y1));if(a.x0===b.x0&&a.y0===b.y0?a.x0+b.dy/a.dy*a.dx<b.x1:a.x1-b.dy/a.dy*a.dx<b.x0){var h=a;a=b,b=h}for(var i=a.dx/a.dy,j=b.dx/b.dy,k=a.dx>0,l=b.dx<0,m=f;g>m;m++){var n=i*Math.max(0,Math.min(a.dy,m+k-a.y0))+a.x0,o=j*Math.max(0,Math.min(b.dy,m+l-b.y0))+b.x0;e(Math.floor(o),Math.ceil(n),m)}}function g(a,b,c,d,g,h){var i,j=e(a,b),k=e(b,c),l=e(c,a);j.dy>k.dy&&(i=j,j=k,k=i),j.dy>l.dy&&(i=j,j=l,l=i),k.dy>l.dy&&(i=k,k=l,l=i),j.dy&&f(l,j,d,g,h),k.dy&&f(l,k,d,g,h)}b.exports=d,d.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y},d.fromID=function(a){var b=a%32,c=1<<b,e=(a-b)/32,f=e%c,g=(e-f)/c%c,h=Math.floor(e/(c*c));return h%2!==0&&(h=-1*h-1),h/=2,new d(b,f,g,h)},d.prototype.url=function(a,b){return a[(this.x+this.y)%a.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",Math.min(this.z,b||this.z)).replace("{x}",this.x).replace("{y}",this.y)},d.prototype.parent=function(a){return 0===this.z?null:this.z>a?new d(this.z-1,this.x,this.y,this.w):new d(this.z-1,Math.floor(this.x/2),Math.floor(this.y/2),this.w)},d.prototype.wrapped=function(){return new d(this.z,this.x,this.y,0)},d.prototype.children=function(a){if(this.z>=a)return[new d(this.z+1,this.x,this.y,this.w)];var b=this.z+1,c=2*this.x,e=2*this.y;return[new d(b,c,e,this.w),new d(b,c+1,e,this.w),new d(b,c,e+1,this.w),new d(b,c+1,e+1,this.w)]},d.cover=function(a,b,c){function e(a,b,e){var g,i,j;if(e>=0&&f>=e)for(g=a;b>g;g++)i=(g%f+f)%f,j=new d(c,i,e,Math.floor(g/f)),h[j.id]=j}var f=1<<a,h={};return g(b[0],b[1],b[2],0,f,e),g(b[2],b[3],b[0],0,f,e),Object.keys(h).map(function(a){return h[a]})}},{}],46:[function(a,b,c){function d(a){this.tileSize=a.tileSize,this.minzoom=a.minzoom,this.maxzoom=a.maxzoom,this.roundZoom=a.roundZoom,this.reparseOverscaled=a.reparseOverscaled,this.index=a.index,this._load=a.load,this._abort=a.abort,this._unload=a.unload,this._add=a.add,this._remove=a.remove,this._redoPlacement=a.redoPlacement,this._tiles={},this._cache=new h(a.cacheSize,function(a){return this._unload(a)}.bind(this))}var e=a("./tile"),f=a("./tile_coord"),g=a("point-geometry"),h=a("../util/mru_cache"),i=a("../util/util");b.exports=d,d.prototype={loaded:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0},orderedIDs:function(){return Object.keys(this._tiles).sort(function(a,b){return b%32-a%32}).map(function(a){return+a})},renderedIDs:function(){return this.orderedIDs().filter(function(a){return this._tiles[a].loaded&&!this._coveredTiles[a]}.bind(this))},reload:function(){this._cache.reset();for(var a in this._tiles)this._load(this._tiles[a])},getTile:function(a){return this._tiles[a]},getZoom:function(a){return a.zoom+Math.log(a.tileSize/this.tileSize)/Math.LN2},coveringZoomLevel:function(a){return(this.roundZoom?Math.round:Math.floor)(this.getZoom(a))},coveringTiles:function(a){var b=this.coveringZoomLevel(a),c=b;if(b<this.minzoom)return[];b>this.maxzoom&&(b=this.maxzoom);var d=a,e=d.locationCoordinate(d.center)._zoomTo(b),h=new g(e.column-.5,e.row-.5);return f.cover(b,[d.pointCoordinate(new g(0,0))._zoomTo(b),d.pointCoordinate(new g(d.width,0))._zoomTo(b),d.pointCoordinate(new g(d.width,d.height))._zoomTo(b),d.pointCoordinate(new g(0,d.height))._zoomTo(b)],this.reparseOverscaled?c:b).sort(function(a,b){return h.dist(a)-h.dist(b)})},findLoadedChildren:function(a,b,c){for(var d=!0,e=a.z,f=a.children(this.maxzoom),g=0;g<f.length;g++){var h=f[g].id;this._tiles[h]&&this._tiles[h].loaded?c[h]=!0:(d=!1,b>e&&this.findLoadedChildren(f[g],b,c))}return d},findLoadedParent:function(a,b,c){for(var d=a.z-1;d>=b;d--){a=a.parent(this.maxzoom);var e=this._tiles[a.id];if(e&&e.loaded)return c[a.id]=!0,e}},update:function(a,b,c){var d,e,g,h=(this.roundZoom?Math.round:Math.floor)(this.getZoom(b)),j=i.clamp(h-10,this.minzoom,this.maxzoom),k=i.clamp(h+1,this.minzoom,this.maxzoom),l={},m=(new Date).getTime();this._coveredTiles={};var n=a?this.coveringTiles(b):[];for(d=0;d<n.length;d++)e=n[d],g=this.addTile(e),l[e.id]=!0,g.loaded||this.findLoadedChildren(e,k,l)||this.findLoadedParent(e,j,l);for(var o in l)e=f.fromID(o),g=this._tiles[o],g&&g.timeAdded>m-(c||0)&&(this.findLoadedChildren(e,k,l)?(this._coveredTiles[o]=!0,l[o]=!0):this.findLoadedParent(e,j,l));var p=i.keysDifference(this._tiles,l);for(d=0;d<p.length;d++)this.removeTile(+p[d])},addTile:function(a){var b=this._tiles[a.id];if(b)return b;var c=a.wrapped();if(b=this._tiles[c.id],b||(b=this._cache.get(c.id),b&&this._redoPlacement&&this._redoPlacement(b)),!b){var d=a.z,f=d>this.maxzoom?Math.pow(2,d-this.maxzoom):1;b=new e(c,this.tileSize*f),this.index&&(b.parentId=this.indexSearch(a.id)),this._load(b)}return b.uses++,this._tiles[a.id]=b,this._add(b,a),b},removeTile:function(a){var b=this._tiles[a];b&&(b.uses--,delete this._tiles[a],this._remove(b),b.uses>0||(b.loaded?this._cache.add(b.coord.wrapped().id,b):(this._abort(b),this._unload(b))))},clearTiles:function(){for(var a in this._tiles)this.removeTile(a);this._cache.reset()},tileAt:function(a){for(var b=this.orderedIDs(),c=0;c<b.length;c++){var d=this._tiles[b[c]],e=d.positionAt(a,this.maxzoom);if(e&&e.x>=0&&e.x<d.tileExtent&&e.y>=0&&e.y<d.tileExtent)return{tile:d,x:e.x,y:e.y,scale:e.scale}}},tilesIn:function(a){for(var b=[],c=this.orderedIDs(),d=0;d<c.length;d++){var e=this._tiles[c[d]],f=[e.positionAt(a[0],this.maxzoom),e.positionAt(a[1],this.maxzoom)];f[0].x<e.tileExtent&&f[0].y<e.tileExtent&&f[1].x>=0&&f[1].y>=0&&b.push({tile:e,minX:f[0].x,maxX:f[1].x,minY:f[0].y,maxY:f[1].y})}return b},indexSearch:function(a){for(var b=f.fromID(a),c=[a],d=b;0!==d.z;)d=d.parent(),c.push(d.id);for(var e,g=this.index,h=c.pop(),i=function(a){return a.id};c.length;)if(a=c.pop(),b=f.fromID(h),e=b.children(this.maxzoom).map(i).indexOf(a),g){if(0===g[e]){h=a;break}if(1===g[e]){h=a;break}h=a,g=g[e]}return 0===c.length?null:h}}},{"../util/mru_cache":104,"../util/util":106,"./tile":44,"./tile_coord":45,"point-geometry":137}],47:[function(a,b,c){function d(a){if(e.extend(this,e.pick(a,["url","tileSize"])),512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");g._loadTileJSON.call(this,a)}var e=a("../util/util"),f=a("../util/evented"),g=a("./source"),h=a("./tile_coord");b.exports=d,d.prototype=e.inherit(f,{minzoom:0,maxzoom:22,tileSize:512,reparseOverscaled:!0,_loaded:!1,onAdd:function(a){this.map=a},loaded:function(){return this._pyramid&&this._pyramid.loaded()},update:function(a){this._pyramid&&this._pyramid.update(this.used,a)},reload:function(){this._pyramid&&this._pyramid.reload()},redoPlacement:function(){if(this._pyramid)for(var a=this._pyramid.orderedIDs(),b=0;b<a.length;b++){var c=this._pyramid.getTile(a[b]);this._redoTilePlacement(c)}},render:g._renderTiles,featuresAt:g._vectorFeaturesAt,featuresIn:g._vectorFeaturesIn,_loadTile:function(a){var b=a.coord.z>this.maxzoom?Math.pow(2,a.coord.z-this.maxzoom):1,c={url:a.coord.url(this.tiles,this.maxzoom),uid:a.uid,coord:a.coord,zoom:a.coord.z,maxZoom:this.maxzoom,tileSize:this.tileSize*b,source:this.id,overscaling:b,angle:this.map.transform.angle,pitch:this.map.transform.pitch,collisionDebug:this.map.collisionDebug,parentId:a.parentId};a.parentId&&(c.url=h.fromID(a.parentId).url(this.tiles,this.maxzoom)),a.workerID?this.dispatcher.send("reload tile",c,this._tileLoaded.bind(this,a),a.workerID):a.workerID=this.dispatcher.send("load tile",c,this._tileLoaded.bind(this,a))},_tileLoaded:function(a,b,c){if(!a.aborted){if(b)return void this.fire("tile.error",{tile:a});a.loadVectorData(c),a.redoWhenDone&&(a.redoWhenDone=!1,this._redoTilePlacement(a)),this.fire("tile.load",{tile:a}),this.fire("tile.stats",c.bucketStats)}},_abortTile:function(a){a.aborted=!0,this.dispatcher.send("abort tile",{uid:a.uid,source:this.id},null,a.workerID)},_addTile:function(a){this.fire("tile.add",{tile:a})},_removeTile:function(a){this.fire("tile.remove",{tile:a})},_unloadTile:function(a){a.unloadVectorData(this.map.painter),this.glyphAtlas.removeGlyphs(a.uid),this.dispatcher.send("remove tile",{uid:a.uid,source:this.id},null,a.workerID)},_redoTilePlacement:function(a){function b(b,c){a.reloadSymbolData(c,this.map.painter),this.fire("tile.load",{tile:a}),a.redoingPlacement=!1,a.redoWhenDone&&(this._redoTilePlacement(a),a.redoWhenDone=!1)}return!a.loaded||a.redoingPlacement?void(a.redoWhenDone=!0):(a.redoingPlacement=!0,void this.dispatcher.send("redo placement",{uid:a.uid,source:this.id,angle:this.map.transform.angle,pitch:this.map.transform.pitch,collisionDebug:this.map.collisionDebug},b.bind(this),a.workerID))}})},{"../util/evented":100,"../util/util":106,"./source":43,"./tile_coord":45}],48:[function(a,b,c){function d(a){this.coordinates=a.coordinates,j.getVideo(a.urls,function(a,b){if(!a){this.video=b,this.video.loop=!0;var c;this.video.addEventListener("playing",function(){c=this.map.style.animationLoop.set(1/0),this.map._rerender()}.bind(this)),this.video.addEventListener("pause",function(){this.map.style.animationLoop.cancel(c)}.bind(this)),this._loaded=!0,this.map&&(this.video.play(),this.createTile(),this.fire("change"))}}.bind(this))}var e=a("../util/util"),f=a("./tile"),g=a("../geo/lng_lat"),h=a("point-geometry"),i=a("../util/evented"),j=a("../util/ajax");b.exports=d,d.prototype=e.inherit(i,{roundZoom:!0,getVideo:function(){return this.video},onAdd:function(a){this.map=a,this.video&&(this.video.play(),this.createTile())},createTile:function(){var a=this.map,b=this.coordinates.map(function(b){var c=g.convert(b);return a.transform.locationCoordinate(c).zoomTo(0)}),c=e.getCoordinatesCenter(b),d=4096,i=b.map(function(a){var b=a.zoomTo(c.zoom);return new h(Math.round((b.column-c.column)*d),Math.round((b.row-c.row)*d))}),j=a.painter.gl,k=32767,l=new Int16Array([i[0].x,i[0].y,0,0,i[1].x,i[1].y,k,0,i[3].x,i[3].y,0,k,i[2].x,i[2].y,k,k]);this.tile=new f,this.tile.buckets={},this.tile.boundsBuffer=j.createBuffer(),j.bindBuffer(j.ARRAY_BUFFER,this.tile.boundsBuffer),j.bufferData(j.ARRAY_BUFFER,l,j.STATIC_DRAW),this.center=c},loaded:function(){return this.video&&this.video.readyState>=2},update:function(){},reload:function(){},render:function(a,b){if(this._loaded&&!(this.video.readyState<2)){var c=this.center;this.tile.calculateMatrices(c.zoom,c.column,c.row,this.map.transform,b);var d=b.gl;this.tile.texture?(d.bindTexture(d.TEXTURE_2D,this.tile.texture),d.texSubImage2D(d.TEXTURE_2D,0,0,0,d.RGBA,d.UNSIGNED_BYTE,this.video)):(this.tile.texture=d.createTexture(),d.bindTexture(d.TEXTURE_2D,this.tile.texture),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,this.video)),b.drawLayers(a,this.tile.posMatrix,this.tile)}},featuresAt:function(a,b,c){return c(null,[])},featuresIn:function(a,b,c){return c(null,[])}})},{"../geo/lng_lat":20,"../util/ajax":94,"../util/evented":100,"../util/util":106,"./tile":44,"point-geometry":137}],49:[function(a,b,c){function d(a){this.self=a,this.actor=new e(a,this),this.loading={},this.loaded={},this.layers=[],this.geoJSONIndexes={}}var e=a("../util/actor"),f=a("./worker_tile"),g=a("../util/util"),h=a("../util/ajax"),i=a("vector-tile"),j=a("pbf"),k=a("./tile_coord"),l=a("geojson-vt"),m=a("./geojson_wrapper");b.exports=function(a){return new d(a)},g.extend(d.prototype,{"set layers":function(a){this.layers=a},"load tile":function(a,b){function c(c,f){if(delete this.loading[d][e],c)return b(c);if(g.data=new i.VectorTile(new j(new Uint8Array(f))),a.parentId&&g.data.layers){var h=this.getChildPosition(a.coord.id,a.parentId);g.parse(g.data,this.layers,this.actor,b,h.dz,h.xPos,h.yPos)}else g.parse(g.data,this.layers,this.actor,b);this.loaded[d]=this.loaded[d]||{},this.loaded[d][e]=g}var d=a.source,e=a.uid;this.loading[d]||(this.loading[d]={});var g=this.loading[d][e]=new f(a);g.xhr=h.getArrayBuffer(a.url,c.bind(this))},"reload tile":function(a,b){var c=this.loaded[a.source],d=a.uid;if(c&&c[d]){var e=c[d];e.parse(e.data,this.layers,this.actor,b)}},"abort tile":function(a){var b=this.loading[a.source],c=a.uid;b&&b[c]&&(b[c].xhr.abort(),delete b[c])},"remove tile":function(a){var b=this.loaded[a.source],c=a.uid;b&&b[c]&&delete b[c]},"redo placement":function(a,b){var c=this.loaded[a.source],d=this.loading[a.source],e=a.uid;if(c&&c[e]){var f=c[e],g=f.redoPlacement(a.angle,a.pitch,a.collisionDebug);g.result&&b(null,g.result,g.transferables)}else d&&d[e]&&(d[e].angle=a.angle)},"parse geojson":function(a,b){var c=function(c,d){return c?b(c):(this.geoJSONIndexes[a.source]=l(d,a.geojsonVtOptions),void b(null))}.bind(this);"string"==typeof a.data?h.getJSON(a.data,c):c(null,a.data)},"load geojson tile":function(a,b){var c=a.source,d=a.coord,e=this.geoJSONIndexes[c].getTile(d.z,d.x,d.y);if(!e)return b(null,null);var g=new f(a);g.parse(new m(e.features),this.layers,this.actor,b),this.loaded[c]=this.loaded[c]||{},this.loaded[c][a.uid]=g},"query features":function(a,b){var c=this.loaded[a.source]&&this.loaded[a.source][a.uid];c?c.featureTree.query(a,b):b(null,[])},getChildPosition:function(a,b){var c=k.fromID(a),d=k.fromID(b),e=c.z-d.z,f=c.x&(1<<e)-1,g=c.y&(1<<e)-1;return{dz:e,xPos:f,yPos:g}}})},{"../util/actor":93,"../util/ajax":94,"../util/util":106,"./geojson_wrapper":40,"./tile_coord":45,"./worker_tile":50,"geojson-vt":111,pbf:136,"vector-tile":144}],50:[function(a,b,c){function d(a){this.coord=a.coord,this.uid=a.uid,this.zoom=a.zoom,this.maxZoom=a.maxZoom,this.tileSize=a.tileSize,this.source=a.source,this.overscaling=a.overscaling,this.angle=a.angle,this.pitch=a.pitch,this.collisionDebug=a.collisionDebug,this.stacks={}}var e=a("../data/feature_tree"),f=a("../symbol/collision_tile"),g=a("../data/buffer/buffer_set"),h=a("../data/create_bucket");b.exports=d,d.prototype.parse=function(a,b,c,d,i,j,k){function l(a,b,c,d,e){for(var f=0;f<a.length;f++){var g=a.feature(f);g.dz=c,g.xPos=d,g.yPos=e;for(var h in b){var i=b[h];i.filter(g)&&i.features.push(g)}}}function m(a){return function(b){a.dependenciesLoaded=!0,n(t,a,b)}}function n(a,b,c){if((!b.getDependencies||b.dependenciesLoaded)&&(!b.needsPlacement||b.previousPlaced)){if(!c){var d=Date.now();b.features.length&&b.addFeatures(v);var e=Date.now()-d;if(b.interactive)for(var f=0;f<b.features.length;f++){var g=b.features[f];a.featureTree.insert(g.bbox(),b.layers,g)}"undefined"!=typeof self&&(self.bucketStats=self.bucketStats||{_total:0},self.bucketStats._total+=e,self.bucketStats[b.id]=(self.bucketStats[b.id]||0)+e),b.features=null}return F--,F?void(b.next&&(b.next.previousPlaced=!0,n(a,b.next))):void o()}}function o(){if(t.status="done",t.redoPlacementAfterDone){var a=t.redoPlacement(t.angle,t.pitch).result;u.glyphVertex=a.buffers.glyphVertex,u.iconVertex=a.buffers.iconVertex,u.collisionBoxVertex=a.buffers.collisionBoxVertex}var b=[],c={};for(q in u)b.push(u[q].array);for(q in w)c[q]=w[q].elementGroups;d(null,{elementGroups:c,buffers:u,extent:D,bucketStats:"undefined"!=typeof self?self.bucketStats:null},b)}this.status="parsing",this.featureTree=new e(this.coord,this.overscaling);var p,q,r,s,t=this,u=new g,v=new f(this.angle,this.pitch),w={},x=this.bucketsInOrder=[],y={};for(p=0;p<b.length;p++)if(r=b[p],r.source===this.source&&!r.ref){var z=r.minzoom;if(!(z&&this.zoom<z&&z<this.maxZoom)){var A=r.maxzoom;if(!(A&&this.zoom>=A)){var B=r.layout.visibility;if("none"!==B)if(s=h(r,u,this.zoom,this.overscaling,this.collisionDebug),s.layers=[r.id],w[s.id]=s,x.push(s),a.layers){var C=r["source-layer"];y[C]||(y[C]={}),y[C][s.id]=s}else y[s.id]=s}}}for(p=0;p<b.length;p++)r=b[p],r.source===this.source&&r.ref&&(s=w[r.ref],s&&s.layers.push(r.id));var D=4096;if(a.layers)for(q in y)r=a.layers[q],r&&(r.extent&&(D=r.extent),l(r,y[q],i,j,k));else l(a,y);var E,F=x.length;for(p=x.length-1;p>=0;p--)s=x[p],s.needsPlacement&&(E?E.next=s:s.previousPlaced=!0,E=s),s.getDependencies&&s.getDependencies(this,c,m(s)),s.needsPlacement||s.getDependencies||n(t,s)},d.prototype.redoPlacement=function(a,b,c){if("done"!==this.status)return this.redoPlacementAfterDone=!0,this.angle=a,{};for(var d=new g,e=[],h={},i=new f(a,b),j=this.bucketsInOrder,k=j.length-1;k>=0;k--){var l=j[k];"symbol"===l.type&&(l.placeFeatures(i,d,c),h[l.id]=l.elementGroups)}for(var m in d)e.push(d[m].array);return{result:{elementGroups:h,buffers:d},transferables:e}}},{"../data/buffer/buffer_set":2,"../data/create_bucket":13,"../data/feature_tree":15,"../symbol/collision_tile":68}],51:[function(a,b,c){function d(){this.n=0,this.times=[]}b.exports=d,d.prototype.stopped=function(){return this.times=this.times.filter(function(a){return a.time>=(new Date).getTime()}),!this.times.length},d.prototype.set=function(a){return this.times.push({id:this.n,time:a+(new Date).getTime()}),this.n++},d.prototype.cancel=function(a){this.times=this.times.filter(function(b){return b.id!==a})}},{}],52:[function(a,b,c){function d(a){this.base=a,this.retina=h.devicePixelRatio>1;var b=this.retina?"@2x":"";g.getJSON(i(a,b,".json"),function(a,b){return a?void this.fire("error",{error:a}):(this.data=b,void(this.img&&this.fire("load")))}.bind(this)),g.getImage(i(a,b,".png"),function(a,b){if(a)return void this.fire("error",{error:a});for(var c=b.getData(),d=b.data=new Uint8Array(c.length),e=0;e<c.length;e+=4){var f=c[e+3]/255;d[e+0]=c[e+0]*f,d[e+1]=c[e+1]*f,d[e+2]=c[e+2]*f,d[e+3]=c[e+3]}this.img=b,this.data&&this.fire("load")}.bind(this))}function e(){}var f=a("../util/evented"),g=a("../util/ajax"),h=a("../util/browser"),i=a("../util/mapbox").normalizeSpriteURL;b.exports=d,d.prototype=Object.create(f),d.prototype.toJSON=function(){return this.base},d.prototype.loaded=function(){return!(!this.data||!this.img)},d.prototype.resize=function(){if(h.devicePixelRatio>1!==this.retina){var a=new d(this.base);a.on("load",function(){this.img=a.img,this.data=a.data,this.retina=a.retina}.bind(this))}},e.prototype={x:0,y:0,width:0,height:0,pixelRatio:1,sdf:!1},d.prototype.getSpritePosition=function(a){if(!this.loaded())return new e;var b=this.data&&this.data[a];return b&&this.img?b:new e}},{"../util/ajax":94,"../util/browser":95,"../util/evented":100,"../util/mapbox":103}],53:[function(a,b,c){var d=a("./reference");b.exports={},d.layout.forEach(function(a){var c=function(a){for(var b in a)this[b]=a[b]},e=d[a];for(var f in e)void 0!==e[f].default&&(c.prototype[f]=e[f].default);b.exports[a.replace("layout_","")]=c})},{"./reference":55}],54:[function(a,b,c){var d=a("./reference"),e=a("csscolorparser").parseCSSColor;b.exports={},d.paint.forEach(function(a){var c=function(){},f=d[a];for(var g in f){var h=f[g],i=h.default;void 0!==i&&("color"===h.type&&(i=e(i)),c.prototype[g]=i)}c.prototype.hidden=!1,b.exports[a.replace("paint_","")]=c})},{"./reference":55,csscolorparser:107}],55:[function(a,b,c){b.exports=a("mapbox-gl-style-spec/reference/latest")},{"mapbox-gl-style-spec/reference/latest":131}],56:[function(a,b,c){function d(a,b){this.animationLoop=b||new r,this.dispatcher=new q(Math.max(p.hardwareConcurrency-1,1),this),this.glyphAtlas=new j(1024,1024),this.spriteAtlas=new k(512,512),this.spriteAtlas.resize(p.devicePixelRatio),this.lineAtlas=new l(256,512),this._layers={},this._order=[],this._groups=[],this.sources={},this.zoomHistory={},m.bindAll(["_forwardSourceEvent","_forwardTileEvent","_redoPlacement"],this);var c=function(a,b){if(a)return void this.fire("error",{error:a});var c=s(b);if(c.length)for(var d=0;d<c.length;d++)this.fire("error",{error:new Error(c[d].message)});else{this._loaded=!0,this.stylesheet=b;var e=b.sources;for(var f in e)this.addSource(f,e[f]);b.sprite&&(this.sprite=new h(b.sprite),this.sprite.on("load",this.fire.bind(this,"change"))),this.glyphSource=new i(b.glyphs,this.glyphAtlas),this._resolve(),this.fire("load")}}.bind(this);"string"==typeof a?n.getJSON(o(a),c):p.frame(c.bind(this,null,a))}var e=a("../util/evented"),f=a("./style_batch"),g=a("./style_layer"),h=a("./image_sprite"),i=a("../symbol/glyph_source"),j=a("../symbol/glyph_atlas"),k=a("../symbol/sprite_atlas"),l=a("../render/line_atlas"),m=a("../util/util"),n=a("../util/ajax"),o=a("../util/mapbox").normalizeStyleURL,p=a("../util/browser"),q=a("../util/dispatcher"),r=a("./animation_loop"),s=a("mapbox-gl-style-spec/lib/validate/latest");b.exports=d,d.prototype=m.inherit(e,{_loaded:!1,loaded:function(){if(!this._loaded)return!1;for(var a in this.sources)if(!this.sources[a].loaded())return!1;return!(this.sprite&&!this.sprite.loaded())},_resolve:function(){var a,b;this._layers={},this._order=[];for(var c=0;c<this.stylesheet.layers.length;c++)b=new g(this.stylesheet.layers[c]),this._layers[b.id]=b,this._order.push(b.id);for(a in this._layers)this._layers[a].resolveLayout();for(a in this._layers)this._layers[a].resolveReference(this._layers),this._layers[a].resolvePaint();this._groupLayers(),this._broadcastLayers()},_groupLayers:function(){var a;this._groups=[];for(var b=0;b<this._order.length;++b){var c=this._layers[this._order[b]];a&&c.source===a.source||(a=[],a.source=c.source,this._groups.push(a)),a.push(c)}},_broadcastLayers:function(){var a=[];for(var b in this._layers)a.push(this._layers[b].json());this.dispatcher.broadcast("set layers",a)},_cascade:function(a,b){if(this._loaded){b=b||{transition:!0};for(var c in this._layers)this._layers[c].cascade(a,b,this.stylesheet.transition||{},this.animationLoop);this.fire("change")}},_recalculate:function(a){for(var b in this.sources)this.sources[b].used=!1;this._updateZoomHistory(a),this.rasterFadeDuration=300;for(b in this._layers){var c=this._layers[b];c.recalculate(a,this.zoomHistory)&&c.source&&(this.sources[c.source].used=!0)}var d=300;Math.floor(this.z)!==Math.floor(a)&&this.animationLoop.set(d),this.z=a,this.fire("zoom")},_updateZoomHistory:function(a){var b=this.zoomHistory;void 0===b.lastIntegerZoom&&(b.lastIntegerZoom=Math.floor(a),b.lastIntegerZoomTime=0,b.lastZoom=a),Math.floor(b.lastZoom)<Math.floor(a)?(b.lastIntegerZoom=Math.floor(a),b.lastIntegerZoomTime=Date.now()):Math.floor(b.lastZoom)>Math.floor(a)&&(b.lastIntegerZoom=Math.floor(a+1),b.lastIntegerZoomTime=Date.now()),b.lastZoom=a},batch:function(a){f(this,a)},addSource:function(a,b){return this.batch(function(c){c.addSource(a,b)}),this},removeSource:function(a){return this.batch(function(b){b.removeSource(a)}),this},getSource:function(a){return this.sources[a]},addLayer:function(a,b){return this.batch(function(c){c.addLayer(a,b)}),this},removeLayer:function(a){return this.batch(function(b){b.removeLayer(a)}),this},getLayer:function(a){return this._layers[a]},getReferentLayer:function(a){var b=this.getLayer(a);return b.ref&&(b=this.getLayer(b.ref)),b},setFilter:function(a,b){return this.batch(function(c){c.setFilter(a,b)}),this},setLayerZoomRange:function(a,b,c){return this.batch(function(d){d.setLayerZoomRange(a,b,c)}),this},getFilter:function(a){return this.getReferentLayer(a).filter},getLayoutProperty:function(a,b){return this.getReferentLayer(a).getLayoutProperty(b)},getPaintProperty:function(a,b,c){return this.getLayer(a).getPaintProperty(b,c)},featuresAt:function(a,b,c){var d=[],e=null;b.layer&&(b.layerIds=Array.isArray(b.layer)?b.layer:[b.layer]),m.asyncEach(Object.keys(this.sources),function(c,f){var g=this.sources[c];g.featuresAt(a,b,function(a,b){b&&(d=d.concat(b)),a&&(e=a),f()})}.bind(this),function(){return e?c(e):void c(null,d.filter(function(a){return void 0!==this._layers[a.layer]}.bind(this)).map(function(a){return a.layer=this._layers[a.layer].json(),a}.bind(this)))}.bind(this))},featuresIn:function(a,b,c){var d=[],e=null;b.layer&&(b.layer={id:b.layer}),m.asyncEach(Object.keys(this.sources),function(c,f){var g=this.sources[c];g.featuresIn(a,b,function(a,b){b&&(d=d.concat(b)),a&&(e=a),f()})}.bind(this),function(){return e?c(e):void c(null,d.filter(function(a){return void 0!==this._layers[a.layer]}.bind(this)).map(function(a){return a.layer=this._layers[a.layer].json(),a}.bind(this)))}.bind(this))},_remove:function(){this.dispatcher.remove()},_reloadSource:function(a){this.sources[a].reload()},_updateSources:function(a){for(var b in this.sources)this.sources[b].update(a)},_redoPlacement:function(){for(var a in this.sources)this.sources[a].redoPlacement&&this.sources[a].redoPlacement()},_forwardSourceEvent:function(a){this.fire("source."+a.type,m.extend({source:a.target},a))},_forwardTileEvent:function(a){this.fire(a.type,m.extend({source:a.target},a))},"get sprite json":function(a,b){var c=this.sprite;c.loaded()?b(null,{sprite:c.data,retina:c.retina}):c.on("load",function(){b(null,{sprite:c.data,retina:c.retina})})},"get icons":function(a,b){var c=this.sprite,d=this.spriteAtlas;c.loaded()?(d.setSprite(c),d.addIcons(a.icons,b)):c.on("load",function(){d.setSprite(c),d.addIcons(a.icons,b)})},"get glyphs":function(a,b){this.glyphSource.getSimpleGlyphs(a.fontstack,a.codepoints,a.uid,b)}})},{"../render/line_atlas":36,"../symbol/glyph_atlas":70,"../symbol/glyph_source":71,"../symbol/sprite_atlas":77,"../util/ajax":94,"../util/browser":95,"../util/dispatcher":97,"../util/evented":100,"../util/mapbox":103,"../util/util":106,"./animation_loop":51,"./image_sprite":52,"./style_batch":57,"./style_layer":60,"mapbox-gl-style-spec/lib/validate/latest":129}],57:[function(a,b,c){function d(a,b){if(!a._loaded)throw new Error("Style is not done loading");var c=Object.create(d.prototype);c._style=a,c._groupLayers=!1,c._broadcastLayers=!1,c._reloadSources={},c._events=[],c._change=!1,b(c),c._groupLayers&&c._style._groupLayers(),c._broadcastLayers&&c._style._broadcastLayers(),Object.keys(c._reloadSources).forEach(function(a){c._style._reloadSource(a)}),c._events.forEach(function(a){c._style.fire.apply(c._style,a)}),c._change&&c._style.fire("change")}var e=a("../source/source"),f=a("./style_layer");d.prototype={addLayer:function(a,b){if(void 0!==this._style._layers[a.id])throw new Error("There is already a layer with this ID");return a instanceof f||(a=new f(a)),this._style._layers[a.id]=a,this._style._order.splice(b?this._style._order.indexOf(b):1/0,0,a.id),a.resolveLayout(),a.resolveReference(this._style._layers),a.resolvePaint(),this._groupLayers=!0,this._broadcastLayers=!0,a.source&&(this._reloadSources[a.source]=!0),this._events.push(["layer.add",{layer:a}]),this._change=!0,this},removeLayer:function(a){var b=this._style._layers[a];if(void 0===b)throw new Error("There is no layer with this ID");for(var c in this._style._layers)this._style._layers[c].ref===a&&this.removeLayer(c);return delete this._style._layers[a],this._style._order.splice(this._style._order.indexOf(a),1),this._groupLayers=!0,this._broadcastLayers=!0,this._events.push(["layer.remove",{layer:b}]),this._change=!0,this},setPaintProperty:function(a,b,c,d){return this._style.getLayer(a).setPaintProperty(b,c,d),this._change=!0,this},setLayoutProperty:function(a,b,c){return a=this._style.getReferentLayer(a),a.setLayoutProperty(b,c),this._broadcastLayers=!0,a.source&&(this._reloadSources[a.source]=!0),this._change=!0,this},setFilter:function(a,b){return a=this._style.getReferentLayer(a),a.filter=b,this._broadcastLayers=!0,a.source&&(this._reloadSources[a.source]=!0),this._change=!0,this},setLayerZoomRange:function(a,b,c){var d=this._style.getReferentLayer(a);return null!=b&&(d.minzoom=b),null!=c&&(d.maxzoom=c),this._broadcastLayers=!0,d.source&&(this._reloadSources[d.source]=!0),this._change=!0,this},addSource:function(a,b){if(!this._style._loaded)throw new Error("Style is not done loading");if(void 0!==this._style.sources[a])throw new Error("There is already a source with this ID");return b=e.create(b),this._style.sources[a]=b,b.id=a,b.style=this._style,b.dispatcher=this._style.dispatcher,b.glyphAtlas=this._style.glyphAtlas,b.on("load",this._style._forwardSourceEvent).on("error",this._style._forwardSourceEvent).on("change",this._style._forwardSourceEvent).on("tile.add",this._style._forwardTileEvent).on("tile.load",this._style._forwardTileEvent).on("tile.error",this._style._forwardTileEvent).on("tile.remove",this._style._forwardTileEvent).on("tile.stats",this._style._forwardTileEvent),this._events.push(["source.add",{source:b}]),this._change=!0,this},removeSource:function(a){if(void 0===this._style.sources[a])throw new Error("There is no source with this ID");var b=this._style.sources[a];return delete this._style.sources[a],b.off("load",this._style._forwardSourceEvent).off("error",this._style._forwardSourceEvent).off("change",this._style._forwardSourceEvent).off("tile.add",this._style._forwardTileEvent).off("tile.load",this._style._forwardTileEvent).off("tile.error",this._style._forwardTileEvent).off("tile.remove",this._style._forwardTileEvent).off("tile.stats",this._style._forwardTileEvent),this._events.push(["source.remove",{source:b}]),this._change=!0,this}},b.exports=d},{"../source/source":43,"./style_layer":60}],58:[function(a,b,c){function d(a,b){this.type=a.type,this.transitionable=a.transition,null==b&&(b=a.default),this.json=JSON.stringify(b),"color"===this.type?this.value=f(b):this.value=b,"interpolated"===a.function?this.calculate=i.interpolated(this.value):(this.calculate=i["piecewise-constant"](this.value),a.transition&&(this.calculate=e(this.calculate)))}function e(a){return function(b,c,d){var e,f,g,h=b%1,i=Math.min((Date.now()-c.lastIntegerZoomTime)/d,1),j=1,k=1;return b>c.lastIntegerZoom?(e=h+(1-h)*i,j*=2,f=a(b-1),g=a(b)):(e=1-(1-i)*h,g=a(b),f=a(b+1),j/=2),{from:f,fromScale:j,to:g,toScale:k,t:e}}}function f(a){if(k[a])return k[a];if(Array.isArray(a))return a;if(a.stops)return j.extend({},a,{stops:a.stops.map(function(a){return[a[0],f(a[1])]})});if("string"==typeof a){var b=g(h(a));return k[a]=b,b}throw new Error("Invalid color "+a)}function g(a){return[a[0]/255,a[1]/255,a[2]/255,a[3]/1]}var h=a("csscolorparser").parseCSSColor,i=a("mapbox-gl-function"),j=a("../util/util");b.exports=d;var k={}},{"../util/util":106,csscolorparser:107,"mapbox-gl-function":128}],59:[function(a,b,c){function d(a){function b(a){this._values={},this._transitions={};for(var b in a)this[b]=a[b]}return Object.keys(a).forEach(function(c){var d=a[c];Object.defineProperty(b.prototype,c,{set:function(a){this._values[c]=new g(d,a)},get:function(){return this._values[c].value}}),d.transition&&Object.defineProperty(b.prototype,c+"-transition",{set:function(a){this._transitions[c]=a},get:function(){return this._transitions[c]}})}),b.prototype.values=function(){return this._values},b.prototype.transition=function(a,b){var c=this._transitions[a]||{};return{duration:e.coalesce(c.duration,b.duration,300),delay:e.coalesce(c.delay,b.delay,0)}},b.prototype.json=function(){var a={};for(var b in this._values)a[b]=this._values[b].value;for(var c in this._transitions)a[c+"-transition"]=this._transitions[b];return a},b}var e=a("../util/util"),f=a("./reference"),g=a("./style_declaration"),h={paint:{},layout:{}};f.layer.type.values.forEach(function(a){h.paint[a]=d(f["paint_"+a]),h.layout[a]=d(f["layout_"+a])}),b.exports=function(a,b,c){return new h[a][b](c)}},{"../util/util":106,"./reference":55,"./style_declaration":58}],60:[function(a,b,c){function d(a){this._layer=a,this.id=a.id,
this.ref=a.ref,this._resolved={},this._cascaded={},this.assign(a)}function e(a,b){var c=b+"-color",d=b+"-halo-color",e=b+"-outline-color",g=a[c],h=a[d],i=a[e],j=a[b+"-opacity"],k=g&&j*g[3],l=h&&j*h[3],m=i&&j*i[3];void 0!==k&&1>k&&(a[c]=f.premultiply([g[0],g[1],g[2],k])),void 0!==l&&1>l&&(a[d]=f.premultiply([h[0],h[1],h[2],l])),void 0!==m&&1>m&&(a[e]=f.premultiply([i[0],i[1],i[2],m]))}var f=a("../util/util"),g=a("./style_transition"),h=a("./style_declaration_set"),i=a("./layout_properties"),j=a("./paint_properties");b.exports=d,d.prototype={resolveLayout:function(){this.ref||(this.layout=new i[this.type](this._layer.layout),"line"===this.layout["symbol-placement"]&&(this.layout.hasOwnProperty("text-rotation-alignment")||(this.layout["text-rotation-alignment"]="map"),this.layout.hasOwnProperty("icon-rotation-alignment")||(this.layout["icon-rotation-alignment"]="map"),this.layout["symbol-avoid-edges"]=!0))},setLayoutProperty:function(a,b){null==b?delete this.layout[a]:this.layout[a]=b},getLayoutProperty:function(a){return this.layout[a]},resolveReference:function(a){this.ref&&this.assign(a[this.ref])},resolvePaint:function(){for(var a in this._layer){var b=a.match(/^paint(?:\.(.*))?$/);b&&(this._resolved[b[1]||""]=new h("paint",this.type,this._layer[a]))}},setPaintProperty:function(a,b,c){var d=this._resolved[c||""];d||(d=this._resolved[c||""]=new h("paint",this.type,{})),d[a]=b},getPaintProperty:function(a,b){var c=this._resolved[b||""];if(c)return c[a]},cascade:function(a,b,c,d){for(var e in this._resolved)if(""===e||a[e]){var f=this._resolved[e],i=f.values();for(var j in i){var k=i[j],l=b.transition?this._cascaded[j]:void 0;if(!l||l.declaration.json!==k.json){var m=f.transition(j,c),n=this._cascaded[j]=new g(k,l,m);n.instant()||(n.loopID=d.set(n.endTime-(new Date).getTime())),l&&d.cancel(l.loopID)}}}if("symbol"===this.type){var o=new h("layout",this.type,this.layout);this._cascaded["text-size"]=new g(o.values()["text-size"],void 0,c),this._cascaded["icon-size"]=new g(o.values()["icon-size"],void 0,c)}},recalculate:function(a,b){var c=this.type,d=this.paint=new j[c];for(var f in this._cascaded)d[f]=this._cascaded[f].at(a,b);if(this.hidden=this.minzoom&&a<this.minzoom||this.maxzoom&&a>=this.maxzoom||"none"===this.layout.visibility,"symbol"===c?0!==d["text-opacity"]&&this.layout["text-field"]||0!==d["icon-opacity"]&&this.layout["icon-image"]?(e(d,"text"),e(d,"icon")):this.hidden=!0:0===d[c+"-opacity"]?this.hidden=!0:e(d,c),this._cascaded["line-dasharray"]){var g=d["line-dasharray"],h=this._cascaded["line-width"]?this._cascaded["line-width"].at(Math.floor(a),1/0):d["line-width"];g.fromScale*=h,g.toScale*=h}return!this.hidden},assign:function(a){f.extend(this,f.pick(a,["type","source","source-layer","minzoom","maxzoom","filter","layout"]))},json:function(){return f.extend({},this._layer,f.pick(this,["type","source","source-layer","minzoom","maxzoom","filter","layout","paint"]))}}},{"../util/util":106,"./layout_properties":53,"./paint_properties":54,"./style_declaration_set":59,"./style_transition":61}],61:[function(a,b,c){function d(a,b,c){this.declaration=a,this.startTime=this.endTime=(new Date).getTime();var d=a.type;"string"!==d&&"array"!==d||!a.transitionable?this.interp=g[d]:this.interp=e,this.oldTransition=b,this.duration=c.duration||0,this.delay=c.delay||0,this.instant()||(this.endTime=this.startTime+this.duration+this.delay,this.ease=f.easeCubicInOut),b&&b.endTime<=this.startTime&&delete b.oldTransition}function e(a,b,c){return{from:a.to,fromScale:a.toScale,to:b.to,toScale:b.toScale,t:c}}var f=a("../util/util"),g=a("../util/interpolate");b.exports=d,d.prototype.instant=function(){return!this.oldTransition||!this.interp||0===this.duration&&0===this.delay},d.prototype.at=function(a,b,c){var d=this.declaration.calculate(a,b,this.duration);if(this.instant())return d;if(c=c||Date.now(),c<this.endTime){var e=this.oldTransition.at(a,b,this.startTime),f=this.ease((c-this.startTime-this.delay)/this.duration);d=this.interp(e,d,f)}return d}},{"../util/interpolate":102,"../util/util":106}],62:[function(a,b,c){function d(a,b,c,d){this.x=a,this.y=b,this.angle=c,void 0!==d&&(this.segment=d)}var e=a("point-geometry");b.exports=d,d.prototype=Object.create(e.prototype),d.prototype.clone=function(){return new d(this.x,this.y,this.angle,this.segment)}},{"point-geometry":137}],63:[function(a,b,c){function d(a,b){this.width=a,this.height=b,this.free=[{x:0,y:0,w:a,h:b}]}b.exports=d,d.prototype.release=function(a){for(var b=0;b<this.free.length;b++){var c=this.free[b];if(c.y===a.y&&c.h===a.h&&c.x+c.w===a.x)c.w+=a.w;else if(c.x===a.x&&c.w===a.w&&c.y+c.h===a.y)c.h+=a.h;else if(a.y===c.y&&a.h===c.h&&a.x+a.w===c.x)c.x=a.x,c.w+=a.w;else{if(a.x!==c.x||a.w!==c.w||a.y+a.h!==c.y)continue;c.y=a.y,c.h+=a.h}return this.free.splice(b,1),void this.release(c)}this.free.push(a)},d.prototype.allocate=function(a,b){for(var c={x:1/0,y:1/0,w:1/0,h:1/0},d=-1,e=0;e<this.free.length;e++){var f=this.free[e];a<=f.w&&b<=f.h&&f.y<=c.y&&f.x<=c.x&&(c=f,d=e)}return 0>d?{x:-1,y:-1}:(this.free.splice(d,1),c.w<c.h?(c.w>a&&this.free.push({x:c.x+a,y:c.y,w:c.w-a,h:b}),c.h>b&&this.free.push({x:c.x,y:c.y+b,w:c.w,h:c.h-b})):(c.w>a&&this.free.push({x:c.x+a,y:c.y,w:c.w-a,h:c.h}),c.h>b&&this.free.push({x:c.x,y:c.y+b,w:a,h:c.h-b})),{x:c.x,y:c.y,w:a,h:b})}},{}],64:[function(a,b,c){function d(a,b,c,d,e){if(void 0===b.segment)return!0;for(var f=b,g=b.segment+1,h=0;h>-c/2;){if(g--,0>g)return!1;h-=a[g].dist(f),f=a[g]}h+=a[g].dist(a[g+1]),g++;for(var i=[],j=0;c/2>h;){var k=a[g-1],l=a[g],m=a[g+1];if(!m)return!1;var n=k.angleTo(l)-l.angleTo(m);for(n=(n+3*Math.PI)%(2*Math.PI)-Math.PI,i.push({distance:h,angleDelta:n}),j+=n;h-i[0].distance>d;)j-=i.shift().angleDelta;if(Math.abs(j)>e)return!1;g++,h+=l.dist(m)}return!0}b.exports=d},{}],65:[function(a,b,c){function d(a,b,c,d,f){for(var g=[],h=0;h<a.length;h++)for(var i,j=a[h],k=0;k<j.length-1;k++){var l=j[k],m=j[k+1];l.x<b&&m.x<b||(l.x<b?l=new e(b,l.y+(m.y-l.y)*((b-l.x)/(m.x-l.x))):m.x<b&&(m=new e(b,l.y+(m.y-l.y)*((b-l.x)/(m.x-l.x)))),l.y<c&&m.y<c||(l.y<c?l=new e(l.x+(m.x-l.x)*((c-l.y)/(m.y-l.y)),c):m.y<c&&(m=new e(l.x+(m.x-l.x)*((c-l.y)/(m.y-l.y)),c)),l.x>=d&&m.x>=d||(l.x>=d?l=new e(d,l.y+(m.y-l.y)*((d-l.x)/(m.x-l.x))):m.x>=d&&(m=new e(d,l.y+(m.y-l.y)*((d-l.x)/(m.x-l.x)))),l.y>=f&&m.y>=f||(l.y>=f?l=new e(l.x+(m.x-l.x)*((f-l.y)/(m.y-l.y)),f):m.y>=f&&(m=new e(l.x+(m.x-l.x)*((f-l.y)/(m.y-l.y)),f)),i&&l.equals(i[i.length-1])||(i=[l],g.push(i)),i.push(m)))))}return g}var e=a("point-geometry");b.exports=d},{"point-geometry":137}],66:[function(a,b,c){function d(a,b,c,d,e,f){this.anchorPoint=a,this.x1=b,this.y1=c,this.x2=d,this.y2=e,this.maxScale=f,this.placementScale=0,this[0]=this[1]=this[2]=this[3]=0}b.exports=d},{}],67:[function(a,b,c){function d(a,b,c,d,g,h){var i=c.top*d-g,j=c.bottom*d+g,k=c.left*d-g,l=c.right*d+g;if(this.boxes=[],h){var m=j-i,n=l-k;if(0>=m)return;m=Math.max(10*d,m),this._addLineCollisionBoxes(a,b,n,m)}else this.boxes.push(new e(new f(b.x,b.y),k,i,l,j,1/0))}var e=a("./collision_box"),f=a("point-geometry");b.exports=d,d.prototype._addLineCollisionBoxes=function(a,b,c,d){var f=d/2,g=Math.floor(c/f),h=-d/2,i=this.boxes,j=b,k=b.segment+1,l=h;do{if(k--,0>k)return i;l-=a[k].dist(j),j=a[k]}while(l>-c/2);for(var m=a[k].dist(a[k+1]),n=0;g>n;n++){for(var o=-c/2+n*f;o>l+m;){if(l+=m,k++,k+1>=a.length)return i;m=a[k].dist(a[k+1])}var p=o-l,q=a[k],r=a[k+1],s=r.sub(q)._unit()._mult(p)._add(q),t=Math.max(Math.abs(o-h)-f/2,0),u=c/2/t;i.push(new e(s,-d/2,-d/2,d/2,d/2,u))}return i}},{"./collision_box":66,"point-geometry":137}],68:[function(a,b,c){function d(a,b){this.tree=e(),this.angle=a;var c=Math.sin(a),d=Math.cos(a);this.rotationMatrix=[d,-c,c,d],this.yStretch=1/Math.cos(b/180*Math.PI),this.yStretch=Math.pow(this.yStretch,1.3)}var e=a("rbush");b.exports=d,d.prototype.minScale=.25,d.prototype.maxScale=2,d.prototype.placeCollisionFeature=function(a){for(var b=this.minScale,c=this.rotationMatrix,d=this.yStretch,e=0;e<a.boxes.length;e++){var f=a.boxes[e],g=f.anchorPoint.matMult(c),h=g.x,i=g.y;f[0]=h+f.x1,f[1]=i+f.y1*d,f[2]=h+f.x2,f[3]=i+f.y2*d;for(var j=this.tree.search(f),k=0;k<j.length;k++){var l=j[k],m=l.anchorPoint.matMult(c),n=(l.x1-f.x2)/(h-m.x),o=(l.x2-f.x1)/(h-m.x),p=(l.y1-f.y2)*d/(i-m.y),q=(l.y2-f.y1)*d/(i-m.y);(isNaN(n)||isNaN(o))&&(n=o=1),(isNaN(p)||isNaN(q))&&(p=q=1);var r=Math.min(Math.max(n,o),Math.max(p,q));if(r>l.maxScale&&(r=l.maxScale),r>f.maxScale&&(r=f.maxScale),r>b&&r>=l.placementScale&&(b=r),b>=this.maxScale)return b}}return b},d.prototype.insertCollisionFeature=function(a,b){for(var c=a.boxes,d=0;d<c.length;d++)c[d].placementScale=b;b<this.maxScale&&this.tree.load(c)}},{rbush:139}],69:[function(a,b,c){function d(a,b,c,d,f,g,h,i){var j=d?.6*g*h:0,k=Math.max(d?d.right-d.left:0,f?f.right-f.left:0);if(0===a[0].x||4096===a[0].x||0===a[0].y||4096===a[0].y)var l=!0;b/4>b-k*h&&(b=k*h+b/4);var m=2*g,n=l?b/2*i%b:(k/2+m)*h*i%b;return e(a,n,b,j,c,k*h,l,!1)}function e(a,b,c,d,i,j,k,l){for(var m=0,n=b-c,o=[],p=0;p<a.length-1;p++){for(var q=a[p],r=a[p+1],s=q.dist(r),t=r.angleTo(q);m+s>n+c;){n+=c;var u=(n-m)/s,v=f(q.x,r.x,u),w=f(q.y,r.y,u);if(v>=0&&4096>v&&w>=0&&4096>w){v=Math.round(v),w=Math.round(w);var x=new g(v,w,t,p);(!d||h(a,x,j,d,i))&&o.push(x)}}m+=s}return l||o.length||k||(o=e(a,m/2,c,d,i,j,k,!0)),o}var f=a("../util/interpolate"),g=a("../symbol/anchor"),h=a("./check_max_angle");b.exports=d},{"../symbol/anchor":62,"../util/interpolate":102,"./check_max_angle":64}],70:[function(a,b,c){function d(a,b){this.width=a,this.height=b,this.bin=new e(a,b),this.index={},this.ids={},this.data=new Uint8Array(a*b)}var e=a("./bin_pack");b.exports=d,d.prototype={get debug(){return"canvas"in this},set debug(a){a&&!this.canvas?(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,document.body.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d")):!a&&this.canvas&&(this.canvas.parentNode.removeChild(this.canvas),delete this.ctx,delete this.canvas)}},d.prototype.getGlyphs=function(){var a,b,c,d={};for(var e in this.ids)a=e.split("#"),b=a[0],c=a[1],d[b]||(d[b]=[]),d[b].push(c);return d},d.prototype.getRects=function(){var a,b,c,d={};for(var e in this.ids)a=e.split("#"),b=a[0],c=a[1],d[b]||(d[b]={}),d[b][c]=this.index[e];return d},d.prototype.removeGlyphs=function(a){for(var b in this.ids){var c=this.ids[b],d=c.indexOf(a);if(d>=0&&c.splice(d,1),this.ids[b]=c,!c.length){for(var e=this.index[b],f=this.data,g=0;g<e.h;g++)for(var h=this.width*(e.y+g)+e.x,i=0;i<e.w;i++)f[h+i]=0;this.dirty=!0,this.bin.release(e),delete this.index[b],delete this.ids[b]}}this.updateTexture(this.gl)},d.prototype.addGlyph=function(a,b,c,d){if(!c)return null;var e=b+"#"+c.id;if(this.index[e])return this.ids[e].indexOf(a)<0&&this.ids[e].push(a),this.index[e];if(!c.bitmap)return null;var f=c.width+2*d,g=c.height+2*d,h=1,i=f+2*h,j=g+2*h;i+=4-i%4,j+=4-j%4;var k=this.bin.allocate(i,j);if(k.x<0)return console.warn("glyph bitmap overflow"),{glyph:c,rect:null};this.index[e]=k,this.ids[e]=[a];for(var l=this.data,m=c.bitmap,n=0;g>n;n++)for(var o=this.width*(k.y+n+h)+k.x+h,p=f*n,q=0;f>q;q++)l[o+q]=m[p+q];return this.dirty=!0,k},d.prototype.bind=function(a){this.gl=a,this.texture?a.bindTexture(a.TEXTURE_2D,this.texture):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,null))},d.prototype.updateTexture=function(a){if(this.bind(a),this.dirty){if(a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data),this.ctx){for(var b=this.ctx.getImageData(0,0,this.width,this.height),c=0,d=0;c<this.data.length;c++,d+=4)b.data[d]=this.data[c],b.data[d+1]=this.data[c],b.data[d+2]=this.data[c],b.data[d+3]=255;this.ctx.putImageData(b,0,0),this.ctx.strokeStyle="red";for(var e=0;e<this.bin.free.length;e++){var f=this.bin.free[e];this.ctx.strokeRect(f.x,f.y,f.w,f.h)}}this.dirty=!1}}},{"./bin_pack":63}],71:[function(a,b,c){function d(a,b){this.url=a&&g(a),this.glyphAtlas=b,this.stacks=[],this.loading={}}function e(a,b,c){var d=1;this.advance=a.advance,this.left=a.left-c-d,this.top=a.top+c+d,this.rect=b}function f(a,b,c,d){return d=d||"abc",c.replace("{s}",d[a.length%d.length]).replace("{fontstack}",a).replace("{range}",b)}var g=a("../util/mapbox").normalizeGlyphsURL,h=a("../util/ajax").getArrayBuffer,i=a("../util/glyphs"),j=a("pbf");b.exports=d,d.prototype.getSimpleGlyphs=function(a,b,c,d){void 0===this.stacks[a]&&(this.stacks[a]={});for(var f,g={},h=this.stacks[a],i=this.glyphAtlas,j=3,k={},l=0,m=0;m<b.length;m++){var n=b[m];if(f=Math.floor(n/256),h[f]){var o=h[f].glyphs[n],p=i.addGlyph(c,a,o,j);o&&(g[n]=new e(o,p,j))}else void 0===k[f]&&(k[f]=[],l++),k[f].push(n)}l||d(void 0,g);var q=function(b,f,h){if(!b)for(var m=this.stacks[a][f]=h.stacks[0],n=0;n<k[f].length;n++){var o=k[f][n],p=m.glyphs[o],q=i.addGlyph(c,a,p,j);p&&(g[o]=new e(p,q,j))}l--,l||d(void 0,g)}.bind(this);for(var r in k)this.loadRange(a,r,q)},d.prototype.loadRange=function(a,b,c){if(256*b>65535)return c("gyphs > 65535 not supported");void 0===this.loading[a]&&(this.loading[a]={});var d=this.loading[a];if(d[b])d[b].push(c);else{d[b]=[c];var e=256*b+"-"+(256*b+255),g=f(a,e,this.url);h(g,function(a,c){for(var e=!a&&new i(new j(new Uint8Array(c))),f=0;f<d[b].length;f++)d[b][f](a,b,e);delete d[b]})}}},{"../util/ajax":94,"../util/glyphs":101,"../util/mapbox":103,pbf:136}],72:[function(a,b,c){b.exports=function(a,b,c){function d(d){k.push(a[d]),l.push(c[d]),m.push(b[d]),n++}function e(a,b,c){var d=j[a];return delete j[a],j[b]=d,l[d][0].pop(),l[d][0]=l[d][0].concat(c[0]),d}function f(a,b,c){var d=i[b];return delete i[b],i[a]=d,l[d][0].shift(),l[d][0]=c[0].concat(l[d][0]),d}function g(a,b,c){var d=c?b[0][b[0].length-1]:b[0][0];return a+":"+d.x+":"+d.y}var h,i={},j={},k=[],l=[],m=[],n=0;for(h=0;h<a.length;h++){var o=c[h],p=b[h];if(o)if(p){var q=g(p,o),r=g(p,o,!0);if(q in j&&r in i&&j[q]!==i[r]){var s=f(q,r,o),t=e(q,r,l[s]);delete i[q],delete j[r],j[g(p,l[t],!0)]=t,l[s]=null}else q in j?e(q,r,o):r in i?f(q,r,o):(d(h),i[q]=n-1,j[r]=n-1)}else d(h)}return{features:k,textFeatures:m,geometries:l}}},{}],73:[function(a,b,c){function d(a,b,c,d,e,f,g,h,i){this.anchorPoint=a,this.tl=b,this.tr=c,this.bl=d,this.br=e,this.tex=f,this.angle=g,this.minScale=h,this.maxScale=i}function e(a,b,c,e,f,g){var j=b.image.rect,k=1,l=b.left-k,m=l+j.w,n=b.top-k,o=n+j.h,p=new h(l,n),q=new h(m,n),r=new h(m,o),s=new h(l,o),t=f["icon-rotate"]*Math.PI/180;if(g){var u=e[a.segment];t+=Math.atan2(a.y-u.y,a.x-u.x)}if(t){var v=Math.sin(t),w=Math.cos(t),x=[w,-v,v,w];p=p.matMult(x),q=q.matMult(x),s=s.matMult(x),r=r.matMult(x)}return[new d(new h(a.x,a.y),p,q,s,r,b.image.rect,0,i,1/0)]}function f(a,b,c,e,f,j){for(var k=f["text-rotate"]*Math.PI/180,l=f["text-keep-upright"],m=b.positionedGlyphs,n=[],o=0;o<m.length;o++){var p=m[o],q=p.glyph,r=q.rect;if(r){var s,t=(p.x+q.advance/2)*c,u=i;j?(s=[],u=g(s,a,t,e,a.segment,!0),l&&(u=Math.min(u,g(s,a,t,e,a.segment,!1)))):s=[{anchorPoint:new h(a.x,a.y),offset:0,angle:0,maxScale:1/0,minScale:i}];for(var v=p.x+q.left,w=p.y-q.top,x=v+r.w,y=w+r.h,z=new h(v,w),A=new h(x,w),B=new h(v,y),C=new h(x,y),D=0;D<s.length;D++){var E=s[D],F=z,G=A,H=B,I=C,J=E.angle+k;if(J){var K=Math.sin(J),L=Math.cos(J),M=[L,-K,K,L];F=F.matMult(M),G=G.matMult(M),H=H.matMult(M),I=I.matMult(M)}var N=Math.max(E.minScale,u),O=(a.angle+k+E.offset+2*Math.PI)%(2*Math.PI);n.push(new d(E.anchorPoint,F,G,H,I,r,O,N,E.maxScale))}}}return n}function g(a,b,c,d,e,f){var g=!f;0>c&&(f=!f),f&&e++;var j=new h(b.x,b.y),k=d[e],l=1/0;c=Math.abs(c);for(var m=i;;){var n=j.dist(k),o=c/n,p=Math.atan2(k.y-j.y,k.x-j.x);if(f||(p+=Math.PI),g&&(p+=Math.PI),a.push({anchorPoint:j,offset:g?Math.PI:0,minScale:o,maxScale:l,angle:(p+2*Math.PI)%(2*Math.PI)}),m>=o)break;for(j=k;j.equals(k);)if(e+=f?1:-1,k=d[e],!k)return o;var q=k.sub(j)._unit();j=j.sub(q._mult(n)),l=o}return m}var h=a("point-geometry");b.exports={getIconQuads:e,getGlyphQuads:f};var i=.5},{"point-geometry":137}],74:[function(a,b,c){function d(a,b){for(var c=[],d=0,f=a.length;f>d;d++){var g=e(a[d].properties,b["icon-image"]);g&&c.indexOf(g)<0&&c.push(g)}return c}var e=a("../util/token");b.exports=d},{"../util/token":105}],75:[function(a,b,c){function d(a,b,c){for(var d=[],f=[],h=0,i=a.length;i>h;h++){var j=g(a[h].properties,b["text-field"]);if(j){j=j.toString();var k=b["text-transform"];"uppercase"===k?j=j.toLocaleUpperCase():"lowercase"===k&&(j=j.toLocaleLowerCase());for(var l=0,m=j.length;m>l;l++)f.push(j.charCodeAt(l));d[h]=j}else d[h]=null}return f=e(f,c),{textFeatures:d,codepoints:f}}function e(a,b){var c,d=[];a.sort(f);for(var e=0;e<a.length;e++)a[e]!==c&&(c=a[e],b[c]||d.push(a[e]));return d}function f(a,b){return a-b}var g=a("../util/token");b.exports=d},{"../util/token":105}],76:[function(a,b,c){function d(a,b,c,d){this.codePoint=a,this.x=b,this.y=c,this.glyph=d}function e(a,b,c,d,e,f){this.positionedGlyphs=a,this.text=b,this.top=c,this.bottom=d,this.left=e,this.right=f}function f(a,b,c,f,h,i,j,k,l){for(var m=[],n=new e(m,a,l[1],l[1],l[0],l[0]),o=-17,p=l[0],q=l[1]+o,r=0;r<a.length;r++){var s=a.charCodeAt(r),t=b[s];t&&(m.push(new d(s,p,q,t)),p+=t.advance+k)}return!!m.length&&(g(n,b,f,c,h,i,j),n)}function g(a,b,c,d,e,f,g){var j=null,k=0,m=0,n=0,o=0,p=a.positionedGlyphs;if(d)for(var q=0;q<p.length;q++){var r=p[q];if(r.x-=k,r.y+=c*n,r.x>d&&null!==j){var s=p[j+1].x;o=Math.max(s,o);for(var t=j+1;q>=t;t++)p[t].y+=c,p[t].x-=s;g&&h(p,b,m,j-1,g),m=j+1,j=null,k+=s,n++}l[r.codePoint]&&(j=q)}var u=p[p.length-1],v=u.x+b[u.codePoint].advance;o=Math.max(o,v);var w=(n+1)*c;h(p,b,m,p.length-1,g),i(p,g,e,f,o,c,n),a.top+=-f*w,a.bottom=a.top+w,a.left+=-e*o,a.right=a.left+o}function h(a,b,c,d,e){for(var f=b[a[d].codePoint].advance,g=(a[d].x+f)*e,h=c;d>=h;h++)a[h].x-=g}function i(a,b,c,d,e,f,g){for(var h=(b-c)*e,i=(-d*(g+1)+.5)*f,j=0;j<a.length;j++)a[j].x+=h,a[j].y+=i}function j(a,b){if(!a||!a.rect)return null;var c=b["icon-offset"][0],d=b["icon-offset"][1],e=c-a.width/2,f=e+a.width,g=d-a.height/2,h=g+a.height;return new k(a,g,h,e,f)}function k(a,b,c,d,e){this.image=a,this.top=b,this.bottom=c,this.left=d,this.right=e}b.exports={shapeText:f,shapeIcon:j};var l={32:!0}},{}],77:[function(a,b,c){function d(a,b){this.width=a,this.height=b,this.bin=new g(a,b),this.images={},this.data=!1,this.texture=0,this.filter=0,this.pixelRatio=1,this.dirty=!0}function e(a,b,c,d,e,f,g,h,i,j,k){var l,m,n=d*b+c,o=h*f+g;if(k)for(o-=f,m=-1;j>=m;m++,n=((m+j)%j+d)*b+c,o+=f)for(l=-1;i>=l;l++)e[o+l]=a[n+(l+i)%i];else for(m=0;j>m;m++,n+=b,o+=f)for(l=0;i>l;l++)e[o+l]=a[n+l]}function f(a,b,c,d){this.rect=a,this.width=b,this.height=c,this.sdf=d}var g=a("./bin_pack");b.exports=d,d.prototype={get debug(){return"canvas"in this},set debug(a){a&&!this.canvas?(this.canvas=document.createElement("canvas"),this.canvas.width=this.width*this.pixelRatio,this.canvas.height=this.height*this.pixelRatio,this.canvas.style.width=this.width+"px",this.canvas.style.width=this.width+"px",document.body.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d")):!a&&this.canvas&&(this.canvas.parentNode.removeChild(this.canvas),delete this.ctx,delete this.canvas)}},d.prototype.resize=function(a){if(this.pixelRatio===a)return!1;var b=this.pixelRatio;if(this.pixelRatio=a,this.canvas&&(this.canvas.width=this.width*this.pixelRatio,this.canvas.height=this.height*this.pixelRatio),this.data){var c=this.data;this.data=!1,this.allocate(),this.texture=!1;for(var d=this.width*b,e=this.height*b,f=this.width*a,g=this.height*a,h=this.data,i=c,j=0;g>j;j++)for(var k=Math.floor(j*e/g)*d,l=j*f,m=0;f>m;m++){var n=Math.floor(m*d/f);h[l+m]=i[k+n]}c=null,this.dirty=!0}return this.dirty},d.prototype.allocateImage=function(a,b){var c=2,d=a+c+(4-(a+c)%4),e=b+c+(4-(b+c)%4),f=this.bin.allocate(d,e);return 0===f.w?f:(f.originalWidth=a,f.originalHeight=b,f)},d.prototype.getImage=function(a,b){if(this.images[a])return this.images[a];if(!this.sprite)return null;var c=this.sprite.getSpritePosition(a);if(!c.width||!c.height)return null;var d=c.width/c.pixelRatio,e=c.height/c.pixelRatio,g=this.allocateImage(d,e);if(0===g.w)return g;var h=new f(g,d,e,c.sdf);return this.images[a]=h,this.copy(g,c,b),h},d.prototype.getPosition=function(a,b){var c=this.getImage(a,b),d=c&&c.rect;if(!d)return null;var e=b?c.width:d.w,f=b?c.height:d.h,g=1;return{size:[e,f],tl:[(d.x+g)/this.width,(d.y+g)/this.height],br:[(d.x+g+e)/this.width,(d.y+g+f)/this.height]}},d.prototype.allocate=function(){if(!this.data){var a=Math.floor(this.width*this.pixelRatio),b=Math.floor(this.height*this.pixelRatio);this.data=new Uint32Array(a*b);for(var c=0;c<this.data.length;c++)this.data[c]=0}},d.prototype.copy=function(a,b,c){if(this.sprite.img.data){var d=new Uint32Array(this.sprite.img.data.buffer);this.allocate();var f=this.data,g=1;e(d,this.sprite.img.width,b.x,b.y,f,this.width*this.pixelRatio,(a.x+g)*this.pixelRatio,(a.y+g)*this.pixelRatio,b.width,b.height,c),this.dirty=!0}},d.prototype.setSprite=function(a){this.sprite=a},d.prototype.addIcons=function(a,b){for(var c=0;c<a.length;c++)this.getImage(a[c]);b(null,this.images)},d.prototype.bind=function(a,b){var c=!1;this.texture?a.bindTexture(a.TEXTURE_2D,this.texture):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),c=!0);var d=b?a.LINEAR:a.NEAREST;if(d!==this.filter&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,d),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,d),this.filter=d),this.dirty&&(this.allocate(),c?a.texImage2D(a.TEXTURE_2D,0,a.RGBA,this.width*this.pixelRatio,this.height*this.pixelRatio,0,a.RGBA,a.UNSIGNED_BYTE,new Uint8Array(this.data.buffer)):a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width*this.pixelRatio,this.height*this.pixelRatio,a.RGBA,a.UNSIGNED_BYTE,new Uint8Array(this.data.buffer)),this.dirty=!1,this.ctx)){var e=this.ctx.getImageData(0,0,this.width*this.pixelRatio,this.height*this.pixelRatio);e.data.set(new Uint8ClampedArray(this.data.buffer)),this.ctx.putImageData(e,0,0),this.ctx.strokeStyle="red";for(var f=0;f<this.bin.free.length;f++){var g=this.bin.free[f];this.ctx.strokeRect(g.x*this.pixelRatio,g.y*this.pixelRatio,g.w*this.pixelRatio,g.h*this.pixelRatio)}}}},{"./bin_pack":63}],78:[function(a,b,c){var d=a("../util/util"),e=a("../util/interpolate"),f=a("../util/browser"),g=a("../geo/lng_lat"),h=a("../geo/lng_lat_bounds"),i=a("point-geometry"),j=b.exports=function(){};d.extend(j.prototype,{getCenter:function(){return this.transform.center},setCenter:function(a){return this.jumpTo({center:a}),this},panBy:function(a,b){return this.panTo(this.transform.center,d.extend({offset:i.convert(a).mult(-1)},b)),this},panTo:function(a,b){this.stop(),a=g.convert(a),b=d.extend({duration:500,easing:d.ease,offset:[0,0]},b);var c=this.transform,e=i.convert(b.offset).rotate(-c.angle),f=c.point,h=c.project(a).sub(e);return b.noMoveStart||this.fire("movestart"),this._ease(function(a){c.center=c.unproject(f.add(h.sub(f).mult(a))),this.fire("move")},function(){this.fire("moveend")},b),this},getZoom:function(){return this.transform.zoom},setZoom:function(a){return this.jumpTo({zoom:a}),this},zoomTo:function(a,b){this.stop(),b=d.extend({duration:500},b),b.easing=this._updateEasing(b.duration,a,b.easing);var c=this.transform,f=c.center,h=c.zoom;return b.around?f=g.convert(b.around):b.offset&&(f=c.pointLocation(c.centerPoint.add(i.convert(b.offset)))),b.animate===!1&&(b.duration=0),this.zooming||(this.zooming=!0,this.fire("movestart")),this._ease(function(b){c.setZoomAround(e(h,a,b),f),this.fire("move").fire("zoom")},function(){this.ease=null,b.duration>=200&&(this.zooming=!1,this.fire("moveend"))},b),b.duration<200&&(clearTimeout(this._onZoomEnd),this._onZoomEnd=setTimeout(function(){this.zooming=!1,this.fire("moveend")}.bind(this),200)),this},zoomIn:function(a){return this.zoomTo(this.getZoom()+1,a),this},zoomOut:function(a){return this.zoomTo(this.getZoom()-1,a),this},getBearing:function(){return this.transform.bearing},setBearing:function(a){return this.jumpTo({bearing:a}),this},rotateTo:function(a,b){this.stop(),b=d.extend({duration:500,easing:d.ease},b);var c=this.transform,f=this.getBearing(),h=c.center;return b.around?h=g.convert(b.around):b.offset&&(h=c.pointLocation(c.centerPoint.add(i.convert(b.offset)))),a=this._normalizeBearing(a,f),this.rotating=!0,this.fire("movestart"),this._ease(function(b){c.setBearingAround(e(f,a,b),h),this.fire("move").fire("rotate")},function(){this.rotating=!1,this.fire("moveend")},b),this},resetNorth:function(a){return this.rotateTo(0,d.extend({duration:1e3},a)),this},snapToNorth:function(a){return Math.abs(this.getBearing())<this.options.bearingSnap?this.resetNorth(a):this},getPitch:function(){return this.transform.pitch},setPitch:function(a){return this.jumpTo({pitch:a}),this},fitBounds:function(a,b){b=d.extend({padding:0,offset:[0,0],maxZoom:1/0},b),a=h.convert(a);var c=i.convert(b.offset),e=this.transform,f=e.project(a.getNorthWest()),g=e.project(a.getSouthEast()),j=g.sub(f),k=(e.width-2*b.padding-2*Math.abs(c.x))/j.x,l=(e.height-2*b.padding-2*Math.abs(c.y))/j.y;return b.center=e.unproject(f.add(g).div(2)),b.zoom=Math.min(e.scaleZoom(e.scale*Math.min(k,l)),b.maxZoom),b.bearing=0,b.linear?this.easeTo(b):this.flyTo(b)},jumpTo:function(a){this.stop();var b=this.transform,c=!1,d=!1,e=!1;return"center"in a&&(b.center=g.convert(a.center)),"zoom"in a&&b.zoom!==+a.zoom&&(c=!0,b.zoom=+a.zoom),"bearing"in a&&b.bearing!==+a.bearing&&(d=!0,b.bearing=+a.bearing),"pitch"in a&&b.pitch!==+a.pitch&&(e=!0,b.pitch=+a.pitch),this.fire("movestart").fire("move"),c&&this.fire("zoom"),d&&this.fire("rotate"),e&&this.fire("pitch"),this.fire("moveend")},easeTo:function(a){this.stop(),a=d.extend({offset:[0,0],duration:500,easing:d.ease},a);var b=this.transform,c=i.convert(a.offset).rotate(-b.angle),f=b.point,h=this.getZoom(),j=this.getBearing(),k=this.getPitch(),l="zoom"in a?+a.zoom:h,m="bearing"in a?this._normalizeBearing(a.bearing,j):j,n="pitch"in a?+a.pitch:k,o=b.zoomScale(l-h),p="center"in a?b.project(g.convert(a.center)).sub(c.div(o)):f,q=g.convert(a.around);return l!==h&&(this.zooming=!0),j!==m&&(this.rotating=!0),this.zooming&&!q&&(q=b.pointLocation(b.centerPoint.add(p.sub(f).div(1-1/o)))),this.fire("movestart"),this._ease(function(a){this.zooming?b.setZoomAround(e(h,l,a),q):b.center=b.unproject(f.add(p.sub(f).mult(a))),this.rotating&&(b.bearing=e(j,m,a)),n!==k&&(b.pitch=e(k,n,a)),this.fire("move"),this.zooming&&this.fire("zoom"),this.rotating&&this.fire("rotate")},function(){this.zooming=!1,this.rotating=!1,this.fire("moveend")},a),this},flyTo:function(a){function b(a){var b=(x*x-w*w+(a?-1:1)*z*z*y*y)/(2*(a?x:w)*z*y);return Math.log(Math.sqrt(b*b+1)-b)}function c(a){return(Math.exp(a)-Math.exp(-a))/2}function f(a){return(Math.exp(a)+Math.exp(-a))/2}function h(a){return c(a)/f(a)}this.stop(),a=d.extend({offset:[0,0],speed:1.2,curve:1.42,easing:d.ease},a);var j=this.transform,k=i.convert(a.offset),l=this.getZoom(),m=this.getBearing(),n="center"in a?g.convert(a.center):this.getCenter(),o="zoom"in a?+a.zoom:l,p="bearing"in a?this._normalizeBearing(a.bearing,m):m,q=j.zoomScale(o-l),r=j.point,s=j.project(n).sub(k.div(q)),t=j.worldSize,u=a.curve,v=a.speed,w=Math.max(j.width,j.height),x=w/q,y=s.sub(r).mag(),z=u*u,A=b(0),B=function(a){return f(A)/f(A+u*a)},C=function(a){return w*((f(A)*h(A+u*a)-c(A))/z)/y},D=(b(1)-A)/u;if(Math.abs(y)<1e-6){if(Math.abs(w-x)<1e-6)return this;var E=w>x?-1:1;D=Math.abs(Math.log(x/w))/u,C=function(){return 0},B=function(a){return Math.exp(E*u*a)}}return a.duration=1e3*D/v,this.zooming=!0,m!==p&&(this.rotating=!0),this.fire("movestart"),this._ease(function(a){var b=a*D,c=C(b);j.zoom=l+j.scaleZoom(1/B(b)),j.center=j.unproject(r.add(s.sub(r).mult(c)),t),p!==m&&(j.bearing=e(m,p,a)),this.fire("move").fire("zoom"),p!==m&&this.fire("rotate")},function(){this.zooming=!1,this.rotating=!1,this.fire("moveend")},a),this},isEasing:function(){return!!this._abortFn},stop:function(){return this._abortFn&&(this._abortFn(),this._finishEase()),this},_ease:function(a,b,c){this._finishFn=b,this._abortFn=f.timed(function(b){a.call(this,c.easing(b)),1===b&&this._finishEase()},c.animate===!1?0:c.duration,this)},_finishEase:function(){delete this._abortFn;var a=this._finishFn;delete this._finishFn,a.call(this)},_normalizeBearing:function(a,b){a=d.wrap(a,-180,180);var c=Math.abs(a-b);return Math.abs(a-360-b)<c&&(a-=360),Math.abs(a+360-b)<c&&(a+=360),a},_updateEasing:function(a,b,c){var e;if(this.ease){var f=this.ease,g=(Date.now()-f.start)/f.duration,h=f.easing(g+.01)-f.easing(g),i=.27/Math.sqrt(h*h+1e-4)*.01,j=Math.sqrt(.0729-i*i);e=d.bezier(i,j,.25,1)}else e=c?d.bezier.apply(d,c):d.ease;return this.ease={start:(new Date).getTime(),to:Math.pow(2,b),duration:a,easing:e},e}})},{"../geo/lng_lat":20,"../geo/lng_lat_bounds":21,"../util/browser":95,"../util/interpolate":102,"../util/util":106,"point-geometry":137}],79:[function(a,b,c){function d(){}var e=a("./control"),f=a("../../util/dom"),g=a("../../util/util");b.exports=d,d.prototype=g.inherit(e,{options:{position:"bottom-right"},onAdd:function(a){var b="mapboxgl-ctrl-attrib",c=this._container=f.create("div",b,a.getContainer());return this._update(),a.on("source.load",this._update.bind(this)),a.on("source.change",this._update.bind(this)),a.on("source.remove",this._update.bind(this)),a.on("moveend",this._updateEditLink.bind(this)),c},_update:function(){var a=[];if(this._map.style)for(var b in this._map.style.sources){var c=this._map.style.sources[b];c.attribution&&a.indexOf(c.attribution)<0&&a.push(c.attribution)}this._container.innerHTML=a.join(" | "),this._editLink=this._container.getElementsByClassName("mapbox-improve-map")[0],this._updateEditLink()},_updateEditLink:function(){if(this._editLink){var a=this._map.getCenter();this._editLink.href="https://www.mapbox.com/map-feedback/#/"+a.lng+"/"+a.lat+"/"+Math.round(this._map.getZoom()+1)}}})},{"../../util/dom":98,"../../util/util":106,"./control":80}],80:[function(a,b,c){function d(){}b.exports=d,d.prototype={addTo:function(a){this._map=a;var b=this._container=this.onAdd(a);if(this.options&&this.options.position){var c=this.options.position,d=a._controlCorners[c];b.className+=" mapboxgl-ctrl",-1!==c.indexOf("bottom")?d.insertBefore(b,d.firstChild):d.appendChild(b)}return this},remove:function(){return this._container.parentNode.removeChild(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this}}},{}],81:[function(a,b,c){function d(a){g.setOptions(this,a)}var e=a("./control"),f=a("../../util/dom"),g=a("../../util/util");b.exports=d,d.prototype=g.inherit(e,{options:{position:"top-right"},onAdd:function(a){var b="mapboxgl-ctrl",c=this._container=f.create("div",b+"-group",a.getContainer());this._zoomInButton=this._createButton(b+"-icon "+b+"-zoom-in",a.zoomIn.bind(a)),this._zoomOutButton=this._createButton(b+"-icon "+b+"-zoom-out",a.zoomOut.bind(a)),this._compass=this._createButton(b+"-compass",a.resetNorth.bind(a));var d=this._compassCanvas=f.create("canvas",b+"-compass-canvas",this._compass);return d.style.cssText="width:30px; height:30px;",d.width=52,d.height=52,this._compass.addEventListener("mousedown",this._onCompassDown.bind(this)),this._onCompassMove=this._onCompassMove.bind(this),this._onCompassUp=this._onCompassUp.bind(this),this._compassCtx=d.getContext("2d"),a.on("rotate",this._drawNorth.bind(this)),this._drawNorth(),c},_onCompassDown:function(a){f.disableDrag(),document.addEventListener("mousemove",this._onCompassMove),document.addEventListener("mouseup",this._onCompassUp),this._prevX=a.screenX,a.stopPropagation()},_onCompassMove:function(a){var b=a.screenX,c=2>b?-5:b>window.screen.width-2?5:(b-this._prevX)/4;this._map.setBearing(this._map.getBearing()-c),this._prevX=a.screenX,this._moved=!0,
a.preventDefault()},_onCompassUp:function(){document.removeEventListener("mousemove",this._onCompassMove),document.removeEventListener("mouseup",this._onCompassUp),f.enableDrag(),this._moved&&(this._moved=!1,f.suppressClick()),this._map.snapToNorth()},_createButton:function(a,b){var c=f.create("button",a,this._container);return c.addEventListener("click",function(){b()}),c},_drawNorth:function(){var a=20,b=8,c=26,d=this._map.transform.angle+Math.PI/2,e=this._compassCtx;this._compassCanvas.width=this._compassCanvas.width,e.translate(c,c),e.rotate(d),e.beginPath(),e.fillStyle="#000",e.lineTo(0,-b),e.lineTo(-a,0),e.lineTo(0,b),e.fill(),e.beginPath(),e.fillStyle="#bbb",e.moveTo(0,0),e.lineTo(0,b),e.lineTo(a,0),e.lineTo(0,-b),e.fill(),e.beginPath(),e.strokeStyle="#fff",e.lineWidth=4,e.moveTo(0,-b),e.lineTo(0,b),e.stroke()}})},{"../../util/dom":98,"../../util/util":106,"./control":80}],82:[function(a,b,c){function d(a){this._map=a,this._el=a.getCanvasContainer(),this._container=a.getContainer(),g.bindHandlers(this)}var e=a("../../util/dom"),f=a("../../geo/lng_lat_bounds"),g=a("../../util/util");b.exports=d,d.prototype={enable:function(){this._el.addEventListener("mousedown",this._onMouseDown,!1)},disable:function(){this._el.removeEventListener("mousedown",this._onMouseDown)},_onMouseDown:function(a){(a.shiftKey||1===a.which&&1===a.button)&&(document.addEventListener("mousemove",this._onMouseMove,!1),document.addEventListener("keydown",this._onKeyDown,!1),document.addEventListener("mouseup",this._onMouseUp,!1),this._startPos=e.mousePos(this._el,a),this.active=!0)},_onMouseMove:function(a){var b=this._startPos,c=e.mousePos(this._el,a);this._box||(this._box=e.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),e.disableDrag(),this._map.fire("boxzoomstart"));var d=Math.min(b.x,c.x),f=Math.max(b.x,c.x),g=Math.min(b.y,c.y),h=Math.max(b.y,c.y);e.setTransform(this._box,"translate("+d+"px,"+g+"px)"),this._box.style.width=f-d+"px",this._box.style.height=h-g+"px"},_onMouseUp:function(a){var b=this._startPos,c=e.mousePos(this._el,a),d=new f(this._map.unproject(b),this._map.unproject(c));this._finish(),this._map.fitBounds(d,{linear:!0}).fire("boxzoomend",{boxZoomBounds:d})},_onKeyDown:function(a){27===a.keyCode&&(this._finish(),this._map.fire("boxzoomcancel"))},_finish:function(){this._box&&(this.active=!1,document.removeEventListener("mousemove",this._onMouseMove,!1),document.removeEventListener("keydown",this._onKeyDown,!1),document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box.parentNode.removeChild(this._box),this._box=null,e.enableDrag())}}},{"../../geo/lng_lat_bounds":21,"../../util/dom":98,"../../util/util":106}],83:[function(a,b,c){function d(a){this._map=a,this._onDblClick=this._onDblClick.bind(this)}b.exports=d,d.prototype={enable:function(){this._map.on("dblclick",this._onDblClick)},disable:function(){this._map.off("dblclick",this._onDblClick)},_onDblClick:function(a){this._map.zoomTo(Math.round(this._map.getZoom())+1,{around:a.lngLat})}}},{}],84:[function(a,b,c){function d(a){this._map=a,this._el=a.getCanvasContainer(),f.bindHandlers(this)}var e=a("../../util/dom"),f=a("../../util/util");b.exports=d;var g=.25,h=f.bezier(0,0,g,1),i=3e3,j=4e3;d.prototype={enable:function(){this._el.addEventListener("mousedown",this._onDown,!1),this._el.addEventListener("touchstart",this._onDown,!1)},disable:function(){this._el.removeEventListener("mousedown",this._onDown),this._el.removeEventListener("touchstart",this._onDown)},_onDown:function(a){this._startPos=this._pos=e.mousePos(this._el,a),this._inertia=[[Date.now(),this._pos]],a.touches?1===a.touches.length&&(document.addEventListener("touchmove",this._onMove,!1),document.addEventListener("touchend",this._onTouchEnd,!1)):(document.addEventListener("mousemove",this._onMove,!1),document.addEventListener("mouseup",this._onMouseUp,!1))},_onMove:function(a){var b=this._map;if(!(b.boxZoom.active||b.dragRotate.active||a.touches&&a.touches.length>1)){this.active=!0;var c=e.mousePos(this._el,a),d=this._inertia,f=Date.now();for(d.push([f,c]);d.length>2&&f-d[0][0]>50;)d.shift();b.stop(),b.transform.setLocationAtPoint(b.transform.pointLocation(this._pos),c),b.fire("move"),this._pos=c,a.preventDefault()}},_onUp:function(){var a=this._inertia;if(a.length<2)return void this._map.fire("moveend");var b=a[a.length-1],c=a[0],d=b[1].sub(c[1]),e=(b[0]-c[0])/1e3,f=d.mult(g/e),k=f.mag();k>i&&(k=i,f._unit()._mult(k));var l=k/(j*g),m=f.mult(-l/2);this._map.panBy(m,{duration:1e3*l,easing:h,noMoveStart:!0}),this.active=!1},_onMouseUp:function(){this._onUp(),document.removeEventListener("mousemove",this._onMove,!1),document.removeEventListener("mouseup",this._onMouseUp,!1)},_onTouchEnd:function(){this._onUp(),document.removeEventListener("touchmove",this._onMove),document.removeEventListener("touchend",this._onTouchEnd)}}},{"../../util/dom":98,"../../util/util":106}],85:[function(a,b,c){function d(a){this._map=a,this._el=a.getCanvasContainer(),g.bindHandlers(this)}var e=a("../../util/dom"),f=a("point-geometry"),g=a("../../util/util");b.exports=d,d.prototype={enable:function(){this._el.addEventListener("contextmenu",this._onContextMenu,!1)},disable:function(){this._el.removeEventListener("contextmenu",this._onContextMenu)},_onContextMenu:function(a){this._map.stop(),this._startPos=this._pos=e.mousePos(this._el,a),document.addEventListener("mousemove",this._onMouseMove,!1),document.addEventListener("mouseup",this._onMouseUp,!1),a.preventDefault()},_onMouseMove:function(a){var b=this._startPos,c=this._pos,d=e.mousePos(this._el,a),g=this._map,h=g.transform.centerPoint,i=b.sub(h),j=i.mag();this.active=!0,g.rotating||(g.fire("movestart"),g.rotating=!0),200>j&&(h=b.add(new f(-200,0)._rotate(i.angle())));var k=c.sub(h).angleWith(d.sub(h))/Math.PI*180;g.transform.bearing=g.getBearing()-k,g.fire("move").fire("rotate"),clearTimeout(this._timeout),this._timeout=setTimeout(this._onTimeout,200),this._pos=d},_onTimeout:function(){var a=this._map;a.rotating=!1,a.snapToNorth(),a.rotating||(a._rerender(),a.fire("moveend"))},_onMouseUp:function(){this.active=!1,document.removeEventListener("mousemove",this._onMouseMove,!1),document.removeEventListener("mouseup",this._onMouseUp,!1)}}},{"../../util/dom":98,"../../util/util":106,"point-geometry":137}],86:[function(a,b,c){function d(a){this._map=a,this._el=a.getCanvasContainer(),this._onKeyDown=this._onKeyDown.bind(this)}b.exports=d;var e=80,f=2;d.prototype={enable:function(){this._el.addEventListener("keydown",this._onKeyDown,!1)},disable:function(){this._el.removeEventListener("keydown",this._onKeyDown)},_onKeyDown:function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var b=this._map;switch(a.keyCode){case 61:case 107:case 171:case 187:b.zoomTo(Math.round(b.getZoom())+(a.shiftKey?2:1));break;case 189:case 109:case 173:b.zoomTo(Math.round(b.getZoom())-(a.shiftKey?2:1));break;case 37:a.shiftKey?b.setBearing(b.getBearing()-f):b.panBy([-e,0]);break;case 39:a.shiftKey?b.setBearing(b.getBearing()+f):b.panBy([e,0]);break;case 38:b.panBy([0,-e]);break;case 40:b.panBy([0,e])}}}}},{}],87:[function(a,b,c){function d(a){this._map=a,this._el=a.getCanvasContainer(),f.bindHandlers(this)}var e=a("../../util/dom"),f=a("../../util/util");b.exports=d,d.prototype={enable:function(){this._el.addEventListener("touchstart",this._onStart,!1)},disable:function(){this._el.removeEventListener("touchstart",this._onStart)},_onStart:function(a){if(2===a.touches.length){var b=e.mousePos(this._el,a.touches[0]),c=e.mousePos(this._el,a.touches[1]);this._startVec=b.sub(c),this._startScale=this._map.transform.scale,this._startBearing=this._map.transform.bearing,document.addEventListener("touchmove",this._onMove,!1),document.addEventListener("touchend",this._onEnd,!1)}},_onMove:function(a){if(2===a.touches.length){var b=e.mousePos(this._el,a.touches[0]),c=e.mousePos(this._el,a.touches[1]),d=b.add(c).div(2),f=b.sub(c),g=f.mag()/this._startVec.mag(),h=180*f.angleWith(this._startVec)/Math.PI,i=this._map;i.easeTo({zoom:i.transform.scaleZoom(this._startScale*g),bearing:this._startBearing+h,duration:0,around:i.unproject(d)}),a.preventDefault()}},_onEnd:function(){this._map.snapToNorth(),document.removeEventListener("touchmove",this._onMove),document.removeEventListener("touchend",this._onEnd)}}},{"../../util/dom":98,"../../util/util":106}],88:[function(a,b,c){function d(a){this._map=a,this._el=a.getCanvasContainer(),g.bindHandlers(this)}var e=a("../../util/dom"),f=a("../../util/browser"),g=a("../../util/util");b.exports=d;var h="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",i=-1!==h.indexOf("firefox"),j=-1!==h.indexOf("safari")&&-1===h.indexOf("chrom");d.prototype={enable:function(){this._el.addEventListener("wheel",this._onWheel,!1),this._el.addEventListener("mousewheel",this._onWheel,!1)},disable:function(){this._el.removeEventListener("wheel",this._onWheel),this._el.removeEventListener("mousewheel",this._onWheel)},_onWheel:function(a){var b;"wheel"===a.type?(b=a.deltaY,i&&a.deltaMode===window.WheelEvent.DOM_DELTA_PIXEL&&(b/=f.devicePixelRatio),a.deltaMode===window.WheelEvent.DOM_DELTA_LINE&&(b*=40)):"mousewheel"===a.type&&(b=-a.wheelDeltaY,j&&(b/=3));var c=(window.performance||Date).now(),d=c-(this._time||0);this._pos=e.mousePos(this._el,a),this._time=c,0!==b&&b%4.000244140625===0?(this._type="wheel",b=Math.floor(b/4)):0!==b&&Math.abs(b)<4?this._type="trackpad":d>400?(this._type=null,this._lastValue=b,this._timeout=setTimeout(this._onTimeout,40)):this._type||(this._type=Math.abs(d*b)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,b+=this._lastValue)),a.shiftKey&&b&&(b/=4),this._type&&this._zoom(-b),a.preventDefault()},_onTimeout:function(){this._type="wheel",this._zoom(-this._lastValue)},_zoom:function(a){var b=this._map,c=2/(1+Math.exp(-Math.abs(a/100)));0>a&&0!==c&&(c=1/c);var d=b.ease?b.ease.to:b.transform.scale,e=b.transform.scaleZoom(d*c);b.zoomTo(e,{duration:0,around:b.unproject(this._pos)})}}},{"../../util/browser":95,"../../util/dom":98,"../../util/util":106}],89:[function(a,b,c){function d(){e.bindAll(["_onHashChange","_updateHash"],this)}b.exports=d;var e=a("../util/util");d.prototype={addTo:function(a){return this._map=a,window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},remove:function(){return window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),delete this._map,this},_onHashChange:function(){var a=location.hash.replace("#","").split("/");return a.length>=3&&(this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:+(a[3]||0)}),!0)},_updateHash:function(){var a=this._map.getCenter(),b=this._map.getZoom(),c=this._map.getBearing(),d=Math.max(0,Math.ceil(Math.log(b)/Math.LN2)),e="#"+Math.round(100*b)/100+"/"+a.lat.toFixed(d)+"/"+a.lng.toFixed(d)+(c?"/"+Math.round(10*c)/10:"");window.history.replaceState("","",e)}}},{"../util/util":106}],90:[function(a,b,c){function d(a){this._map=a,this._el=a.getCanvasContainer();for(var b in e)a[b]=new e[b](a);g.bindHandlers(this)}var e={scrollZoom:a("./handler/scroll_zoom"),boxZoom:a("./handler/box_zoom"),dragRotate:a("./handler/drag_rotate"),dragPan:a("./handler/drag_pan"),keyboard:a("./handler/keyboard"),doubleClickZoom:a("./handler/dblclick_zoom"),pinch:a("./handler/pinch")},f=a("../util/dom"),g=a("../util/util");b.exports=d,d.prototype={enable:function(){var a=this._map.options,b=this._el;for(var c in e)a[c]&&this._map[c].enable();b.addEventListener("mousedown",this._onMouseDown,!1),b.addEventListener("mouseup",this._onMouseUp,!1),b.addEventListener("touchstart",this._onTouchStart,!1),b.addEventListener("click",this._onClick,!1),b.addEventListener("mousemove",this._onMouseMove,!1),b.addEventListener("dblclick",this._onDblClick,!1),b.addEventListener("contextmenu",this._onContextMenu,!1)},disable:function(){var a=this._map.options,b=this._el;for(var c in e)a[c]&&this._map[c].disable();b.removeEventListener("mousedown",this._onMouseDown),b.removeEventListener("mouseup",this._onMouseUp),b.removeEventListener("touchstart",this._onTouchStart),b.removeEventListener("click",this._onClick),b.removeEventListener("mousemove",this._onMouseMove),b.removeEventListener("dblclick",this._onDblClick),b.removeEventListener("contextmenu",this._onContextMenu)},_onMouseDown:function(a){this._startPos=f.mousePos(this._el,a)},_onMouseUp:function(a){!this._contextMenuFired||this._map.dragRotate.active||this._map.dragPan.active||this._fireEvent("contextmenu",a),this._contextMenuFired=null},_onTouchStart:function(a){!a.touches||a.touches.length>1||(this._tapped?(clearTimeout(this._tapped),this._tapped=null,this._fireEvent("dblclick",a)):this._tapped=setTimeout(this._onTimeout,300))},_onTimeout:function(){this._tapped=null},_onMouseMove:function(a){var b=this._map,c=this._el;if(!b.dragPan.active&&!b.dragRotate.active){for(var d=a.toElement||a.target;d&&d!==c;)d=d.parentNode;d===c&&this._fireEvent("mousemove",a)}},_onClick:function(a){var b=f.mousePos(this._el,a);b.equals(this._startPos)&&this._fireEvent("click",a)},_onDblClick:function(a){this._fireEvent("dblclick",a),a.preventDefault()},_onContextMenu:function(){this._contextMenuFired=!0},_fireEvent:function(a,b){var c=f.mousePos(this._el,b);this._map.fire(a,{lngLat:this._map.unproject(c),point:c,originalEvent:b})}}},{"../util/dom":98,"../util/util":106,"./handler/box_zoom":82,"./handler/dblclick_zoom":83,"./handler/drag_pan":84,"./handler/drag_rotate":85,"./handler/keyboard":86,"./handler/pinch":87,"./handler/scroll_zoom":88}],91:[function(a,b,c){var d=a("../util/canvas"),e=a("../util/util"),f=a("../util/browser"),g=a("../util/evented"),h=a("../util/dom"),i=a("../style/style"),j=a("../style/animation_loop"),k=a("../render/painter"),l=a("../geo/transform"),m=a("./hash"),n=a("./interaction"),o=a("./camera"),p=a("../geo/lng_lat"),q=a("../geo/lng_lat_bounds"),r=a("point-geometry"),s=a("./control/attribution"),t=b.exports=function(a){if(a=this.options=e.inherit(this.options,a),this.animationLoop=new j,this.transform=new l(a.minZoom,a.maxZoom),a.maxBounds){var b=q.convert(a.maxBounds);this.transform.lngRange=[b.getWest(),b.getEast()],this.transform.latRange=[b.getSouth(),b.getNorth()]}e.bindAll(["_forwardStyleEvent","_forwardSourceEvent","_forwardLayerEvent","_forwardTileEvent","_onStyleLoad","_onStyleChange","_onSourceAdd","_onSourceRemove","_onSourceUpdate","_onWindowResize","onError","update","render"],this),this._setupContainer(),this._setupPainter(),this.on("move",this.update),this.on("zoom",this.update.bind(this,!0)),this.on("moveend",function(){this.animationLoop.set(300),this._rerender()}.bind(this)),"undefined"!=typeof window&&window.addEventListener("resize",this._onWindowResize,!1),this.interaction=new n(this),a.interactive&&this.interaction.enable(),this._hash=a.hash&&(new m).addTo(this),this._hash&&this._hash._onHashChange()||this.jumpTo(a),this.sources={},this.stacks={},this._classes={},this.resize(),a.classes&&this.setClasses(a.classes),a.style&&this.setStyle(a.style),a.attributionControl&&this.addControl(new s),this.on("style.error",this.onError),this.on("source.error",this.onError),this.on("tile.error",this.onError)};e.extend(t.prototype,g),e.extend(t.prototype,o.prototype),e.extend(t.prototype,{options:{center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:0,maxZoom:20,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,pinch:!0,bearingSnap:7,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1},addControl:function(a){return a.addTo(this),this},addClass:function(a,b){this._classes[a]||(this._classes[a]=!0,this.style&&this.style._cascade(this._classes,b))},removeClass:function(a,b){this._classes[a]&&(delete this._classes[a],this.style&&this.style._cascade(this._classes,b))},setClasses:function(a,b){this._classes={};for(var c=0;c<a.length;c++)this._classes[a[c]]=!0;this.style&&this.style._cascade(this._classes,b)},hasClass:function(a){return!!this._classes[a]},getClasses:function(){return Object.keys(this._classes)},resize:function(){var a=0,b=0;return this._container&&(a=this._container.offsetWidth||400,b=this._container.offsetHeight||300),this._canvas.resize(a,b),this.transform.width=a,this.transform.height=b,this.transform._constrain(),this.painter.resize(a,b),this.fire("movestart").fire("move").fire("resize").fire("moveend")},getBounds:function(){return new q(this.transform.pointLocation(new r(0,0)),this.transform.pointLocation(this.transform.size))},project:function(a){return this.transform.locationPoint(p.convert(a))},unproject:function(a){return this.transform.pointLocation(r.convert(a))},featuresAt:function(a,b,c){var d=this.unproject(a).wrap(),e=this.transform.locationCoordinate(d);return this.style.featuresAt(e,b,c),this},featuresIn:function(a,b,c){return"undefined"==typeof c&&(c=b,b=a,a=[r.convert([0,0]),r.convert([this.transform.width,this.transform.height])]),a=a.map(r.convert.bind(r)),a=[new r(Math.min(a[0].x,a[1].x),Math.min(a[0].y,a[1].y)),new r(Math.max(a[0].x,a[1].x),Math.max(a[0].y,a[1].y))].map(this.transform.pointCoordinate.bind(this.transform)),this.style.featuresIn(a,b,c),this},batch:function(a){this.style.batch(a),this.style._cascade(this._classes),this.update(!0)},setStyle:function(a){return this.style&&(this.style.off("load",this._onStyleLoad).off("error",this._forwardStyleEvent).off("change",this._onStyleChange).off("source.add",this._onSourceAdd).off("source.remove",this._onSourceRemove).off("source.load",this._onSourceUpdate).off("source.error",this._forwardSourceEvent).off("source.change",this._onSourceUpdate).off("layer.add",this._forwardLayerEvent).off("layer.remove",this._forwardLayerEvent).off("tile.add",this._forwardTileEvent).off("tile.remove",this._forwardTileEvent).off("tile.load",this.update).off("tile.error",this._forwardTileEvent).off("tile.stats",this._forwardTileEvent)._remove(),this.off("rotate",this.style._redoPlacement),this.off("pitch",this.style._redoPlacement)),a?(a instanceof i?this.style=a:this.style=new i(a,this.animationLoop),this.style.on("load",this._onStyleLoad).on("error",this._forwardStyleEvent).on("change",this._onStyleChange).on("source.add",this._onSourceAdd).on("source.remove",this._onSourceRemove).on("source.load",this._onSourceUpdate).on("source.error",this._forwardSourceEvent).on("source.change",this._onSourceUpdate).on("layer.add",this._forwardLayerEvent).on("layer.remove",this._forwardLayerEvent).on("tile.add",this._forwardTileEvent).on("tile.remove",this._forwardTileEvent).on("tile.load",this.update).on("tile.error",this._forwardTileEvent).on("tile.stats",this._forwardTileEvent),this.on("rotate",this.style._redoPlacement),this.on("pitch",this.style._redoPlacement),this):(this.style=null,this)},addSource:function(a,b){return this.style.addSource(a,b),this},removeSource:function(a){return this.style.removeSource(a),this},getSource:function(a){return this.style.getSource(a)},addLayer:function(a,b){return this.style.addLayer(a,b),this.style._cascade(this._classes),this},removeLayer:function(a){return this.style.removeLayer(a),this.style._cascade(this._classes),this},setFilter:function(a,b){return this.style.setFilter(a,b),this},setLayerZoomRange:function(a,b,c){return this.style.setLayerZoomRange(a,b,c),this},getFilter:function(a){return this.style.getFilter(a)},setPaintProperty:function(a,b,c,d){return this.batch(function(e){e.setPaintProperty(a,b,c,d)}),this},getPaintProperty:function(a,b,c){return this.style.getPaintProperty(a,b,c)},setLayoutProperty:function(a,b,c){return this.batch(function(d){d.setLayoutProperty(a,b,c)}),this},getLayoutProperty:function(a,b){return this.style.getLayoutProperty(a,b)},getContainer:function(){return this._container},getCanvasContainer:function(){return this._canvasContainer},getCanvas:function(){return this._canvas.getElement()},_setupContainer:function(){var a=this.options.container,b=this._container="string"==typeof a?document.getElementById(a):a;b.classList.add("mapboxgl-map");var c=this._canvasContainer=h.create("div","mapboxgl-canvas-container",b);this.options.interactive&&c.classList.add("mapboxgl-interactive"),this._canvas=new d(this,c);var e=h.create("div","mapboxgl-control-container",b),f=this._controlCorners={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(a){f[a]=h.create("div","mapboxgl-ctrl-"+a,e)})},_setupPainter:function(){var a=this._canvas.getWebGLContext({failIfMajorPerformanceCaveat:this.options.failIfMajorPerformanceCaveat,preserveDrawingBuffer:this.options.preserveDrawingBuffer});return a?void(this.painter=new k(a,this.transform)):void console.error("Failed to initialize WebGL")},_contextLost:function(a){a.preventDefault(),this._frameId&&f.cancelFrame(this._frameId)},_contextRestored:function(){this._setupPainter(),this.resize(),this.update()},loaded:function(){return!this._styleDirty&&!this._sourcesDirty&&!(this.style&&!this.style.loaded())},update:function(a){return this.style?(this._styleDirty=this._styleDirty||a,this._sourcesDirty=!0,this._rerender(),this):this},render:function(){return this.style&&this._styleDirty&&(this._styleDirty=!1,this.style._recalculate(this.transform.zoom)),this.style&&this._sourcesDirty&&!this._sourcesDirtyTimeout&&(this._sourcesDirty=!1,this._sourcesDirtyTimeout=setTimeout(function(){this._sourcesDirtyTimeout=null}.bind(this),50),this.style._updateSources(this.transform)),this.painter.render(this.style,{debug:this.debug,vertices:this.vertices,rotating:this.rotating,zooming:this.zooming}),this.fire("render"),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire("load")),this._frameId=null,this.animationLoop.stopped()||(this._styleDirty=!0),(this._sourcesDirty||this._repaint||!this.animationLoop.stopped())&&this._rerender(),this},remove:function(){return this._hash&&this._hash.remove(),f.cancelFrame(this._frameId),clearTimeout(this._sourcesDirtyTimeout),this.setStyle(null),"undefined"!=typeof window&&window.removeEventListener("resize",this._onWindowResize,!1),this},onError:function(a){console.error(a.error)},_rerender:function(){this.style&&!this._frameId&&(this._frameId=f.frame(this.render))},_forwardStyleEvent:function(a){this.fire("style."+a.type,e.extend({style:a.target},a))},_forwardSourceEvent:function(a){this.fire(a.type,e.extend({style:a.target},a))},_forwardLayerEvent:function(a){this.fire(a.type,e.extend({style:a.target},a))},_forwardTileEvent:function(a){this.fire(a.type,e.extend({style:a.target},a))},_onStyleLoad:function(a){var b=new l,c=this.transform;c.center.lng===b.center.lng&&c.center.lat===b.center.lat&&c.zoom===b.zoom&&c.bearing===b.bearing&&c.pitch===b.pitch&&this.jumpTo(this.style.stylesheet),this.style._cascade(this._classes,{transition:!1}),this._forwardStyleEvent(a)},_onStyleChange:function(a){this.update(!0),this._forwardStyleEvent(a)},_onSourceAdd:function(a){var b=a.source;b.onAdd&&b.onAdd(this),this._forwardSourceEvent(a)},_onSourceRemove:function(a){var b=a.source;b.onRemove&&b.onRemove(this),this._forwardSourceEvent(a)},_onSourceUpdate:function(a){this.update(),this._forwardSourceEvent(a)},_onWindowResize:function(){this.stop().resize().update()}}),e.extendAll(t.prototype,{_debug:!1,get debug(){return this._debug},set debug(a){this._debug=a,this.update()},_collisionDebug:!1,get collisionDebug(){return this._collisionDebug},set collisionDebug(a){this._collisionDebug=a,this.style._redoPlacement()},_repaint:!1,get repaint(){return this._repaint},set repaint(a){this._repaint=a,this.update()},_vertices:!1,get vertices(){return this._vertices},set vertices(a){this._vertices=a,this.update()}})},{"../geo/lng_lat":20,"../geo/lng_lat_bounds":21,"../geo/transform":22,"../render/painter":37,"../style/animation_loop":51,"../style/style":56,"../util/browser":95,"../util/canvas":96,"../util/dom":98,"../util/evented":100,"../util/util":106,"./camera":78,"./control/attribution":79,"./hash":89,"./interaction":90,"point-geometry":137}],92:[function(a,b,c){function d(a){e.setOptions(this,a),e.bindAll(["_updatePosition","_onClickClose"],this)}b.exports=d;var e=a("../util/util"),f=a("../util/evented"),g=a("../util/dom"),h=a("../geo/lng_lat");d.prototype=e.inherit(f,{options:{closeButton:!0,closeOnClick:!0},addTo:function(a){return this._map=a,this._map.on("move",this._updatePosition),this.options.closeOnClick&&this._map.on("click",this._onClickClose),this._update(),this},remove:function(){return this._container&&this._container.parentNode.removeChild(this._container),this._map&&(this._map.off("move",this._updatePosition),this._map.off("click",this._onClickClose),delete this._map),this},getLngLat:function(){return this._lngLat},setLngLat:function(a){return this._lngLat=h.convert(a),this._update(),this},setText:function(a){return this._content=document.createTextNode(a),this._updateContent(),this},setHTML:function(a){this._content=document.createDocumentFragment();var b,c=document.createElement("body");for(c.innerHTML=a;b=c.firstChild,b;)this._content.appendChild(b);return this._updateContent(),this},_update:function(){this._map&&(this._container||(this._container=g.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=g.create("div","mapboxgl-popup-tip",this._container),this._wrapper=g.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=g.create("button","mapboxgl-popup-close-button",this._wrapper),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))),this._updateContent(),this._updatePosition())},_updateContent:function(){if(this._content&&this._container){for(var a=this._wrapper;a.hasChildNodes();)a.removeChild(a.firstChild);this.options.closeButton&&a.appendChild(this._closeButton),a.appendChild(this._content)}},_updatePosition:function(){if(this._lngLat&&this._container){var a=this._map.project(this._lngLat).round(),b=this.options.anchor;if(!b){var c=this._container.offsetWidth,d=this._container.offsetHeight;b=a.y<d?["top"]:a.y>this._map.transform.height-d?["bottom"]:[],a.x<c/2?b.push("left"):a.x>this._map.transform.width-c/2&&b.push("right"),b=0===b.length?"bottom":b.join("-"),this.options.anchor=b}var e={top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},f=this._container.classList;for(var h in e)f.remove("mapboxgl-popup-anchor-"+h);f.add("mapboxgl-popup-anchor-"+b),g.setTransform(this._container,e[b]+" translate("+a.x+"px,"+a.y+"px)")}},_onClickClose:function(){this.remove()}})},{"../geo/lng_lat":20,"../util/dom":98,"../util/evented":100,"../util/util":106}],93:[function(a,b,c){function d(a,b){this.target=a,this.parent=b,this.callbacks={},this.callbackID=0,this.receive=this.receive.bind(this),this.target.addEventListener("message",this.receive,!1)}b.exports=d,d.prototype.receive=function(a){var b,c=a.data;if("<response>"===c.type)b=this.callbacks[c.id],delete this.callbacks[c.id],b(c.error||null,c.data);else if("undefined"!=typeof c.id){var d=c.id;this.parent[c.type](c.data,function(a,b,c){this.postMessage({type:"<response>",id:String(d),error:a?String(a):null,data:b},c)}.bind(this))}else this.parent[c.type](c.data)},d.prototype.send=function(a,b,c,d){var e=null;c&&(this.callbacks[e=this.callbackID++]=c),this.postMessage({type:a,id:String(e),data:b},d)},d.prototype.postMessage=function(a,b){try{this.target.postMessage(a,b)}catch(b){this.target.postMessage(a)}}},{}],94:[function(a,b,c){function d(a){var b=document.createElement("a");return b.href=a,b.protocol===document.location.protocol&&b.host===document.location.host}c.getJSON=function(a,b){var c=new XMLHttpRequest;return c.open("GET",a,!0),c.setRequestHeader("Accept","application/json"),c.onerror=function(a){b(a)},c.onload=function(){if(c.status>=200&&c.status<300&&c.response){var a;try{a=JSON.parse(c.response)}catch(a){return b(a)}b(null,a)}else b(new Error(c.statusText))},c.send(),c},c.getArrayBuffer=function(a,b){var c=new XMLHttpRequest;return c.open("GET",a,!0),c.responseType="arraybuffer",c.onerror=function(a){b(a)},c.onload=function(){c.status>=200&&c.status<300&&c.response?b(null,c.response):b(new Error(c.statusText))},c.send(),c},c.getImage=function(a,b){return c.getArrayBuffer(a,function(a,c){a&&b(a);var d=new Image;d.onload=function(){b(null,d),(window.URL||window.webkitURL).revokeObjectURL(d.src)};var e=new Blob([new Uint8Array(c)],{type:"image/png"});return d.src=(window.URL||window.webkitURL).createObjectURL(e),d.getData=function(){var a=document.createElement("canvas"),b=a.getContext("2d");return a.width=d.width,a.height=d.height,b.drawImage(d,0,0),b.getImageData(0,0,d.width,d.height).data},d})},c.getVideo=function(a,b){var c=document.createElement("video");c.onloadstart=function(){b(null,c)};for(var e=0;e<a.length;e++){var f=document.createElement("source");d(a[e])||(c.crossOrigin="Anonymous"),f.src=a[e],c.appendChild(f)}return c.getData=function(){return c},c}},{}],95:[function(a,b,c){var d=a("./canvas"),e=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;c.frame=function(a){return e(a)};var f=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame;c.cancelFrame=function(a){f(a)},c.timed=function(a,b,d){function e(h){f||(window.performance||(h=Date.now()),h>=g+b?a.call(d,1):(a.call(d,(h-g)/b),c.frame(e)))}if(!b)return a.call(d,1),null;var f=!1,g=window.performance?window.performance.now():Date.now();return c.frame(e),function(){f=!0}},c.supported=function(a){for(var b=([function(){return"undefined"!=typeof window},function(){return"undefined"!=typeof document},function(){return!!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)},function(){return!(!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions))},function(){return"JSON"in window&&"parse"in JSON&&"stringify"in JSON},function(){return(new d).supportsWebGLContext(a&&a.failIfMajorPerformanceCaveat||!1)},function(){return"Worker"in window}]),c=0;c<b.length;c++)if(!b[c]())return!1;return!0},c.hardwareConcurrency=navigator.hardwareConcurrency||8,Object.defineProperty(c,"devicePixelRatio",{get:function(){return window.devicePixelRatio}})},{"./canvas":96}],96:[function(a,b,c){function d(a,b){this.canvas=document.createElement("canvas"),a&&b&&(this.canvas.style.position="absolute",this.canvas.classList.add("mapboxgl-canvas"),this.canvas.addEventListener("webglcontextlost",a._contextLost.bind(a),!1),this.canvas.addEventListener("webglcontextrestored",a._contextRestored.bind(a),!1),this.canvas.setAttribute("tabindex",0),b.appendChild(this.canvas))}var e=a("../util");b.exports=d,d.prototype.resize=function(a,b){var c=window.devicePixelRatio||1;this.canvas.width=c*a,this.canvas.height=c*b,this.canvas.style.width=a+"px",this.canvas.style.height=b+"px"};var f={antialias:!1,alpha:!0,stencil:!0,depth:!1};d.prototype.getWebGLContext=function(a){return a=e.extend({},a,f),this.canvas.getContext("webgl",a)||this.canvas.getContext("experimental-webgl",a)},d.prototype.supportsWebGLContext=function(a){var b=e.extend({failIfMajorPerformanceCaveat:a},f);return"probablySupportsContext"in this.canvas?this.canvas.probablySupportsContext("webgl",b)||this.canvas.probablySupportsContext("experimental-webgl",b):"supportsContext"in this.canvas?this.canvas.supportsContext("webgl",b)||this.canvas.supportsContext("experimental-webgl",b):!!window.WebGLRenderingContext&&!!this.getWebGLContext(a);
},d.prototype.getElement=function(){return this.canvas}},{"../util":106}],97:[function(a,b,c){function d(b,c){this.actors=[],this.currentActor=0;for(var d=0;b>d;d++){var g=new f(a("../../source/worker")),h=new e(g,c);h.name="Worker "+d,this.actors.push(h)}}var e=a("../actor"),f=a("webworkify");b.exports=d,d.prototype={broadcast:function(a,b){for(var c=0;c<this.actors.length;c++)this.actors[c].send(a,b)},send:function(a,b,c,d,e){return("number"!=typeof d||isNaN(d))&&(d=this.currentActor=(this.currentActor+1)%this.actors.length),this.actors[d].send(a,b,c,e),d},remove:function(){for(var a=0;a<this.actors.length;a++)this.actors[a].target.terminate();this.actors=[]}}},{"../../source/worker":49,"../actor":93,webworkify:149}],98:[function(a,b,c){function d(a){for(var b=0;b<a.length;b++)if(a[b]in g)return a[b]}function e(a){a.preventDefault(),a.stopPropagation(),window.removeEventListener("click",e,!0)}var f=a("point-geometry");c.create=function(a,b,c){var d=document.createElement(a);return b&&(d.className=b),c&&c.appendChild(d),d};var i,g=document.documentElement.style,h=d(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);c.disableDrag=function(){h&&(i=g[h],g[h]="none")},c.enableDrag=function(){h&&(g[h]=i)};var j=d(["transform","WebkitTransform"]);c.setTransform=function(a,b){a.style[j]=b},c.suppressClick=function(){window.addEventListener("click",e,!0),window.setTimeout(function(){window.removeEventListener("click",e,!0)},0)},c.mousePos=function(a,b){var c=a.getBoundingClientRect();return b=b.touches?b.touches[0]:b,new f(b.clientX-c.left-a.clientLeft,b.clientY-c.top-a.clientTop)}},{"point-geometry":137}],99:[function(a,b,c){b.exports={API_URL:"https://api.mapbox.com",REQUIRE_ACCESS_TOKEN:!0}},{}],100:[function(a,b,c){var d=a("./util"),e={on:function(a,b){return this._events=this._events||{},this._events[a]=this._events[a]||[],this._events[a].push(b),this},off:function(a,b){if(!a)return delete this._events,this;if(!this.listens(a))return this;if(b){var c=this._events[a].indexOf(b);c>=0&&this._events[a].splice(c,1),this._events[a].length||delete this._events[a]}else delete this._events[a];return this},once:function(a,b){var c=function(d){this.off(a,c),b.call(this,d)}.bind(this);return this.on(a,c),this},fire:function(a,b){if(!this.listens(a))return this;b=d.extend({},b),d.extend(b,{type:a,target:this});for(var c=this._events[a].slice(),e=0;e<c.length;e++)c[e].call(this,b);return this},listens:function(a){return!(!this._events||!this._events[a])}};b.exports=e},{"./util":106}],101:[function(a,b,c){function d(a,b){this.stacks=a.readFields(e,[],b)}function e(a,b,c){if(1===a){var d=c.readMessage(f,{glyphs:{}});b.push(d)}}function f(a,b,c){if(1===a)b.name=c.readString();else if(2===a)b.range=c.readString();else if(3===a){var d=c.readMessage(g,{});b.glyphs[d.id]=d}}function g(a,b,c){1===a?b.id=c.readVarint():2===a?b.bitmap=c.readBytes():3===a?b.width=c.readVarint():4===a?b.height=c.readVarint():5===a?b.left=c.readSVarint():6===a?b.top=c.readSVarint():7===a&&(b.advance=c.readVarint())}b.exports=d},{}],102:[function(a,b,c){function d(a,b,c){return a*(1-c)+b*c}b.exports=d,d.number=d,d.vec2=function(a,b,c){return[d(a[0],b[0],c),d(a[1],b[1],c)]},d.color=function(a,b,c){return[d(a[0],b[0],c),d(a[1],b[1],c),d(a[2],b[2],c),d(a[3],b[3],c)]},d.array=function(a,b,c){return a.map(function(a,e){return d(a,b[e],c)})}},{}],103:[function(a,b,c){function d(a,b,c){if(c=c||e.ACCESS_TOKEN,!c&&e.REQUIRE_ACCESS_TOKEN)throw new Error("An API access token is required to use Mapbox GL. See https://www.mapbox.com/developers/api/#access-tokens");if(a=a.replace(/^mapbox:\/\//,e.API_URL+b),a+=-1!==a.indexOf("?")?"&access_token=":"?access_token=",e.REQUIRE_ACCESS_TOKEN){if("s"===c[0])throw new Error("Use a public access token (pk.*) with Mapbox GL JS, not a secret access token (sk.*). See https://www.mapbox.com/developers/api/#access-tokens");a+=c}return a}var e=a("./config"),f=a("./browser");b.exports.normalizeStyleURL=function(a,b){if(!a.match(/^mapbox:\/\/styles\//))return a;var c=a.split("/"),e=c[3],f=c[4],g=c[5]?"/draft":"";return d("mapbox://"+e+"/"+f+g,"/styles/v1/",b)},b.exports.normalizeSourceURL=function(a,b){return a.match(/^mapbox:\/\//)?d(a+".json","/v4/",b)+"&secure":a},b.exports.normalizeGlyphsURL=function(a,b){if(!a.match(/^mapbox:\/\//))return a;var c=a.split("/")[3];return d("mapbox://"+c+"/{fontstack}/{range}.pbf","/fonts/v1/",b)},b.exports.normalizeSpriteURL=function(a,b,c,e){if(!a.match(/^mapbox:\/\/sprites\//))return a+b+c;var f=a.split("/"),g=f[3],h=f[4],i=f[5]?"/draft":"";return d("mapbox://"+g+"/"+h+i+"/sprite"+b+c,"/styles/v1/",e)},b.exports.normalizeTileURL=function(a,b){return b&&b.match(/^mapbox:\/\//)?a.replace(/\.((?:png|jpg)\d*)(?=$|\?)/,f.devicePixelRatio>=2?"@2x.$1":".$1"):a}},{"./browser":95,"./config":99}],104:[function(a,b,c){function d(a,b){this.max=a,this.onRemove=b,this.reset()}b.exports=d,d.prototype.reset=function(){for(var a in this.list)this.onRemove(this.list[a]);return this.list={},this.order=[],this},d.prototype.add=function(a,b){if(this.list[a]=b,this.order.push(a),this.order.length>this.max){var c=this.get(this.order[0]);c&&this.onRemove(c)}return this},d.prototype.has=function(a){return a in this.list},d.prototype.keys=function(){return this.order},d.prototype.get=function(a){if(!this.has(a))return null;var b=this.list[a];return delete this.list[a],this.order.splice(this.order.indexOf(a),1),b}},{}],105:[function(a,b,c){function d(a,b){return b.replace(/{([^{}()\[\]<>$=:;.,^]+)}/g,function(b,c){return c in a?a[c]:""})}b.exports=d},{}],106:[function(a,b,c){var d=a("unitbezier"),e=a("../geo/coordinate");c.easeCubicInOut=function(a){if(0>=a)return 0;if(a>=1)return 1;var b=a*a,c=b*a;return 4*(.5>a?c:3*(a-b)+c-.75)},c.bezier=function(a,b,c,e){var f=new d(a,b,c,e);return function(a){return f.solve(a)}},c.ease=c.bezier(.25,.1,.25,1),c.premultiply=function(a){return a[0]*=a[3],a[1]*=a[3],a[2]*=a[3],a},c.clamp=function(a,b,c){return Math.min(c,Math.max(b,a))},c.wrap=function(a,b,c){var d=c-b,e=((a-b)%d+d)%d+b;return e===b?c:e},c.coalesce=function(){for(var a=0;a<arguments.length;a++){var b=arguments[a];if(null!==b&&void 0!==b)return b}},c.asyncEach=function(a,b,c){function d(){0===--e&&c()}var e=a.length;if(0===e)return c();for(var f=0;f<a.length;f++)b(a[f],d)},c.asyncAll=function(a,b,c){var d=a.length,e=new Array(a.length),f=null;a.forEach(function(a,g){b(a,function(a,b){a&&(f=a),e[g]=b,0===--d&&c(f,e)})})},c.keysDifference=function(a,b){var c=[];for(var d in a)d in b||c.push(d);return c},c.extend=function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)a[d]=c[d]}return a},c.extendAll=function(a,b){for(var c in b)Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c));return a},c.inherit=function(a,b){var d="function"==typeof a?a.prototype:a,e=Object.create(d);return c.extendAll(e,b),e},c.pick=function(a,b){for(var c={},d=0;d<b.length;d++){var e=b[d];e in a&&(c[e]=a[e])}return c};var f=1;c.uniqueId=function(){return f++},c.throttle=function(a,b,c){var d,e,f,g;return g=function(){d=!1,e&&(f.apply(c,e),e=!1)},f=function(){d?e=arguments:(a.apply(c,arguments),setTimeout(g,b),d=!0)}},c.debounce=function(a,b){var c,d;return function(){d=arguments,clearTimeout(c),c=setTimeout(function(){a.apply(null,d)},b)}},c.bindAll=function(a,b){a.forEach(function(a){b[a]=b[a].bind(b)})},c.bindHandlers=function(a){for(var b in a)"function"==typeof a[b]&&0===b.indexOf("_on")&&(a[b]=a[b].bind(a))},c.setOptions=function(a,b){a.hasOwnProperty("options")||(a.options=a.options?Object.create(a.options):{});for(var c in b)a.options[c]=b[c];return a.options},c.getCoordinatesCenter=function(a){for(var b=1/0,c=1/0,d=-(1/0),f=-(1/0),g=0;g<a.length;g++)b=Math.min(b,a[g].column),c=Math.min(c,a[g].row),d=Math.max(d,a[g].column),f=Math.max(f,a[g].row);var h=d-b,i=f-c,j=Math.max(h,i);return new e((b+d)/2,(c+f)/2,0).zoomTo(Math.floor(-Math.log(j)/Math.LN2))}},{"../geo/coordinate":19,unitbezier:141}],107:[function(a,b,c){function d(a){return a=Math.round(a),0>a?0:a>255?255:a}function e(a){return 0>a?0:a>1?1:a}function f(a){return d("%"===a[a.length-1]?parseFloat(a)/100*255:parseInt(a))}function g(a){return e("%"===a[a.length-1]?parseFloat(a)/100:parseFloat(a))}function h(a,b,c){return 0>c?c+=1:c>1&&(c-=1),1>6*c?a+(b-a)*c*6:1>2*c?b:2>3*c?a+(b-a)*(2/3-c)*6:a}function i(a){var b=a.replace(/ /g,"").toLowerCase();if(b in j)return j[b].slice();if("#"===b[0]){if(4===b.length){var c=parseInt(b.substr(1),16);return c>=0&&4095>=c?[(3840&c)>>4|(3840&c)>>8,240&c|(240&c)>>4,15&c|(15&c)<<4,1]:null}if(7===b.length){var c=parseInt(b.substr(1),16);return c>=0&&16777215>=c?[(16711680&c)>>16,(65280&c)>>8,255&c,1]:null}return null}var e=b.indexOf("("),i=b.indexOf(")");if(-1!==e&&i+1===b.length){var k=b.substr(0,e),l=b.substr(e+1,i-(e+1)).split(","),m=1;switch(k){case"rgba":if(4!==l.length)return null;m=g(l.pop());case"rgb":return 3!==l.length?null:[f(l[0]),f(l[1]),f(l[2]),m];case"hsla":if(4!==l.length)return null;m=g(l.pop());case"hsl":if(3!==l.length)return null;var n=(parseFloat(l[0])%360+360)%360/360,o=g(l[1]),p=g(l[2]),q=.5>=p?p*(o+1):p+o-p*o,r=2*p-q;return[d(255*h(r,q,n+1/3)),d(255*h(r,q,n)),d(255*h(r,q,n-1/3)),m];default:return null}}return null}var j={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};try{c.parseCSSColor=i}catch(a){}},{}],108:[function(a,b,c){function d(a){return function(b,c,d){return"$type"===c?"t"+a+h.indexOf(d):"p["+JSON.stringify(c)+"]"+a+JSON.stringify(d)}}function e(a){var b=d(a);return function(a,c,d){return"$type"===c?b(a,c,d):"typeof(p["+JSON.stringify(c)+"]) === typeof("+JSON.stringify(d)+") && "+b(a,c,d)}}function f(a){return i[a[0]].apply(a,a)}function g(){return!0}var h=["Unknown","Point","LineString","Polygon"],i={"==":d("==="),"!=":d("!=="),">":e(">"),"<":e("<"),"<=":e("<="),">=":e(">="),in:function(a,b){return"(function(){"+Array.prototype.slice.call(arguments,2).map(function(c){return"if ("+i["=="](a,b,c)+") return true;"}).join("")+"return false;})()"},"!in":function(){return"!("+i.in.apply(this,arguments)+")"},any:function(){return Array.prototype.slice.call(arguments,1).map(function(a){return"("+f(a)+")"}).join("||")||"false"},all:function(){return Array.prototype.slice.call(arguments,1).map(function(a){return"("+f(a)+")"}).join("&&")||"true"},none:function(){return"!("+i.any.apply(this,arguments)+")"}};b.exports=function(a){if(!a)return g;var b="var p = f.properties || f.tags || {}, t = f.type; return "+f(a)+";";return new Function("f",b)}},{}],109:[function(a,b,c){function d(a,b,c,d,g,h,i,j){if(c/=b,d/=b,i>=c&&d>=j)return a;if(i>d||c>j)return null;for(var k=[],l=0;l<a.length;l++){var m,n,o=a[l],p=o.geometry,q=o.type;if(m=o.min[g],n=o.max[g],m>=c&&d>=n)k.push(o);else if(!(m>d||c>n)){var r=1===q?e(p,c,d,g):f(p,c,d,g,h,3===q);r.length&&k.push({geometry:r,type:q,tags:a[l].tags||null,min:o.min,max:o.max})}}return k.length?k:null}function e(a,b,c,d){for(var e=[],f=0;f<a.length;f++){var g=a[f],h=g[d];h>=b&&c>=h&&e.push(g)}return e}function f(a,b,c,d,e,f){for(var h=[],i=0;i<a.length;i++){var j,k,l,m=0,n=0,o=null,p=a[i],q=p.area,r=p.dist,s=p.length,t=[];for(k=0;s-1>k;k++)j=o||p[k],o=p[k+1],m=n||j[d],n=o[d],b>m?n>c?(t.push(e(j,o,b),e(j,o,c)),f||(t=g(h,t,q,r))):n>=b&&t.push(e(j,o,b)):m>c?b>n?(t.push(e(j,o,c),e(j,o,b)),f||(t=g(h,t,q,r))):c>=n&&t.push(e(j,o,c)):(t.push(j),b>n?(t.push(e(j,o,b)),f||(t=g(h,t,q,r))):n>c&&(t.push(e(j,o,c)),f||(t=g(h,t,q,r))));j=p[s-1],m=j[d],m>=b&&c>=m&&t.push(j),l=t[t.length-1],f&&l&&(t[0][0]!==l[0]||t[0][1]!==l[1])&&t.push(t[0]),g(h,t,q,r)}return h}function g(a,b,c,d){return b.length&&(b.area=c,b.dist=d,a.push(b)),[]}b.exports=d},{}],110:[function(a,b,c){function d(a,b){var c=[];if("FeatureCollection"===a.type)for(var d=0;d<a.features.length;d++)e(c,a.features[d],b);else"Feature"===a.type?e(c,a,b):e(c,{geometry:a},b);return c}function e(a,b,c){var d,i,j,k=b.geometry,l=k.type,m=k.coordinates,n=b.properties;if("Point"===l)a.push(f(n,1,[h(m)]));else if("MultiPoint"===l)a.push(f(n,1,g(m)));else if("LineString"===l)a.push(f(n,2,[g(m,c)]));else if("MultiLineString"===l||"Polygon"===l){for(j=[],d=0;d<m.length;d++)j.push(g(m[d],c));a.push(f(n,"Polygon"===l?3:2,j))}else if("MultiPolygon"===l){for(j=[],d=0;d<m.length;d++)for(i=0;i<m[d].length;i++)j.push(g(m[d][i],c));a.push(f(n,3,j))}else{if("GeometryCollection"!==l)throw new Error("Input data is not a valid GeoJSON object.");for(d=0;d<k.geometries.length;d++)e(a,{geometry:k.geometries[d],properties:n},c)}}function f(a,b,c){var d={geometry:c,type:b,tags:a||null,min:[2,1],max:[-1,0]};return j(d),d}function g(a,b){for(var c=[],d=0;d<a.length;d++)c.push(h(a[d]));return b&&(l(c,b),i(c)),c}function h(a){var b=Math.sin(a[1]*Math.PI/180),c=a[0]/360+.5,d=.5-.25*Math.log((1+b)/(1-b))/Math.PI;return d=-1>d?-1:d>1?1:d,[c,d,0]}function i(a){for(var b,c,d=0,e=0,f=0;f<a.length-1;f++)b=c||a[f],c=a[f+1],d+=b[0]*c[1]-c[0]*b[1],e+=Math.abs(c[0]-b[0])+Math.abs(c[1]-b[1]);a.area=Math.abs(d/2),a.dist=e}function j(a){var b=a.geometry,c=a.min,d=a.max;if(1===a.type)k(c,d,b);else for(var e=0;e<b.length;e++)k(c,d,b[e]);return a}function k(a,b,c){for(var d,e=0;e<c.length;e++)d=c[e],a[0]=Math.min(d[0],a[0]),b[0]=Math.max(d[0],b[0]),a[1]=Math.min(d[1],a[1]),b[1]=Math.max(d[1],b[1])}b.exports=d;var l=a("./simplify")},{"./simplify":112}],111:[function(a,b,c){function d(a,b){return new e(a,b)}function e(a,b){b=this.options=i(Object.create(this.options),b);var c=b.debug;c&&console.time("preprocess data");var d=1<<b.maxZoom,e=k(a,b.tolerance/(d*b.extent));this.tiles={},this.tileCoords=[],c&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",b.indexMaxZoom,b.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),e=n(e,b.buffer/b.extent,g),e.length&&this.splitTile(e,0,0,0),c&&(e.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function f(a,b,c){return 32*((1<<a)*c+b)+a}function g(a,b,c){return[c,(c-a[0])*(b[1]-a[1])/(b[0]-a[0])+a[1],1]}function h(a,b,c){return[(c-a[1])*(b[0]-a[0])/(b[1]-a[1])+a[0],c,1]}function i(a,b){for(var c in b)a[c]=b[c];return a}function j(a,b,c){var d=a.source;if(1!==d.length)return!1;var e=d[0];if(3!==e.type||e.geometry.length>1)return!1;var f=e.geometry[0].length;if(5!==f)return!1;for(var g=0;f>g;g++){var h=l.point(e.geometry[0][g],b,a.z2,a.x,a.y);if(h[0]!==-c&&h[0]!==b+c||h[1]!==-c&&h[1]!==b+c)return!1}return!0}b.exports=d;var k=a("./convert"),l=a("./transform"),m=a("./clip"),n=a("./wrap"),o=a("./tile");e.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,solidChildren:!1,tolerance:3,extent:4096,buffer:64,debug:0},e.prototype.splitTile=function(a,b,c,d,e,i,k){for(var l=[a,b,c,d],n=this.options,p=n.debug,q=null;l.length;){d=l.pop(),c=l.pop(),b=l.pop(),a=l.pop();var r=1<<b,s=f(b,c,d),t=this.tiles[s],u=b===n.maxZoom?0:n.tolerance/(r*n.extent);if(!t&&(p>1&&console.time("creation"),t=this.tiles[s]=o(a,r,c,d,u,b===n.maxZoom),this.tileCoords.push({z:b,x:c,y:d}),p)){p>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",b,c,d,t.numFeatures,t.numPoints,t.numSimplified),console.timeEnd("creation"));var v="z"+b;this.stats[v]=(this.stats[v]||0)+1,this.total++}if(t.source=a,e){if(b===n.maxZoom||b===e)continue;var w=1<<e-b;if(c!==Math.floor(i/w)||d!==Math.floor(k/w))continue}else if(b===n.indexMaxZoom||t.numPoints<=n.indexMaxPoints)continue;if(n.solidChildren||!j(t,n.extent,n.buffer)){t.source=null,p>1&&console.time("clipping");var x,y,z,A,B,C,D=.5*n.buffer/n.extent,E=.5-D,F=.5+D,G=1+D;x=y=z=A=null,B=m(a,r,c-D,c+F,0,g,t.min[0],t.max[0]),C=m(a,r,c+E,c+G,0,g,t.min[0],t.max[0]),B&&(x=m(B,r,d-D,d+F,1,h,t.min[1],t.max[1]),y=m(B,r,d+E,d+G,1,h,t.min[1],t.max[1])),C&&(z=m(C,r,d-D,d+F,1,h,t.min[1],t.max[1]),A=m(C,r,d+E,d+G,1,h,t.min[1],t.max[1])),p>1&&console.timeEnd("clipping"),x&&l.push(x,b+1,2*c,2*d),y&&l.push(y,b+1,2*c,2*d+1),z&&l.push(z,b+1,2*c+1,2*d),A&&l.push(A,b+1,2*c+1,2*d+1)}else e&&(q=b)}return q},e.prototype.getTile=function(a,b,c){var d=this.options,e=d.extent,g=d.debug,h=1<<a;b=(b%h+h)%h;var i=f(a,b,c);if(this.tiles[i])return l.tile(this.tiles[i],e);g>1&&console.log("drilling down to z%d-%d-%d",a,b,c);for(var k,m=a,n=b,o=c;!k&&m>0;)m--,n=Math.floor(n/2),o=Math.floor(o/2),k=this.tiles[f(m,n,o)];if(!k||!k.source)return null;if(g>1&&console.log("found parent tile z%d-%d-%d",m,n,o),j(k,e,d.buffer))return l.tile(k,e);g>1&&console.time("drilling down");var p=this.splitTile(k.source,m,n,o,a,b,c);if(g>1&&console.timeEnd("drilling down"),null!==p){var q=1<<a-p;i=f(p,Math.floor(b/q),Math.floor(c/q))}return this.tiles[i]?l.tile(this.tiles[i],e):null}},{"./clip":109,"./convert":110,"./tile":113,"./transform":114,"./wrap":115}],112:[function(a,b,c){function d(a,b){var c,d,f,g,h=b*b,i=a.length,j=0,k=i-1,l=[];for(a[j][2]=1,a[k][2]=1;k;){for(d=0,c=j+1;k>c;c++)f=e(a[c],a[j],a[k]),f>d&&(g=c,d=f);d>h?(a[g][2]=d,l.push(j),l.push(g),j=g):(k=l.pop(),j=l.pop())}}function e(a,b,c){var d=b[0],e=b[1],f=c[0],g=c[1],h=a[0],i=a[1],j=f-d,k=g-e;if(0!==j||0!==k){var l=((h-d)*j+(i-e)*k)/(j*j+k*k);l>1?(d=f,e=g):l>0&&(d+=j*l,e+=k*l)}return j=h-d,k=i-e,j*j+k*k}b.exports=d},{}],113:[function(a,b,c){function d(a,b,c,d,f,g){for(var h={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:c,y:d,z2:b,transformed:!1,min:[2,1],max:[-1,0]},i=0;i<a.length;i++){h.numFeatures++,e(h,a[i],f,g);var j=a[i].min,k=a[i].max;j[0]<h.min[0]&&(h.min[0]=j[0]),j[1]<h.min[1]&&(h.min[1]=j[1]),k[0]>h.max[0]&&(h.max[0]=k[0]),k[1]>h.max[1]&&(h.max[1]=k[1])}return h}function e(a,b,c,d){var e,f,g,h,i=b.geometry,j=b.type,k=[],l=c*c;if(1===j)for(e=0;e<i.length;e++)k.push(i[e]),a.numPoints++,a.numSimplified++;else for(e=0;e<i.length;e++)if(g=i[e],d||!(2===j&&g.dist<c||3===j&&g.area<l)){var m=[];for(f=0;f<g.length;f++)h=g[f],(d||h[2]>l)&&(m.push(h),a.numSimplified++),a.numPoints++;k.push(m)}else a.numPoints+=g.length;k.length&&a.features.push({geometry:k,type:j,tags:b.tags||null})}b.exports=d},{}],114:[function(a,b,c){function d(a,b){if(a.transformed)return a;var c,d,f,g=a.z2,h=a.x,i=a.y;for(c=0;c<a.features.length;c++){var j=a.features[c],k=j.geometry,l=j.type;if(1===l)for(d=0;d<k.length;d++)k[d]=e(k[d],b,g,h,i);else for(d=0;d<k.length;d++){var m=k[d];for(f=0;f<m.length;f++)m[f]=e(m[f],b,g,h,i)}}return a.transformed=!0,a}function e(a,b,c,d,e){var f=Math.round(b*(a[0]*c-d)),g=Math.round(b*(a[1]*c-e));return[f,g]}c.tile=d,c.point=e},{}],115:[function(a,b,c){function d(a,b,c){var d=a,f=g(a,1,-1-b,b,0,c,-1,2),h=g(a,1,1-b,2+b,0,c,-1,2);return(f||h)&&(d=g(a,1,-b,1+b,0,c,-1,2),f&&(d=e(f,1).concat(d)),h&&(d=d.concat(e(h,-1)))),d}function e(a,b){for(var c=[],d=0;d<a.length;d++){var e,g=a[d],h=g.type;if(1===h)e=f(g.geometry,b);else{e=[];for(var i=0;i<g.geometry.length;i++)e.push(f(g.geometry[i],b))}c.push({geometry:e,type:h,tags:g.tags,min:[g.min[0]+b,g.min[1]],max:[g.max[0]+b,g.max[1]]})}return c}function f(a,b){var c=[];c.area=a.area,c.dist=a.dist;for(var d=0;d<a.length;d++)c.push([a[d][0]+b,a[d][1],a[d][2]]);return c}var g=a("./clip");b.exports=d},{"./clip":109}],116:[function(a,b,c){c.glMatrix=a("./gl-matrix/common.js"),c.mat2=a("./gl-matrix/mat2.js"),c.mat2d=a("./gl-matrix/mat2d.js"),c.mat3=a("./gl-matrix/mat3.js"),c.mat4=a("./gl-matrix/mat4.js"),c.quat=a("./gl-matrix/quat.js"),c.vec2=a("./gl-matrix/vec2.js"),c.vec3=a("./gl-matrix/vec3.js"),c.vec4=a("./gl-matrix/vec4.js")},{"./gl-matrix/common.js":117,"./gl-matrix/mat2.js":118,"./gl-matrix/mat2d.js":119,"./gl-matrix/mat3.js":120,"./gl-matrix/mat4.js":121,"./gl-matrix/quat.js":122,"./gl-matrix/vec2.js":123,"./gl-matrix/vec3.js":124,"./gl-matrix/vec4.js":125}],117:[function(a,b,c){var d={};d.EPSILON=1e-6,d.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,d.RANDOM=Math.random,d.setMatrixArrayType=function(a){GLMAT_ARRAY_TYPE=a};var e=Math.PI/180;d.toRadian=function(a){return a*e},b.exports=d},{}],118:[function(a,b,c){var d=a("./common.js"),e={};e.create=function(){var a=new d.ARRAY_TYPE(4);return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a},e.clone=function(a){var b=new d.ARRAY_TYPE(4);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b},e.copy=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a},e.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a},e.transpose=function(a,b){if(a===b){var c=b[1];a[1]=b[2],a[2]=c}else a[0]=b[0],a[1]=b[2],a[2]=b[1],a[3]=b[3];return a},e.invert=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c*f-e*d;return g?(g=1/g,a[0]=f*g,a[1]=-d*g,a[2]=-e*g,a[3]=c*g,a):null},e.adjoint=function(a,b){var c=b[0];return a[0]=b[3],a[1]=-b[1],a[2]=-b[2],a[3]=c,a},e.determinant=function(a){return a[0]*a[3]-a[2]*a[1]},e.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=c[0],i=c[1],j=c[2],k=c[3];return a[0]=d*h+f*i,a[1]=e*h+g*i,a[2]=d*j+f*k,a[3]=e*j+g*k,a},e.mul=e.multiply,e.rotate=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=Math.sin(c),i=Math.cos(c);return a[0]=d*i+f*h,a[1]=e*i+g*h,a[2]=d*-h+f*i,a[3]=e*-h+g*i,a},e.scale=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=c[0],i=c[1];return a[0]=d*h,a[1]=e*h,a[2]=f*i,a[3]=g*i,a},e.fromRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);return a[0]=d,a[1]=c,a[2]=-c,a[3]=d,a},e.fromScaling=function(a,b){return a[0]=b[0],a[1]=0,a[2]=0,a[3]=b[1],a},e.str=function(a){return"mat2("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"},e.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2))},e.LDU=function(a,b,c,d){return a[2]=d[2]/d[0],c[0]=d[0],c[1]=d[1],c[3]=d[3]-a[2]*c[1],[a,b,c]},b.exports=e},{"./common.js":117}],119:[function(a,b,c){var d=a("./common.js"),e={};e.create=function(){var a=new d.ARRAY_TYPE(6);return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a[4]=0,a[5]=0,a},e.clone=function(a){var b=new d.ARRAY_TYPE(6);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b},e.copy=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a},e.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a[4]=0,a[5]=0,a},e.invert=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=c*f-d*e;return i?(i=1/i,a[0]=f*i,a[1]=-d*i,a[2]=-e*i,a[3]=c*i,a[4]=(e*h-f*g)*i,a[5]=(d*g-c*h)*i,a):null},e.determinant=function(a){return a[0]*a[3]-a[1]*a[2]},e.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=c[0],k=c[1],l=c[2],m=c[3],n=c[4],o=c[5];return a[0]=d*j+f*k,a[1]=e*j+g*k,a[2]=d*l+f*m,a[3]=e*l+g*m,a[4]=d*n+f*o+h,a[5]=e*n+g*o+i,a},e.mul=e.multiply,e.rotate=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=Math.sin(c),k=Math.cos(c);return a[0]=d*k+f*j,a[1]=e*k+g*j,a[2]=d*-j+f*k,a[3]=e*-j+g*k,a[4]=h,a[5]=i,a},e.scale=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=c[0],k=c[1];return a[0]=d*j,a[1]=e*j,a[2]=f*k,a[3]=g*k,a[4]=h,a[5]=i,a},e.translate=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=c[0],k=c[1];return a[0]=d,a[1]=e,a[2]=f,a[3]=g,a[4]=d*j+f*k+h,a[5]=e*j+g*k+i,a},e.fromRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);return a[0]=d,a[1]=c,a[2]=-c,a[3]=d,a[4]=0,a[5]=0,a},e.fromScaling=function(a,b){return a[0]=b[0],a[1]=0,a[2]=0,a[3]=b[1],a[4]=0,a[5]=0,a},e.fromTranslation=function(a,b){return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a[4]=b[0],a[5]=b[1],a},e.str=function(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"},e.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+1)},b.exports=e},{"./common.js":117}],120:[function(a,b,c){var d=a("./common.js"),e={};e.create=function(){var a=new d.ARRAY_TYPE(9);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},e.fromMat4=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[4],a[4]=b[5],a[5]=b[6],a[6]=b[8],a[7]=b[9],a[8]=b[10],a},e.clone=function(a){var b=new d.ARRAY_TYPE(9);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b},e.copy=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a},e.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},e.transpose=function(a,b){if(a===b){var c=b[1],d=b[2],e=b[5];a[1]=b[3],a[2]=b[6],a[3]=c,a[5]=b[7],a[6]=d,a[7]=e}else a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8];return a},e.invert=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=k*g-h*j,m=-k*f+h*i,n=j*f-g*i,o=c*l+d*m+e*n;return o?(o=1/o,a[0]=l*o,a[1]=(-k*d+e*j)*o,a[2]=(h*d-e*g)*o,a[3]=m*o,a[4]=(k*c-e*i)*o,a[5]=(-h*c+e*f)*o,a[6]=n*o,a[7]=(-j*c+d*i)*o,a[8]=(g*c-d*f)*o,a):null},e.adjoint=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8];return a[0]=g*k-h*j,a[1]=e*j-d*k,a[2]=d*h-e*g,a[3]=h*i-f*k,a[4]=c*k-e*i,a[5]=e*f-c*h,a[6]=f*j-g*i,a[7]=d*i-c*j,a[8]=c*g-d*f,a},e.determinant=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8];return b*(j*f-g*i)+c*(-j*e+g*h)+d*(i*e-f*h)},e.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=c[0],n=c[1],o=c[2],p=c[3],q=c[4],r=c[5],s=c[6],t=c[7],u=c[8];return a[0]=m*d+n*g+o*j,a[1]=m*e+n*h+o*k,a[2]=m*f+n*i+o*l,a[3]=p*d+q*g+r*j,a[4]=p*e+q*h+r*k,a[5]=p*f+q*i+r*l,a[6]=s*d+t*g+u*j,a[7]=s*e+t*h+u*k,a[8]=s*f+t*i+u*l,a},e.mul=e.multiply,e.translate=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=c[0],n=c[1];return a[0]=d,a[1]=e,a[2]=f,a[3]=g,a[4]=h,a[5]=i,a[6]=m*d+n*g+j,a[7]=m*e+n*h+k,a[8]=m*f+n*i+l,a},e.rotate=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=Math.sin(c),n=Math.cos(c);return a[0]=n*d+m*g,a[1]=n*e+m*h,a[2]=n*f+m*i,a[3]=n*g-m*d,a[4]=n*h-m*e,a[5]=n*i-m*f,a[6]=j,a[7]=k,a[8]=l,a},e.scale=function(a,b,c){var d=c[0],e=c[1];return a[0]=d*b[0],a[1]=d*b[1],a[2]=d*b[2],a[3]=e*b[3],a[4]=e*b[4],a[5]=e*b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a},e.fromTranslation=function(a,b){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=b[0],a[7]=b[1],a[8]=1,a},e.fromRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);return a[0]=d,a[1]=c,a[2]=0,a[3]=-c,a[4]=d,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},e.fromScaling=function(a,b){return a[0]=b[0],a[1]=0,a[2]=0,a[3]=0,a[4]=b[1],a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},e.fromMat2d=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=0,a[3]=b[2],a[4]=b[3],a[5]=0,a[6]=b[4],a[7]=b[5],a[8]=1,a},e.fromQuat=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c+c,h=d+d,i=e+e,j=c*g,k=d*g,l=d*h,m=e*g,n=e*h,o=e*i,p=f*g,q=f*h,r=f*i;return a[0]=1-l-o,a[3]=k-r,a[6]=m+q,a[1]=k+r,a[4]=1-j-o,a[7]=n-p,a[2]=m-q,a[5]=n+p,a[8]=1-j-l,a},e.normalFromMat4=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=b[9],m=b[10],n=b[11],o=b[12],p=b[13],q=b[14],r=b[15],s=c*h-d*g,t=c*i-e*g,u=c*j-f*g,v=d*i-e*h,w=d*j-f*h,x=e*j-f*i,y=k*p-l*o,z=k*q-m*o,A=k*r-n*o,B=l*q-m*p,C=l*r-n*p,D=m*r-n*q,E=s*D-t*C+u*B+v*A-w*z+x*y;return E?(E=1/E,a[0]=(h*D-i*C+j*B)*E,a[1]=(i*A-g*D-j*z)*E,a[2]=(g*C-h*A+j*y)*E,a[3]=(e*C-d*D-f*B)*E,a[4]=(c*D-e*A+f*z)*E,a[5]=(d*A-c*C-f*y)*E,a[6]=(p*x-q*w+r*v)*E,a[7]=(q*u-o*x-r*t)*E,a[8]=(o*w-p*u+r*s)*E,a):null},e.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"},e.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))},b.exports=e},{"./common.js":117}],121:[function(a,b,c){var d=a("./common.js"),e={};e.create=function(){var a=new d.ARRAY_TYPE(16);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},e.clone=function(a){var b=new d.ARRAY_TYPE(16);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15],b},e.copy=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a},e.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},e.transpose=function(a,b){if(a===b){var c=b[1],d=b[2],e=b[3],f=b[6],g=b[7],h=b[11];a[1]=b[4],
a[2]=b[8],a[3]=b[12],a[4]=c,a[6]=b[9],a[7]=b[13],a[8]=d,a[9]=f,a[11]=b[14],a[12]=e,a[13]=g,a[14]=h}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a},e.invert=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=b[9],m=b[10],n=b[11],o=b[12],p=b[13],q=b[14],r=b[15],s=c*h-d*g,t=c*i-e*g,u=c*j-f*g,v=d*i-e*h,w=d*j-f*h,x=e*j-f*i,y=k*p-l*o,z=k*q-m*o,A=k*r-n*o,B=l*q-m*p,C=l*r-n*p,D=m*r-n*q,E=s*D-t*C+u*B+v*A-w*z+x*y;return E?(E=1/E,a[0]=(h*D-i*C+j*B)*E,a[1]=(e*C-d*D-f*B)*E,a[2]=(p*x-q*w+r*v)*E,a[3]=(m*w-l*x-n*v)*E,a[4]=(i*A-g*D-j*z)*E,a[5]=(c*D-e*A+f*z)*E,a[6]=(q*u-o*x-r*t)*E,a[7]=(k*x-m*u+n*t)*E,a[8]=(g*C-h*A+j*y)*E,a[9]=(d*A-c*C-f*y)*E,a[10]=(o*w-p*u+r*s)*E,a[11]=(l*u-k*w-n*s)*E,a[12]=(h*z-g*B-i*y)*E,a[13]=(c*B-d*z+e*y)*E,a[14]=(p*t-o*v-q*s)*E,a[15]=(k*v-l*t+m*s)*E,a):null},e.adjoint=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=b[9],m=b[10],n=b[11],o=b[12],p=b[13],q=b[14],r=b[15];return a[0]=h*(m*r-n*q)-l*(i*r-j*q)+p*(i*n-j*m),a[1]=-(d*(m*r-n*q)-l*(e*r-f*q)+p*(e*n-f*m)),a[2]=d*(i*r-j*q)-h*(e*r-f*q)+p*(e*j-f*i),a[3]=-(d*(i*n-j*m)-h*(e*n-f*m)+l*(e*j-f*i)),a[4]=-(g*(m*r-n*q)-k*(i*r-j*q)+o*(i*n-j*m)),a[5]=c*(m*r-n*q)-k*(e*r-f*q)+o*(e*n-f*m),a[6]=-(c*(i*r-j*q)-g*(e*r-f*q)+o*(e*j-f*i)),a[7]=c*(i*n-j*m)-g*(e*n-f*m)+k*(e*j-f*i),a[8]=g*(l*r-n*p)-k*(h*r-j*p)+o*(h*n-j*l),a[9]=-(c*(l*r-n*p)-k*(d*r-f*p)+o*(d*n-f*l)),a[10]=c*(h*r-j*p)-g*(d*r-f*p)+o*(d*j-f*h),a[11]=-(c*(h*n-j*l)-g*(d*n-f*l)+k*(d*j-f*h)),a[12]=-(g*(l*q-m*p)-k*(h*q-i*p)+o*(h*m-i*l)),a[13]=c*(l*q-m*p)-k*(d*q-e*p)+o*(d*m-e*l),a[14]=-(c*(h*q-i*p)-g*(d*q-e*p)+o*(d*i-e*h)),a[15]=c*(h*m-i*l)-g*(d*m-e*l)+k*(d*i-e*h),a},e.determinant=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=a[9],l=a[10],m=a[11],n=a[12],o=a[13],p=a[14],q=a[15],r=b*g-c*f,s=b*h-d*f,t=b*i-e*f,u=c*h-d*g,v=c*i-e*g,w=d*i-e*h,x=j*o-k*n,y=j*p-l*n,z=j*q-m*n,A=k*p-l*o,B=k*q-m*o,C=l*q-m*p;return r*C-s*B+t*A+u*z-v*y+w*x},e.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=b[9],n=b[10],o=b[11],p=b[12],q=b[13],r=b[14],s=b[15],t=c[0],u=c[1],v=c[2],w=c[3];return a[0]=t*d+u*h+v*l+w*p,a[1]=t*e+u*i+v*m+w*q,a[2]=t*f+u*j+v*n+w*r,a[3]=t*g+u*k+v*o+w*s,t=c[4],u=c[5],v=c[6],w=c[7],a[4]=t*d+u*h+v*l+w*p,a[5]=t*e+u*i+v*m+w*q,a[6]=t*f+u*j+v*n+w*r,a[7]=t*g+u*k+v*o+w*s,t=c[8],u=c[9],v=c[10],w=c[11],a[8]=t*d+u*h+v*l+w*p,a[9]=t*e+u*i+v*m+w*q,a[10]=t*f+u*j+v*n+w*r,a[11]=t*g+u*k+v*o+w*s,t=c[12],u=c[13],v=c[14],w=c[15],a[12]=t*d+u*h+v*l+w*p,a[13]=t*e+u*i+v*m+w*q,a[14]=t*f+u*j+v*n+w*r,a[15]=t*g+u*k+v*o+w*s,a},e.mul=e.multiply,e.translate=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p=c[0],q=c[1],r=c[2];return b===a?(a[12]=b[0]*p+b[4]*q+b[8]*r+b[12],a[13]=b[1]*p+b[5]*q+b[9]*r+b[13],a[14]=b[2]*p+b[6]*q+b[10]*r+b[14],a[15]=b[3]*p+b[7]*q+b[11]*r+b[15]):(d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=b[9],n=b[10],o=b[11],a[0]=d,a[1]=e,a[2]=f,a[3]=g,a[4]=h,a[5]=i,a[6]=j,a[7]=k,a[8]=l,a[9]=m,a[10]=n,a[11]=o,a[12]=d*p+h*q+l*r+b[12],a[13]=e*p+i*q+m*r+b[13],a[14]=f*p+j*q+n*r+b[14],a[15]=g*p+k*q+o*r+b[15]),a},e.scale=function(a,b,c){var d=c[0],e=c[1],f=c[2];return a[0]=b[0]*d,a[1]=b[1]*d,a[2]=b[2]*d,a[3]=b[3]*d,a[4]=b[4]*e,a[5]=b[5]*e,a[6]=b[6]*e,a[7]=b[7]*e,a[8]=b[8]*f,a[9]=b[9]*f,a[10]=b[10]*f,a[11]=b[11]*f,a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a},e.rotate=function(a,b,c,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=e[0],E=e[1],F=e[2],G=Math.sqrt(D*D+E*E+F*F);return Math.abs(G)<d.EPSILON?null:(G=1/G,D*=G,E*=G,F*=G,f=Math.sin(c),g=Math.cos(c),h=1-g,i=b[0],j=b[1],k=b[2],l=b[3],m=b[4],n=b[5],o=b[6],p=b[7],q=b[8],r=b[9],s=b[10],t=b[11],u=D*D*h+g,v=E*D*h+F*f,w=F*D*h-E*f,x=D*E*h-F*f,y=E*E*h+g,z=F*E*h+D*f,A=D*F*h+E*f,B=E*F*h-D*f,C=F*F*h+g,a[0]=i*u+m*v+q*w,a[1]=j*u+n*v+r*w,a[2]=k*u+o*v+s*w,a[3]=l*u+p*v+t*w,a[4]=i*x+m*y+q*z,a[5]=j*x+n*y+r*z,a[6]=k*x+o*y+s*z,a[7]=l*x+p*y+t*z,a[8]=i*A+m*B+q*C,a[9]=j*A+n*B+r*C,a[10]=k*A+o*B+s*C,a[11]=l*A+p*B+t*C,b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a)},e.rotateX=function(a,b,c){var d=Math.sin(c),e=Math.cos(c),f=b[4],g=b[5],h=b[6],i=b[7],j=b[8],k=b[9],l=b[10],m=b[11];return b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[4]=f*e+j*d,a[5]=g*e+k*d,a[6]=h*e+l*d,a[7]=i*e+m*d,a[8]=j*e-f*d,a[9]=k*e-g*d,a[10]=l*e-h*d,a[11]=m*e-i*d,a},e.rotateY=function(a,b,c){var d=Math.sin(c),e=Math.cos(c),f=b[0],g=b[1],h=b[2],i=b[3],j=b[8],k=b[9],l=b[10],m=b[11];return b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[0]=f*e-j*d,a[1]=g*e-k*d,a[2]=h*e-l*d,a[3]=i*e-m*d,a[8]=f*d+j*e,a[9]=g*d+k*e,a[10]=h*d+l*e,a[11]=i*d+m*e,a},e.rotateZ=function(a,b,c){var d=Math.sin(c),e=Math.cos(c),f=b[0],g=b[1],h=b[2],i=b[3],j=b[4],k=b[5],l=b[6],m=b[7];return b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[0]=f*e+j*d,a[1]=g*e+k*d,a[2]=h*e+l*d,a[3]=i*e+m*d,a[4]=j*e-f*d,a[5]=k*e-g*d,a[6]=l*e-h*d,a[7]=m*e-i*d,a},e.fromTranslation=function(a,b){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=b[0],a[13]=b[1],a[14]=b[2],a[15]=1,a},e.fromScaling=function(a,b){return a[0]=b[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=b[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=b[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},e.fromRotation=function(a,b,c){var e,f,g,h=c[0],i=c[1],j=c[2],k=Math.sqrt(h*h+i*i+j*j);return Math.abs(k)<d.EPSILON?null:(k=1/k,h*=k,i*=k,j*=k,e=Math.sin(b),f=Math.cos(b),g=1-f,a[0]=h*h*g+f,a[1]=i*h*g+j*e,a[2]=j*h*g-i*e,a[3]=0,a[4]=h*i*g-j*e,a[5]=i*i*g+f,a[6]=j*i*g+h*e,a[7]=0,a[8]=h*j*g+i*e,a[9]=i*j*g-h*e,a[10]=j*j*g+f,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a)},e.fromXRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=d,a[6]=c,a[7]=0,a[8]=0,a[9]=-c,a[10]=d,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},e.fromYRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);return a[0]=d,a[1]=0,a[2]=-c,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=c,a[9]=0,a[10]=d,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},e.fromZRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);return a[0]=d,a[1]=c,a[2]=0,a[3]=0,a[4]=-c,a[5]=d,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},e.fromRotationTranslation=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=d+d,i=e+e,j=f+f,k=d*h,l=d*i,m=d*j,n=e*i,o=e*j,p=f*j,q=g*h,r=g*i,s=g*j;return a[0]=1-(n+p),a[1]=l+s,a[2]=m-r,a[3]=0,a[4]=l-s,a[5]=1-(k+p),a[6]=o+q,a[7]=0,a[8]=m+r,a[9]=o-q,a[10]=1-(k+n),a[11]=0,a[12]=c[0],a[13]=c[1],a[14]=c[2],a[15]=1,a},e.fromRotationTranslationScale=function(a,b,c,d){var e=b[0],f=b[1],g=b[2],h=b[3],i=e+e,j=f+f,k=g+g,l=e*i,m=e*j,n=e*k,o=f*j,p=f*k,q=g*k,r=h*i,s=h*j,t=h*k,u=d[0],v=d[1],w=d[2];return a[0]=(1-(o+q))*u,a[1]=(m+t)*u,a[2]=(n-s)*u,a[3]=0,a[4]=(m-t)*v,a[5]=(1-(l+q))*v,a[6]=(p+r)*v,a[7]=0,a[8]=(n+s)*w,a[9]=(p-r)*w,a[10]=(1-(l+o))*w,a[11]=0,a[12]=c[0],a[13]=c[1],a[14]=c[2],a[15]=1,a},e.fromRotationTranslationScaleOrigin=function(a,b,c,d,e){var f=b[0],g=b[1],h=b[2],i=b[3],j=f+f,k=g+g,l=h+h,m=f*j,n=f*k,o=f*l,p=g*k,q=g*l,r=h*l,s=i*j,t=i*k,u=i*l,v=d[0],w=d[1],x=d[2],y=e[0],z=e[1],A=e[2];return a[0]=(1-(p+r))*v,a[1]=(n+u)*v,a[2]=(o-t)*v,a[3]=0,a[4]=(n-u)*w,a[5]=(1-(m+r))*w,a[6]=(q+s)*w,a[7]=0,a[8]=(o+t)*x,a[9]=(q-s)*x,a[10]=(1-(m+p))*x,a[11]=0,a[12]=c[0]+y-(a[0]*y+a[4]*z+a[8]*A),a[13]=c[1]+z-(a[1]*y+a[5]*z+a[9]*A),a[14]=c[2]+A-(a[2]*y+a[6]*z+a[10]*A),a[15]=1,a},e.fromQuat=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c+c,h=d+d,i=e+e,j=c*g,k=d*g,l=d*h,m=e*g,n=e*h,o=e*i,p=f*g,q=f*h,r=f*i;return a[0]=1-l-o,a[1]=k+r,a[2]=m-q,a[3]=0,a[4]=k-r,a[5]=1-j-o,a[6]=n+p,a[7]=0,a[8]=m+q,a[9]=n-p,a[10]=1-j-l,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},e.frustum=function(a,b,c,d,e,f,g){var h=1/(c-b),i=1/(e-d),j=1/(f-g);return a[0]=2*f*h,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*f*i,a[6]=0,a[7]=0,a[8]=(c+b)*h,a[9]=(e+d)*i,a[10]=(g+f)*j,a[11]=-1,a[12]=0,a[13]=0,a[14]=g*f*2*j,a[15]=0,a},e.perspective=function(a,b,c,d,e){var f=1/Math.tan(b/2),g=1/(d-e);return a[0]=f/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=f,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(e+d)*g,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*e*d*g,a[15]=0,a},e.perspectiveFromFieldOfView=function(a,b,c,d){var e=Math.tan(b.upDegrees*Math.PI/180),f=Math.tan(b.downDegrees*Math.PI/180),g=Math.tan(b.leftDegrees*Math.PI/180),h=Math.tan(b.rightDegrees*Math.PI/180),i=2/(g+h),j=2/(e+f);return a[0]=i,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=j,a[6]=0,a[7]=0,a[8]=-((g-h)*i*.5),a[9]=(e-f)*j*.5,a[10]=d/(c-d),a[11]=-1,a[12]=0,a[13]=0,a[14]=d*c/(c-d),a[15]=0,a},e.ortho=function(a,b,c,d,e,f,g){var h=1/(b-c),i=1/(d-e),j=1/(f-g);return a[0]=-2*h,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*i,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*j,a[11]=0,a[12]=(b+c)*h,a[13]=(e+d)*i,a[14]=(g+f)*j,a[15]=1,a},e.lookAt=function(a,b,c,f){var g,h,i,j,k,l,m,n,o,p,q=b[0],r=b[1],s=b[2],t=f[0],u=f[1],v=f[2],w=c[0],x=c[1],y=c[2];return Math.abs(q-w)<d.EPSILON&&Math.abs(r-x)<d.EPSILON&&Math.abs(s-y)<d.EPSILON?e.identity(a):(m=q-w,n=r-x,o=s-y,p=1/Math.sqrt(m*m+n*n+o*o),m*=p,n*=p,o*=p,g=u*o-v*n,h=v*m-t*o,i=t*n-u*m,p=Math.sqrt(g*g+h*h+i*i),p?(p=1/p,g*=p,h*=p,i*=p):(g=0,h=0,i=0),j=n*i-o*h,k=o*g-m*i,l=m*h-n*g,p=Math.sqrt(j*j+k*k+l*l),p?(p=1/p,j*=p,k*=p,l*=p):(j=0,k=0,l=0),a[0]=g,a[1]=j,a[2]=m,a[3]=0,a[4]=h,a[5]=k,a[6]=n,a[7]=0,a[8]=i,a[9]=l,a[10]=o,a[11]=0,a[12]=-(g*q+h*r+i*s),a[13]=-(j*q+k*r+l*s),a[14]=-(m*q+n*r+o*s),a[15]=1,a)},e.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"},e.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))},b.exports=e},{"./common.js":117}],122:[function(a,b,c){var d=a("./common.js"),e=a("./mat3.js"),f=a("./vec3.js"),g=a("./vec4.js"),h={};h.create=function(){var a=new d.ARRAY_TYPE(4);return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a},h.rotationTo=function(){var a=f.create(),b=f.fromValues(1,0,0),c=f.fromValues(0,1,0);return function(d,e,g){var i=f.dot(e,g);return-.999999>i?(f.cross(a,b,e),f.length(a)<1e-6&&f.cross(a,c,e),f.normalize(a,a),h.setAxisAngle(d,a,Math.PI),d):i>.999999?(d[0]=0,d[1]=0,d[2]=0,d[3]=1,d):(f.cross(a,e,g),d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=1+i,h.normalize(d,d))}}(),h.setAxes=function(){var a=e.create();return function(b,c,d,e){return a[0]=d[0],a[3]=d[1],a[6]=d[2],a[1]=e[0],a[4]=e[1],a[7]=e[2],a[2]=-c[0],a[5]=-c[1],a[8]=-c[2],h.normalize(b,h.fromMat3(b,a))}}(),h.clone=g.clone,h.fromValues=g.fromValues,h.copy=g.copy,h.set=g.set,h.identity=function(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a},h.setAxisAngle=function(a,b,c){c=.5*c;var d=Math.sin(c);return a[0]=d*b[0],a[1]=d*b[1],a[2]=d*b[2],a[3]=Math.cos(c),a},h.add=g.add,h.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=c[0],i=c[1],j=c[2],k=c[3];return a[0]=d*k+g*h+e*j-f*i,a[1]=e*k+g*i+f*h-d*j,a[2]=f*k+g*j+d*i-e*h,a[3]=g*k-d*h-e*i-f*j,a},h.mul=h.multiply,h.scale=g.scale,h.rotateX=function(a,b,c){c*=.5;var d=b[0],e=b[1],f=b[2],g=b[3],h=Math.sin(c),i=Math.cos(c);return a[0]=d*i+g*h,a[1]=e*i+f*h,a[2]=f*i-e*h,a[3]=g*i-d*h,a},h.rotateY=function(a,b,c){c*=.5;var d=b[0],e=b[1],f=b[2],g=b[3],h=Math.sin(c),i=Math.cos(c);return a[0]=d*i-f*h,a[1]=e*i+g*h,a[2]=f*i+d*h,a[3]=g*i-e*h,a},h.rotateZ=function(a,b,c){c*=.5;var d=b[0],e=b[1],f=b[2],g=b[3],h=Math.sin(c),i=Math.cos(c);return a[0]=d*i+e*h,a[1]=e*i-d*h,a[2]=f*i+g*h,a[3]=g*i-f*h,a},h.calculateW=function(a,b){var c=b[0],d=b[1],e=b[2];return a[0]=c,a[1]=d,a[2]=e,a[3]=Math.sqrt(Math.abs(1-c*c-d*d-e*e)),a},h.dot=g.dot,h.lerp=g.lerp,h.slerp=function(a,b,c,d){var e,f,g,h,i,j=b[0],k=b[1],l=b[2],m=b[3],n=c[0],o=c[1],p=c[2],q=c[3];return f=j*n+k*o+l*p+m*q,0>f&&(f=-f,n=-n,o=-o,p=-p,q=-q),1-f>1e-6?(e=Math.acos(f),g=Math.sin(e),h=Math.sin((1-d)*e)/g,i=Math.sin(d*e)/g):(h=1-d,i=d),a[0]=h*j+i*n,a[1]=h*k+i*o,a[2]=h*l+i*p,a[3]=h*m+i*q,a},h.sqlerp=function(){var a=h.create(),b=h.create();return function(c,d,e,f,g,i){return h.slerp(a,d,g,i),h.slerp(b,e,f,i),h.slerp(c,a,b,2*i*(1-i)),c}}(),h.invert=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c*c+d*d+e*e+f*f,h=g?1/g:0;return a[0]=-c*h,a[1]=-d*h,a[2]=-e*h,a[3]=f*h,a},h.conjugate=function(a,b){return a[0]=-b[0],a[1]=-b[1],a[2]=-b[2],a[3]=b[3],a},h.length=g.length,h.len=h.length,h.squaredLength=g.squaredLength,h.sqrLen=h.squaredLength,h.normalize=g.normalize,h.fromMat3=function(a,b){var c,d=b[0]+b[4]+b[8];if(d>0)c=Math.sqrt(d+1),a[3]=.5*c,c=.5/c,a[0]=(b[5]-b[7])*c,a[1]=(b[6]-b[2])*c,a[2]=(b[1]-b[3])*c;else{var e=0;b[4]>b[0]&&(e=1),b[8]>b[3*e+e]&&(e=2);var f=(e+1)%3,g=(e+2)%3;c=Math.sqrt(b[3*e+e]-b[3*f+f]-b[3*g+g]+1),a[e]=.5*c,c=.5/c,a[3]=(b[3*f+g]-b[3*g+f])*c,a[f]=(b[3*f+e]+b[3*e+f])*c,a[g]=(b[3*g+e]+b[3*e+g])*c}return a},h.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"},b.exports=h},{"./common.js":117,"./mat3.js":120,"./vec3.js":124,"./vec4.js":125}],123:[function(a,b,c){var d=a("./common.js"),e={};e.create=function(){var a=new d.ARRAY_TYPE(2);return a[0]=0,a[1]=0,a},e.clone=function(a){var b=new d.ARRAY_TYPE(2);return b[0]=a[0],b[1]=a[1],b},e.fromValues=function(a,b){var c=new d.ARRAY_TYPE(2);return c[0]=a,c[1]=b,c},e.copy=function(a,b){return a[0]=b[0],a[1]=b[1],a},e.set=function(a,b,c){return a[0]=b,a[1]=c,a},e.add=function(a,b,c){return a[0]=b[0]+c[0],a[1]=b[1]+c[1],a},e.subtract=function(a,b,c){return a[0]=b[0]-c[0],a[1]=b[1]-c[1],a},e.sub=e.subtract,e.multiply=function(a,b,c){return a[0]=b[0]*c[0],a[1]=b[1]*c[1],a},e.mul=e.multiply,e.divide=function(a,b,c){return a[0]=b[0]/c[0],a[1]=b[1]/c[1],a},e.div=e.divide,e.min=function(a,b,c){return a[0]=Math.min(b[0],c[0]),a[1]=Math.min(b[1],c[1]),a},e.max=function(a,b,c){return a[0]=Math.max(b[0],c[0]),a[1]=Math.max(b[1],c[1]),a},e.scale=function(a,b,c){return a[0]=b[0]*c,a[1]=b[1]*c,a},e.scaleAndAdd=function(a,b,c,d){return a[0]=b[0]+c[0]*d,a[1]=b[1]+c[1]*d,a},e.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return Math.sqrt(c*c+d*d)},e.dist=e.distance,e.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return c*c+d*d},e.sqrDist=e.squaredDistance,e.length=function(a){var b=a[0],c=a[1];return Math.sqrt(b*b+c*c)},e.len=e.length,e.squaredLength=function(a){var b=a[0],c=a[1];return b*b+c*c},e.sqrLen=e.squaredLength,e.negate=function(a,b){return a[0]=-b[0],a[1]=-b[1],a},e.inverse=function(a,b){return a[0]=1/b[0],a[1]=1/b[1],a},e.normalize=function(a,b){var c=b[0],d=b[1],e=c*c+d*d;return e>0&&(e=1/Math.sqrt(e),a[0]=b[0]*e,a[1]=b[1]*e),a},e.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]},e.cross=function(a,b,c){var d=b[0]*c[1]-b[1]*c[0];return a[0]=a[1]=0,a[2]=d,a},e.lerp=function(a,b,c,d){var e=b[0],f=b[1];return a[0]=e+d*(c[0]-e),a[1]=f+d*(c[1]-f),a},e.random=function(a,b){b=b||1;var c=2*d.RANDOM()*Math.PI;return a[0]=Math.cos(c)*b,a[1]=Math.sin(c)*b,a},e.transformMat2=function(a,b,c){var d=b[0],e=b[1];return a[0]=c[0]*d+c[2]*e,a[1]=c[1]*d+c[3]*e,a},e.transformMat2d=function(a,b,c){var d=b[0],e=b[1];return a[0]=c[0]*d+c[2]*e+c[4],a[1]=c[1]*d+c[3]*e+c[5],a},e.transformMat3=function(a,b,c){var d=b[0],e=b[1];return a[0]=c[0]*d+c[3]*e+c[6],a[1]=c[1]*d+c[4]*e+c[7],a},e.transformMat4=function(a,b,c){var d=b[0],e=b[1];return a[0]=c[0]*d+c[4]*e+c[12],a[1]=c[1]*d+c[5]*e+c[13],a},e.forEach=function(){var a=e.create();return function(b,c,d,e,f,g){var h,i;for(c||(c=2),d||(d=0),i=e?Math.min(e*c+d,b.length):b.length,h=d;i>h;h+=c)a[0]=b[h],a[1]=b[h+1],f(a,a,g),b[h]=a[0],b[h+1]=a[1];return b}}(),e.str=function(a){return"vec2("+a[0]+", "+a[1]+")"},b.exports=e},{"./common.js":117}],124:[function(a,b,c){var d=a("./common.js"),e={};e.create=function(){var a=new d.ARRAY_TYPE(3);return a[0]=0,a[1]=0,a[2]=0,a},e.clone=function(a){var b=new d.ARRAY_TYPE(3);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b},e.fromValues=function(a,b,c){var e=new d.ARRAY_TYPE(3);return e[0]=a,e[1]=b,e[2]=c,e},e.copy=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a},e.set=function(a,b,c,d){return a[0]=b,a[1]=c,a[2]=d,a},e.add=function(a,b,c){return a[0]=b[0]+c[0],a[1]=b[1]+c[1],a[2]=b[2]+c[2],a},e.subtract=function(a,b,c){return a[0]=b[0]-c[0],a[1]=b[1]-c[1],a[2]=b[2]-c[2],a},e.sub=e.subtract,e.multiply=function(a,b,c){return a[0]=b[0]*c[0],a[1]=b[1]*c[1],a[2]=b[2]*c[2],a},e.mul=e.multiply,e.divide=function(a,b,c){return a[0]=b[0]/c[0],a[1]=b[1]/c[1],a[2]=b[2]/c[2],a},e.div=e.divide,e.min=function(a,b,c){return a[0]=Math.min(b[0],c[0]),a[1]=Math.min(b[1],c[1]),a[2]=Math.min(b[2],c[2]),a},e.max=function(a,b,c){return a[0]=Math.max(b[0],c[0]),a[1]=Math.max(b[1],c[1]),a[2]=Math.max(b[2],c[2]),a},e.scale=function(a,b,c){return a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c,a},e.scaleAndAdd=function(a,b,c,d){return a[0]=b[0]+c[0]*d,a[1]=b[1]+c[1]*d,a[2]=b[2]+c[2]*d,a},e.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return Math.sqrt(c*c+d*d+e*e)},e.dist=e.distance,e.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return c*c+d*d+e*e},e.sqrDist=e.squaredDistance,e.length=function(a){var b=a[0],c=a[1],d=a[2];return Math.sqrt(b*b+c*c+d*d)},e.len=e.length,e.squaredLength=function(a){var b=a[0],c=a[1],d=a[2];return b*b+c*c+d*d},e.sqrLen=e.squaredLength,e.negate=function(a,b){return a[0]=-b[0],a[1]=-b[1],a[2]=-b[2],a},e.inverse=function(a,b){return a[0]=1/b[0],a[1]=1/b[1],a[2]=1/b[2],a},e.normalize=function(a,b){var c=b[0],d=b[1],e=b[2],f=c*c+d*d+e*e;return f>0&&(f=1/Math.sqrt(f),a[0]=b[0]*f,a[1]=b[1]*f,a[2]=b[2]*f),a},e.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]},e.cross=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=c[0],h=c[1],i=c[2];return a[0]=e*i-f*h,a[1]=f*g-d*i,a[2]=d*h-e*g,a},e.lerp=function(a,b,c,d){var e=b[0],f=b[1],g=b[2];return a[0]=e+d*(c[0]-e),a[1]=f+d*(c[1]-f),a[2]=g+d*(c[2]-g),a},e.hermite=function(a,b,c,d,e,f){var g=f*f,h=g*(2*f-3)+1,i=g*(f-2)+f,j=g*(f-1),k=g*(3-2*f);return a[0]=b[0]*h+c[0]*i+d[0]*j+e[0]*k,a[1]=b[1]*h+c[1]*i+d[1]*j+e[1]*k,a[2]=b[2]*h+c[2]*i+d[2]*j+e[2]*k,a},e.bezier=function(a,b,c,d,e,f){var g=1-f,h=g*g,i=f*f,j=h*g,k=3*f*h,l=3*i*g,m=i*f;return a[0]=b[0]*j+c[0]*k+d[0]*l+e[0]*m,a[1]=b[1]*j+c[1]*k+d[1]*l+e[1]*m,a[2]=b[2]*j+c[2]*k+d[2]*l+e[2]*m,a},e.random=function(a,b){b=b||1;var c=2*d.RANDOM()*Math.PI,e=2*d.RANDOM()-1,f=Math.sqrt(1-e*e)*b;return a[0]=Math.cos(c)*f,a[1]=Math.sin(c)*f,a[2]=e*b,a},e.transformMat4=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=c[3]*d+c[7]*e+c[11]*f+c[15];return g=g||1,a[0]=(c[0]*d+c[4]*e+c[8]*f+c[12])/g,a[1]=(c[1]*d+c[5]*e+c[9]*f+c[13])/g,a[2]=(c[2]*d+c[6]*e+c[10]*f+c[14])/g,a},e.transformMat3=function(a,b,c){var d=b[0],e=b[1],f=b[2];return a[0]=d*c[0]+e*c[3]+f*c[6],a[1]=d*c[1]+e*c[4]+f*c[7],a[2]=d*c[2]+e*c[5]+f*c[8],a},e.transformQuat=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=c[0],h=c[1],i=c[2],j=c[3],k=j*d+h*f-i*e,l=j*e+i*d-g*f,m=j*f+g*e-h*d,n=-g*d-h*e-i*f;return a[0]=k*j+n*-g+l*-i-m*-h,a[1]=l*j+n*-h+m*-g-k*-i,a[2]=m*j+n*-i+k*-h-l*-g,a},e.rotateX=function(a,b,c,d){var e=[],f=[];return e[0]=b[0]-c[0],e[1]=b[1]-c[1],e[2]=b[2]-c[2],f[0]=e[0],f[1]=e[1]*Math.cos(d)-e[2]*Math.sin(d),f[2]=e[1]*Math.sin(d)+e[2]*Math.cos(d),a[0]=f[0]+c[0],a[1]=f[1]+c[1],a[2]=f[2]+c[2],a},e.rotateY=function(a,b,c,d){var e=[],f=[];return e[0]=b[0]-c[0],e[1]=b[1]-c[1],e[2]=b[2]-c[2],f[0]=e[2]*Math.sin(d)+e[0]*Math.cos(d),f[1]=e[1],f[2]=e[2]*Math.cos(d)-e[0]*Math.sin(d),a[0]=f[0]+c[0],a[1]=f[1]+c[1],a[2]=f[2]+c[2],a},e.rotateZ=function(a,b,c,d){var e=[],f=[];return e[0]=b[0]-c[0],e[1]=b[1]-c[1],e[2]=b[2]-c[2],f[0]=e[0]*Math.cos(d)-e[1]*Math.sin(d),f[1]=e[0]*Math.sin(d)+e[1]*Math.cos(d),f[2]=e[2],a[0]=f[0]+c[0],a[1]=f[1]+c[1],a[2]=f[2]+c[2],a},e.forEach=function(){var a=e.create();return function(b,c,d,e,f,g){var h,i;for(c||(c=3),d||(d=0),i=e?Math.min(e*c+d,b.length):b.length,h=d;i>h;h+=c)a[0]=b[h],a[1]=b[h+1],a[2]=b[h+2],f(a,a,g),b[h]=a[0],b[h+1]=a[1],b[h+2]=a[2];return b}}(),e.angle=function(a,b){var c=e.fromValues(a[0],a[1],a[2]),d=e.fromValues(b[0],b[1],b[2]);e.normalize(c,c),e.normalize(d,d);var f=e.dot(c,d);return f>1?0:Math.acos(f)},e.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"},b.exports=e},{"./common.js":117}],125:[function(a,b,c){var d=a("./common.js"),e={};e.create=function(){var a=new d.ARRAY_TYPE(4);return a[0]=0,a[1]=0,a[2]=0,a[3]=0,a},e.clone=function(a){var b=new d.ARRAY_TYPE(4);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b},e.fromValues=function(a,b,c,e){var f=new d.ARRAY_TYPE(4);return f[0]=a,f[1]=b,f[2]=c,f[3]=e,f},e.copy=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a},e.set=function(a,b,c,d,e){return a[0]=b,a[1]=c,a[2]=d,a[3]=e,a},e.add=function(a,b,c){return a[0]=b[0]+c[0],a[1]=b[1]+c[1],a[2]=b[2]+c[2],a[3]=b[3]+c[3],a},e.subtract=function(a,b,c){return a[0]=b[0]-c[0],a[1]=b[1]-c[1],a[2]=b[2]-c[2],a[3]=b[3]-c[3],a},e.sub=e.subtract,e.multiply=function(a,b,c){return a[0]=b[0]*c[0],a[1]=b[1]*c[1],a[2]=b[2]*c[2],a[3]=b[3]*c[3],a},e.mul=e.multiply,e.divide=function(a,b,c){return a[0]=b[0]/c[0],a[1]=b[1]/c[1],a[2]=b[2]/c[2],a[3]=b[3]/c[3],a},e.div=e.divide,e.min=function(a,b,c){return a[0]=Math.min(b[0],c[0]),a[1]=Math.min(b[1],c[1]),a[2]=Math.min(b[2],c[2]),a[3]=Math.min(b[3],c[3]),a},e.max=function(a,b,c){return a[0]=Math.max(b[0],c[0]),a[1]=Math.max(b[1],c[1]),a[2]=Math.max(b[2],c[2]),a[3]=Math.max(b[3],c[3]),a},e.scale=function(a,b,c){return a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c,a[3]=b[3]*c,a},e.scaleAndAdd=function(a,b,c,d){return a[0]=b[0]+c[0]*d,a[1]=b[1]+c[1]*d,a[2]=b[2]+c[2]*d,a[3]=b[3]+c[3]*d,a},e.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2],f=b[3]-a[3];return Math.sqrt(c*c+d*d+e*e+f*f)},e.dist=e.distance,e.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2],f=b[3]-a[3];return c*c+d*d+e*e+f*f},e.sqrDist=e.squaredDistance,e.length=function(a){var b=a[0],c=a[1],d=a[2],e=a[3];return Math.sqrt(b*b+c*c+d*d+e*e)},e.len=e.length,e.squaredLength=function(a){var b=a[0],c=a[1],d=a[2],e=a[3];return b*b+c*c+d*d+e*e},e.sqrLen=e.squaredLength,e.negate=function(a,b){return a[0]=-b[0],a[1]=-b[1],a[2]=-b[2],a[3]=-b[3],a},e.inverse=function(a,b){return a[0]=1/b[0],a[1]=1/b[1],a[2]=1/b[2],a[3]=1/b[3],a},e.normalize=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c*c+d*d+e*e+f*f;return g>0&&(g=1/Math.sqrt(g),a[0]=c*g,a[1]=d*g,a[2]=e*g,a[3]=f*g),a},e.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]},e.lerp=function(a,b,c,d){var e=b[0],f=b[1],g=b[2],h=b[3];return a[0]=e+d*(c[0]-e),a[1]=f+d*(c[1]-f),a[2]=g+d*(c[2]-g),a[3]=h+d*(c[3]-h),a},e.random=function(a,b){return b=b||1,a[0]=d.RANDOM(),a[1]=d.RANDOM(),a[2]=d.RANDOM(),a[3]=d.RANDOM(),e.normalize(a,a),e.scale(a,a,b),a},e.transformMat4=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3];return a[0]=c[0]*d+c[4]*e+c[8]*f+c[12]*g,a[1]=c[1]*d+c[5]*e+c[9]*f+c[13]*g,a[2]=c[2]*d+c[6]*e+c[10]*f+c[14]*g,a[3]=c[3]*d+c[7]*e+c[11]*f+c[15]*g,a},e.transformQuat=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=c[0],h=c[1],i=c[2],j=c[3],k=j*d+h*f-i*e,l=j*e+i*d-g*f,m=j*f+g*e-h*d,n=-g*d-h*e-i*f;return a[0]=k*j+n*-g+l*-i-m*-h,a[1]=l*j+n*-h+m*-g-k*-i,a[2]=m*j+n*-i+k*-h-l*-g,a[3]=b[3],a},e.forEach=function(){var a=e.create();return function(b,c,d,e,f,g){var h,i;for(c||(c=4),d||(d=0),i=e?Math.min(e*c+d,b.length):b.length,h=d;i>h;h+=c)a[0]=b[h],a[1]=b[h+1],a[2]=b[h+2],a[3]=b[h+3],f(a,a,g),b[h]=a[0],b[h+1]=a[1],b[h+2]=a[2],b[h+3]=a[3];return b}}(),e.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"},b.exports=e},{"./common.js":117}],126:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:(n?-1:1)*(1/0);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=0>b||0===b&&0>1/b?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],127:[function(a,b,c){"function"==typeof Object.create?b.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],128:[function(a,b,c){function d(a){return function(){return a}}function e(a,b,c){return a*(1-c)+b*c}function f(a,b,c){for(var d=[],f=0;f<a.length;f++)d[f]=e(a[f],b[f],c);return d}c.interpolated=function(a){if(!a.stops)return d(a);var b=a.stops,c=a.base||1,g=Array.isArray(b[0][1])?f:e;return function(a){for(var d,e,f=0;f<b.length;f++){var h=b[f];if(h[0]<=a&&(d=h),h[0]>a){e=h;break}}if(d&&e){var i=e[0]-d[0],j=a-d[0],k=1===c?j/i:(Math.pow(c,j)-1)/(Math.pow(c,i)-1);return g(d[1],e[1],k)}return d?d[1]:e?e[1]:void 0}},c["piecewise-constant"]=function(a){if(!a.stops)return d(a);var b=a.stops;return function(a){for(var c=0;c<b.length;c++)if(b[c][0]>a)return b[0===c?0:c-1][1];return b[b.length-1][1]}}},{}],129:[function(a,b,c){var d=a("../../reference/latest.min.js"),e=a("./parsed");b.exports=function(a){return e(a,d)}},{"../../reference/latest.min.js":132,"./parsed":130}],130:[function(a,b,c){function d(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":null===a?"null":typeof a}function e(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}var f=a("csscolorparser").parseCSSColor,g=a("util").format;b.exports=function(a,b){function c(a,b){var c={message:(a?a+": ":"")+g.apply(g,Array.prototype.slice.call(arguments,2))};null!==b&&void 0!==b&&b.__line__&&(c.line=b.__line__),l.push(c)}function h(a,e,f){var g=d(e);if("string"===g&&"@"===e[0]){if(b.$version>7)return c(a,e,"constants have been deprecated as of v8");if(!(e in j))return c(a,e,'constant "%s" not found',e);e=j[e],g=d(e)}if(f.function&&"object"===g)return h.function(a,e,f);if(f.type){var i=h[f.type];if(i)return i(a,e,f);f=b[f.type]}h.object(a,e,f)}function i(a){return function(b,e,f){var g=d(e);g!==a&&c(b,e,"%s expected, %s found",a,g),"minimum"in f&&e<f.minimum&&c(b,e,"%s is less than the minimum value %s",e,f.minimum),"maximum"in f&&e>f.maximum&&c(b,e,"%s is greater than the maximum value %s",e,f.maximum)}}var j=a.constants||{},k={},l=[];return h.constants=function(a,e){if(b.$version>7){if(e)return c(a,e,"constants have been deprecated as of v8")}else{var f=d(e);if("object"!==f)return c(a,e,"object expected, %s found",f);for(var g in e)"@"!==g[0]&&c(a+"."+g,e[g],'constants must start with "@"')}},h.source=function(a,d){if(!d.type)return void c(a,d,'"type" is required');var f=e(d.type);switch(f){case"vector":case"raster":if(h.object(a,d,b.source_tile),"url"in d)for(var g in d)["type","url","tileSize"].indexOf(g)<0&&c(a+"."+g,d[g],'a source with a "url" property may not include a "%s" property',g);break;case"geojson":h.object(a,d,b.source_geojson);break;case"video":h.object(a,d,b.source_video);break;case"image":h.object(a,d,b.source_image);break;default:h.enum(a+".type",d.type,{values:["vector","raster","geojson","video","image"]})}},h.layer=function(d,f){f.type||f.ref||c(d,f,'either "type" or "ref" is required');var g=e(f.type),i=e(f.ref);if(f.id&&(k[f.id]?c(d,f.id,'duplicate layer id "%s", previously used at line %d',f.id,k[f.id]):k[f.id]=f.id.__line__),"ref"in f){["type","source","source-layer","filter","layout"].forEach(function(a){a in f&&c(d,f[a],'"%s" is prohibited for ref layers',a)});var j;a.layers.forEach(function(a){a.id==i&&(j=a)}),j?j.ref?c(d,f.ref,"ref cannot reference another ref layer"):g=j.type:c(d,f.ref,'ref layer "%s" not found',i)}else if("background"!==g)if(f.source){var l=a.sources[f.source];l?"vector"==l.type&&"raster"==g?c(d,f.source,'layer "%s" requires a raster source',f.id):"raster"==l.type&&"raster"!=g?c(d,f.source,'layer "%s" requires a vector source',f.id):"vector"!=l.type||f["source-layer"]||c(d,f,'layer "%s" must specify a "source-layer"',f.id):c(d,f.source,'source "%s" not found',f.source)}else c(d,f,'missing required property "source"');h.object(d,f,b.layer,{filter:h.filter,layout:function(a,c){var d=b["layout_"+g];return g&&d&&h(a,c,d)},paint:function(a,c){var d=b["paint_"+g];return g&&d&&h(a,c,d)}})},h.object=function(a,e,f,g){g=g||{};var i=d(e);if("object"!==i)return c(a,e,"object expected, %s found",i);for(var j in e){var k=j.split(".")[0],l=f[k]||f["*"],m=k.match(/^(.*)-transition$/);l?(g[k]||h)((a?a+".":a)+j,e[j],l):m&&f[m[1]]&&f[m[1]].transition?h((a?a+".":a)+j,e[j],b.transition):""!==a&&1!==a.split(".").length&&c(a,e[j],'unknown property "%s"',j)}for(var n in f)f[n].required&&void 0===f[n].default&&void 0===e[n]&&c(a,e,'missing required property "%s"',n)},h.array=function(b,e,f,g){if("array"!==d(e))return c(b,e,"array expected, %s found",d(e));if(f.length&&e.length!==f.length)return c(b,e,"array length %d expected, length %d found",f.length,e.length);if(f["min-length"]&&e.length<f["min-length"])return c(b,e,"array length at least %d expected, length %d found",f["min-length"],e.length);var i={type:f.value};a.version<7&&(i.function=f.function),"object"===d(f.value)&&(i=f.value);for(var j=0;j<e.length;j++)(g||h)(b+"["+j+"]",e[j],i)},h.filter=function(a,f){var g;if("array"!==d(f))return c(a,f,"array expected, %s found",d(f));if(f.length<1)return c(a,f,"filter array must have at least 1 element");switch(h.enum(a+"[0]",f[0],b.filter_operator),e(f[0])){case"<":case"<=":case">":case">=":f.length>=2&&"$type"==f[1]&&c(a,f,'"$type" cannot be use with operator "%s"',f[0]);case"==":case"!=":3!=f.length&&c(a,f,'filter array for operator "%s" must have 3 elements',f[0]);case"in":case"!in":f.length>=2&&(g=d(f[1]),"string"!==g?c(a+"[1]",f[1],"string expected, %s found",g):"@"===f[1][0]&&c(a+"[1]",f[1],"filter key cannot be a constant"));for(var i=2;i<f.length;i++)g=d(f[i]),"$type"==f[1]?h.enum(a+"["+i+"]",f[i],b.geometry_type):"string"===g&&"@"===f[i][0]?c(a+"["+i+"]",f[i],"filter value cannot be a constant"):"string"!==g&&"number"!==g&&"boolean"!==g&&c(a+"["+i+"]",f[i],"string, number, or boolean expected, %s found",g);break;case"any":case"all":case"none":for(i=1;i<f.length;i++)h.filter(a+"["+i+"]",f[i])}},h.function=function(a,e,f){h.object(a,e,b.function,{stops:function(a,b,e){var g=-(1/0);h.array(a,b,e,function(a,b){return"array"!==d(b)?c(a,b,"array expected, %s found",d(b)):2!==b.length?c(a,b,"array length %d expected, length %d found",2,b.length):(h(a+"[0]",b[0],{type:"number"}),h(a+"[1]",b[1],f),void("number"===d(b[0])&&("piecewise-constant"===f.function&&b[0]%1!==0&&c(a+"[0]",b[0],"zoom level for piecewise-constant functions must be an integer"),b[0]<=g&&c(a+"[0]",b[0],"array stops must appear in ascending order and have no duplicates"),g=b[0])))}),"array"===d(b)&&0===b.length&&c(a,b,"array must have at least one stop")}})},h.enum=function(a,b,d){-1===d.values.indexOf(e(b))&&c(a,b,"expected one of [%s], %s found",d.values.join(", "),b)},h.color=function(a,b){var e=d(b);return"string"!==e?c(a,b,"color expected, %s found",e):null===f(b)?c(a,b,'color expected, "%s" found',b):void 0},h.number=i("number"),h.string=i("string"),h.boolean=i("boolean"),h["*"]=function(){},h("",a,b.$root),b.$version>7&&a.constants&&h.constants("constants",a.constants),l.sort(function(a,b){return a.line-b.line}),l}},{csscolorparser:107,util:143}],131:[function(a,b,c){b.exports=a("./v8.json")},{"./v8.json":133}],132:[function(a,b,c){b.exports=a("./v8.min.json")},{"./v8.min.json":134}],133:[function(a,b,c){b.exports={$version:8,$root:{
version:{required:!0,type:"enum",values:[8],doc:"Stylesheet version number. Must be 8.",example:8},name:{type:"string",doc:"A human-readable name for the style.",example:"Bright"},metadata:{type:"*",doc:"Arbitrary properties useful to track with the stylesheet, but do not influence rendering. Properties should be prefixed to avoid collisions, like 'mapbox:'."},center:{type:"array",value:"number",doc:"Default map center in longitude and latitude.  The style center will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:[-73.9749,40.7736]},zoom:{type:"number",doc:"Default zoom level.  The style zoom will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:12.5},bearing:{type:"number",default:0,period:360,units:"degrees",doc:"Default bearing, in degrees.  The style bearing will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:29},pitch:{type:"number",default:0,units:"degrees",doc:"Default pitch, in degrees. Zero is perpendicular to the surface.  The style pitch will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:50},sources:{required:!0,type:"sources",doc:"Data source specifications.",example:{"mapbox-streets":{type:"vector",url:"mapbox://mapbox.mapbox-streets-v6"}}},sprite:{type:"string",doc:"A base URL for retrieving the sprite image and metadata. The extensions `.png`, `.json` and scale factor `@2x.png` will be automatically appended.",example:"mapbox://sprites/mapbox/bright-v8"},glyphs:{type:"string",doc:"A URL template for loading signed-distance-field glyph sets in PBF format. Valid tokens are {fontstack} and {range}.",example:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},transition:{type:"transition",doc:"A global transition definition to use as a default across properties.",example:{duration:300,delay:0}},layers:{required:!0,type:"array",value:"layer",doc:"Layers will be drawn in the order of this array.",example:[{id:"water",source:"mapbox-streets","source-layer":"water",type:"fill",paint:{"fill-color":"#00ffff"}}]}},sources:{"*":{type:"source",doc:"Specification of a data source. For vector and raster sources, either TileJSON or a URL to a TileJSON must be provided. For GeoJSON and video sources, a URL must be provided."}},source:["source_tile","source_geojson","source_video","source_image"],source_tile:{type:{required:!0,type:"enum",values:["vector","raster"],doc:"The data type of the tile source."},url:{type:"string",doc:"A URL to a TileJSON resource. Supported protocols are `http:`, `https:`, and `mapbox://<mapid>`."},tiles:{type:"array",value:"string",doc:"An array of one or more tile source URLs, as in the TileJSON spec."},minzoom:{type:"number",default:0,doc:"Minimum zoom level for which tiles are available, as in the TileJSON spec."},maxzoom:{type:"number",default:22,doc:"Maximum zoom level for which tiles are available, as in the TileJSON spec. Data from tiles at the maxzoom are used when displaying the map at higher zoom levels."},tileSize:{type:"number",default:512,units:"pixels",doc:"The minimum visual size to display tiles for this layer. Only configurable for raster layers."},"*":{type:"*",doc:"Other keys to configure the data source."}},source_geojson:{type:{required:!0,type:"enum",values:["geojson"],doc:"The data type of the GeoJSON source."},data:{type:"*",doc:"A URL to a GeoJSON file, or inline GeoJSON."},maxzoom:{type:"number",default:14,doc:"Maximum zoom level at which to create vector tiles (higher means greater detail at high zoom levels)."},buffer:{type:"number",default:64,doc:"Tile buffer size on each side (higher means fewer rendering artifacts near tile edges but slower performance)."},tolerance:{type:"number",default:3,doc:"Douglas-Peucker simplification tolerance (higher means simpler geometries and faster performance)."},cluster:{type:"boolean",default:!1,doc:"If the data is a collection of point features, setting this to true clusters the points by radius into groups."},clusterRadius:{type:"number",default:400,doc:"Radius of each cluster when clustering points, relative to 4096 tile."},clusterMaxZoom:{type:"number",doc:"Max zoom to cluster points on. Defaults to one zoom less than maxzoom (so that last zoom features are not clustered)."}},source_video:{type:{required:!0,type:"enum",values:["video"],doc:"The data type of the video source."},urls:{required:!0,type:"array",value:"string",doc:"URLs to video content in order of preferred format."},coordinates:{required:!0,doc:"Corners of video specified in longitude, latitude pairs.",type:"array",length:4,value:{type:"array",length:2,value:"number",doc:"A single longitude, latitude pair."}}},source_image:{type:{required:!0,type:"enum",values:["image"],doc:"The data type of the image source."},url:{required:!0,type:"string",doc:"URL that points to an image"},coordinates:{required:!0,doc:"Corners of image specified in longitude, latitude pairs.",type:"array",length:4,value:{type:"array",length:2,value:"number",doc:"A single longitude, latitude pair."}}},layer:{id:{type:"string",doc:"Unique layer name.",required:!0},type:{type:"enum",values:["fill","line","symbol","circle","raster","background"],doc:"Rendering type of this layer."},metadata:{type:"*",doc:"Arbitrary properties useful to track with the layer, but do not influence rendering. Properties should be prefixed to avoid collisions, like 'mapbox:'."},ref:{type:"string",doc:"References another layer to copy `type`, `source`, `source-layer`, `minzoom`, `maxzoom`, `filter`, and `layout` properties from. This allows the layers to share processing and be more efficient."},source:{type:"string",doc:"Name of a source description to be used for this layer."},"source-layer":{type:"string",doc:"Layer to use from a vector tile source. Required if the source supports multiple layers."},minzoom:{type:"number",minimum:0,maximum:22,doc:"The minimum zoom level on which the layer gets parsed and appears on."},maxzoom:{type:"number",minimum:0,maximum:22,doc:"The maximum zoom level on which the layer gets parsed and appears on."},interactive:{type:"boolean",doc:"Enable querying of feature data from this layer for interactivity.",default:!1},filter:{type:"filter",doc:"A expression specifying conditions on source features. Only features that match the filter are displayed."},layout:{type:"layout",doc:"Layout properties for the layer."},paint:{type:"paint",doc:"Default paint properties for this layer."},"paint.*":{type:"paint",doc:"Class-specific paint properties for this layer. The class name is the part after the first dot."}},layout:["layout_fill","layout_line","layout_circle","layout_symbol","layout_raster","layout_background"],layout_background:{visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible",doc:"The display of this layer. `none` hides this layer."}},layout_fill:{visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible",doc:"The display of this layer. `none` hides this layer."}},layout_circle:{visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible",doc:"The display of this layer. `none` hides this layer."}},layout_line:{"line-cap":{type:"enum",function:"piecewise-constant",values:["butt","round","square"],default:"butt",doc:"The display of line endings."},"line-join":{type:"enum",function:"piecewise-constant",values:["bevel","round","miter"],default:"miter",doc:"The display of lines when joining."},"line-miter-limit":{type:"number",default:2,function:"interpolated",doc:"Used to automatically convert miter joins to bevel joins for sharp angles.",requires:[{"line-join":"miter"}]},"line-round-limit":{type:"number",default:1.05,function:"interpolated",doc:"Used to automatically convert round joins to miter joins for shallow angles.",requires:[{"line-join":"round"}]},visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible",doc:"The display of this layer. `none` hides this layer."}},layout_symbol:{"symbol-placement":{type:"enum",function:"piecewise-constant",values:["point","line"],default:"point",doc:"Label placement relative to its geometry. `line` can only be used on LineStrings and Polygons."},"symbol-spacing":{type:"number",default:250,minimum:1,function:"interpolated",units:"pixels",doc:"Distance between two symbol anchors.",requires:[{"symbol-placement":"line"}]},"symbol-avoid-edges":{type:"boolean",function:"piecewise-constant",default:!1,doc:"If true, the symbols will not cross tile edges to avoid mutual collisions. Recommended in layers that don't have enough padding in the vector tile to prevent collisions, or if it is a point symbol layer placed after a line symbol layer."},"icon-allow-overlap":{type:"boolean",function:"piecewise-constant",default:!1,doc:"If true, the icon will be visible even if it collides with other previously drawn symbols.",requires:["icon-image"]},"icon-ignore-placement":{type:"boolean",function:"piecewise-constant",default:!1,doc:"If true, other symbols can be visible even if they collide with the icon.",requires:["icon-image"]},"icon-optional":{type:"boolean",function:"piecewise-constant",default:!1,doc:"If true, text will display without their corresponding icons when the icon collides with other symbols and the text does not.",requires:["icon-image","text-field"]},"icon-rotation-alignment":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"viewport",doc:"Orientation of icon when map is rotated.",requires:["icon-image"]},"icon-size":{type:"number",default:1,minimum:0,function:"interpolated",doc:"Scale factor for icon. 1 is original size, 3 triples the size.",requires:["icon-image"]},"icon-image":{type:"string",function:"piecewise-constant",doc:"A string with {tokens} replaced, referencing the data property to pull from.",tokens:!0},"icon-rotate":{type:"number",default:0,period:360,function:"interpolated",units:"degrees",doc:"Rotates the icon clockwise.",requires:["icon-image"]},"icon-padding":{type:"number",default:2,minimum:0,function:"interpolated",units:"pixels",doc:"Size of the additional area around the icon bounding box used for detecting symbol collisions.",requires:["icon-image"]},"icon-keep-upright":{type:"boolean",function:"piecewise-constant",default:!1,doc:"If true, the icon may be flipped to prevent it from being rendered upside-down.",requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":"line"}]},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",doc:"Offset distance of icon from its anchor. Positive values indicate right and down, while negative values indicate left and up.",requires:["icon-image"]},"text-rotation-alignment":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"viewport",doc:"Orientation of text when map is rotated.",requires:["text-field"]},"text-field":{type:"string",function:"piecewise-constant",default:"",tokens:!0,doc:"Value to use for a text label. Feature properties are specified using tokens like {field_name}."},"text-font":{type:"array",value:"string",function:"piecewise-constant",default:["Open Sans Regular","Arial Unicode MS Regular"],doc:"Font stack to use for displaying text.",requires:["text-field"]},"text-size":{type:"number",default:16,minimum:0,units:"pixels",function:"interpolated",doc:"Font size.",requires:["text-field"]},"text-max-width":{type:"number",default:10,minimum:0,units:"em",function:"interpolated",doc:"The maximum line width for text wrapping.",requires:["text-field"]},"text-line-height":{type:"number",default:1.2,units:"em",function:"interpolated",doc:"Text leading value for multi-line text.",requires:["text-field"]},"text-letter-spacing":{type:"number",default:0,units:"em",function:"interpolated",doc:"Text tracking amount.",requires:["text-field"]},"text-justify":{type:"enum",function:"piecewise-constant",values:["left","center","right"],default:"center",doc:"Text justification options.",requires:["text-field"]},"text-anchor":{type:"enum",function:"piecewise-constant",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:"center",doc:"Part of the text placed closest to the anchor.",requires:["text-field"]},"text-max-angle":{type:"number",default:45,units:"degrees",function:"interpolated",doc:"Maximum angle change between adjacent characters.",requires:["text-field",{"symbol-placement":"line"}]},"text-rotate":{type:"number",default:0,period:360,units:"degrees",function:"interpolated",doc:"Rotates the text clockwise.",requires:["text-field"]},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",function:"interpolated",doc:"Size of the additional area around the text bounding box used for detecting symbol collisions.",requires:["text-field"]},"text-keep-upright":{type:"boolean",function:"piecewise-constant",default:!0,doc:"If true, the text may be flipped vertically to prevent it from being rendered upside-down.",requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":"line"}]},"text-transform":{type:"enum",function:"piecewise-constant",values:["none","uppercase","lowercase"],default:"none",doc:"Specifies how to capitalize text, similar to the CSS `text-transform` property.",requires:["text-field"]},"text-offset":{type:"array",doc:"Offset distance of text from its anchor. Positive values indicate right and down, while negative values indicate left and up.",value:"number",units:"ems",function:"interpolated",length:2,default:[0,0],requires:["text-field"]},"text-allow-overlap":{type:"boolean",function:"piecewise-constant",default:!1,doc:"If true, the text will be visible even if it collides with other previously drawn symbols.",requires:["text-field"]},"text-ignore-placement":{type:"boolean",function:"piecewise-constant",default:!1,doc:"If true, other symbols can be visible even if they collide with the text.",requires:["text-field"]},"text-optional":{type:"boolean",function:"piecewise-constant",default:!1,doc:"If true, icons will display without their corresponding text when the text collides with other symbols and the icon does not.",requires:["text-field","icon-image"]},visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible",doc:"The display of this layer. `none` hides this layer."}},layout_raster:{visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible",doc:"The display of this layer. `none` hides this layer."}},filter:{type:"array",value:"*",doc:"A filter selects specific features from a layer."},filter_operator:{type:"enum",values:["==","!=",">",">=","<","<=","in","!in","all","any","none"],doc:"The filter operator."},geometry_type:{type:"enum",values:["Point","LineString","Polygon"],doc:"The geometry type for the filter to select."},color_operation:{type:"enum",values:["lighten","saturate","spin","fade","mix"],doc:"A color operation to apply."},function:{stops:{type:"array",required:!0,doc:"An array of stops.",value:"function_stop"},base:{type:"number",default:1,minimum:0,doc:"The exponential base of the interpolation curve. It controls the rate at which the result increases. Higher values make the result increase more towards the high end of the range. With `1` the stops are interpolated linearly."}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2,doc:"Zoom level and value pair."},paint:["paint_fill","paint_line","paint_circle","paint_symbol","paint_raster","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",function:"piecewise-constant",default:!0,doc:"Whether or not the fill should be antialiased."},"fill-opacity":{type:"number",function:"interpolated",default:1,minimum:0,maximum:1,doc:"The opacity given to the fill color.",transition:!0},"fill-color":{type:"color",default:"#000000",doc:"The color of the fill.",function:"interpolated",transition:!0,requires:[{"!":"fill-pattern"}]},"fill-outline-color":{type:"color",doc:"The outline color of the fill. Matches the value of `fill-color` if unspecified.",function:"interpolated",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}]},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively."},"fill-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen)",default:"map",requires:["fill-translate"]},"fill-pattern":{type:"string",function:"piecewise-constant",transition:!0,doc:"Name of image in sprite to use for drawing image fills. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512)."}},paint_line:{"line-opacity":{type:"number",doc:"The opacity at which the line will be drawn.",function:"interpolated",default:1,minimum:0,maximum:1,transition:!0},"line-color":{type:"color",doc:"The color with which the line will be drawn.",default:"#000000",function:"interpolated",transition:!0,requires:[{"!":"line-pattern"}]},"line-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively."},"line-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen)",default:"map",requires:["line-translate"]},"line-width":{type:"number",default:1,minimum:0,function:"interpolated",transition:!0,units:"pixels",doc:"Stroke thickness."},"line-gap-width":{type:"number",default:0,minimum:0,doc:"Draws a line casing outside of a line's actual path. Value indicates the width of the inner gap.",function:"interpolated",transition:!0,units:"pixels"},"line-offset":{type:"number",default:0,doc:'The line\'s offset perpendicular to its direction. Values may be positive or negative, where positive indicates "rightwards" (if you were moving in the direction of the line) and negative indicates "leftwards."',function:"interpolated",transition:!0,units:"pixels"},"line-blur":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",doc:"Blur applied to the line, in pixels."},"line-dasharray":{type:"array",value:"number",function:"piecewise-constant",doc:"Specifies the lengths of the alternating dashes and gaps that form the dash pattern. The lengths are later scaled by the line width. To convert a dash length to pixels, multiply the length by the current line width.",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}]},"line-pattern":{type:"string",function:"piecewise-constant",transition:!0,doc:"Name of image in sprite to use for drawing image lines. For seamless patterns, image width must be a factor of two (2, 4, 8, ..., 512)."}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,function:"interpolated",transition:!0,units:"pixels",doc:"Circle radius."},"circle-color":{type:"color",default:"#000000",doc:"The color of the circle.",function:"interpolated",transition:!0},"circle-blur":{type:"number",default:0,doc:"Amount to blur the circle. 1 blurs the circle such that only the centerpoint is full opacity.",function:"interpolated",transition:!0},"circle-opacity":{type:"number",doc:"The opacity at which the circle will be drawn.",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively."},"circle-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen)",default:"map",requires:["circle-translate"]}},paint_symbol:{"icon-opacity":{doc:"The opacity at which the icon will be drawn.",type:"number",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0,requires:["icon-image"]},"icon-color":{type:"color",default:"#000000",function:"interpolated",transition:!0,doc:"The color of the icon. This can only be used with sdf icons.",requires:["icon-image"]},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated",transition:!0,doc:"The color of the icon's halo. Icon halos can only be used with sdf icons.",requires:["icon-image"]},"icon-halo-width":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",doc:"Distance of halo to the icon outline.",requires:["icon-image"]},"icon-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",doc:"Fade out the halo towards the outside.",requires:["icon-image"]},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels",doc:"Distance that the icon's anchor is moved from its original placement. Positive values indicate right and down, while negative values indicate left and up.",requires:["icon-image"]},"icon-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen).",default:"map",requires:["icon-image","icon-translate"]},"text-opacity":{type:"number",doc:"The opacity at which the text will be drawn.",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0,requires:["text-field"]},"text-color":{type:"color",doc:"The color with which the text will be drawn.",default:"#000000",function:"interpolated",transition:!0,requires:["text-field"]},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated",transition:!0,doc:"The color of the text's halo, which helps it stand out from backgrounds.",requires:["text-field"]},"text-halo-width":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",doc:"Distance of halo to the font outline. Max text halo width is 1/4 of the font-size.",requires:["text-field"]},"text-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",doc:"The halo's fadeout distance towards the outside.",requires:["text-field"]},"text-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels",doc:"Distance that the text's anchor is moved from its original placement. Positive values indicate right and down, while negative values indicate left and up.",requires:["text-field"]},"text-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen).",default:"map",requires:["text-field","text-translate"]}},paint_raster:{"raster-opacity":{type:"number",doc:"The opacity at which the image will be drawn.",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0},"raster-hue-rotate":{type:"number",default:0,period:360,function:"interpolated",transition:!0,units:"degrees",doc:"Rotates hues around the color wheel."},"raster-brightness-min":{type:"number",function:"interpolated",doc:"Increase or reduce the brightness of the image. The value is the minimum brightness.",default:0,minimum:0,maximum:1,transition:!0},"raster-brightness-max":{type:"number",function:"interpolated",doc:"Increase or reduce the brightness of the image. The value is the maximum brightness.",default:1,minimum:0,maximum:1,transition:!0},"raster-saturation":{type:"number",doc:"Increase or reduce the saturation of the image.",default:0,minimum:-1,maximum:1,function:"interpolated",transition:!0},"raster-contrast":{type:"number",doc:"Increase or reduce the contrast of the image.",default:0,minimum:-1,maximum:1,function:"interpolated",transition:!0},"raster-fade-duration":{type:"number",default:300,minimum:0,function:"interpolated",transition:!0,units:"milliseconds",doc:"Fade duration when a new tile is added."}},paint_background:{"background-color":{type:"color",default:"#000000",doc:"The color with which the background will be drawn.",function:"interpolated",transition:!0,requires:[{"!":"background-pattern"}]},"background-pattern":{type:"string",function:"piecewise-constant",transition:!0,doc:"Name of image in sprite to use for drawing an image background. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512)."},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity at which the background will be drawn.",function:"interpolated",transition:!0}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds",doc:"Time allotted for transitions to complete."},delay:{type:"number",default:0,minimum:0,units:"milliseconds",doc:"Length of time before a transition begins."}}}},{}],134:[function(a,b,c){b.exports={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_tile","source_geojson","source_video","source_image"],source_tile:{type:{required:!0,type:"enum",values:["vector","raster"]},url:{type:"string"},tiles:{type:"array",value:"string"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:["geojson"]},data:{type:"*"},maxzoom:{type:"number",default:14},buffer:{type:"number",default:64},tolerance:{type:"number",default:3},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:400},clusterMaxZoom:{type:"number"}},source_video:{type:{required:!0,type:"enum",values:["video"]},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:["image"]},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:["fill","line","symbol","circle","raster","background"]},metadata:{type:"*"},ref:{type:"string"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:22},maxzoom:{type:"number",minimum:0,maximum:22},interactive:{type:"boolean",default:!1},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"},"paint.*":{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_symbol","layout_raster","layout_background"],layout_background:{visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible"}},layout_fill:{visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible"}},layout_circle:{visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible"}},layout_line:{"line-cap":{type:"enum",function:"piecewise-constant",values:["butt","round","square"],default:"butt"},"line-join":{type:"enum",function:"piecewise-constant",values:["bevel","round","miter"],default:"miter"},"line-miter-limit":{type:"number",default:2,function:"interpolated",requires:[{"line-join":"miter"}]},"line-round-limit":{type:"number",default:1.05,function:"interpolated",requires:[{"line-join":"round"}]},visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible"}},layout_symbol:{"symbol-placement":{type:"enum",function:"piecewise-constant",values:["point","line"],default:"point"},"symbol-spacing":{type:"number",default:250,minimum:1,function:"interpolated",units:"pixels",requires:[{"symbol-placement":"line"}]},"symbol-avoid-edges":{type:"boolean",function:"piecewise-constant",default:!1},"icon-allow-overlap":{type:"boolean",function:"piecewise-constant",default:!1,requires:["icon-image"]},"icon-ignore-placement":{type:"boolean",function:"piecewise-constant",default:!1,requires:["icon-image"]},"icon-optional":{type:"boolean",function:"piecewise-constant",default:!1,requires:["icon-image","text-field"]},"icon-rotation-alignment":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"viewport",requires:["icon-image"]},"icon-size":{type:"number",default:1,minimum:0,function:"interpolated",requires:["icon-image"]},"icon-image":{type:"string",function:"piecewise-constant",tokens:!0},"icon-rotate":{type:"number",default:0,period:360,function:"interpolated",units:"degrees",requires:["icon-image"]},"icon-padding":{type:"number",default:2,minimum:0,function:"interpolated",units:"pixels",requires:["icon-image"]},"icon-keep-upright":{type:"boolean",function:"piecewise-constant",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":"line"}]},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",requires:["icon-image"]},"text-rotation-alignment":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"viewport",requires:["text-field"]},"text-field":{type:"string",function:"piecewise-constant",default:"",tokens:!0},"text-font":{type:"array",value:"string",function:"piecewise-constant",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"]},"text-size":{type:"number",default:16,minimum:0,units:"pixels",function:"interpolated",requires:["text-field"]},"text-max-width":{type:"number",default:10,minimum:0,units:"em",function:"interpolated",requires:["text-field"]},"text-line-height":{type:"number",default:1.2,units:"em",function:"interpolated",requires:["text-field"]},"text-letter-spacing":{type:"number",default:0,units:"em",function:"interpolated",requires:["text-field"]},"text-justify":{type:"enum",function:"piecewise-constant",values:["left","center","right"],default:"center",requires:["text-field"]},"text-anchor":{type:"enum",function:"piecewise-constant",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:"center",requires:["text-field"]},"text-max-angle":{type:"number",default:45,units:"degrees",function:"interpolated",requires:["text-field",{"symbol-placement":"line"}]},"text-rotate":{type:"number",default:0,period:360,units:"degrees",function:"interpolated",requires:["text-field"]},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",function:"interpolated",requires:["text-field"]},"text-keep-upright":{type:"boolean",function:"piecewise-constant",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":"line"}]},"text-transform":{type:"enum",function:"piecewise-constant",values:["none","uppercase","lowercase"],default:"none",requires:["text-field"]},"text-offset":{type:"array",value:"number",units:"ems",function:"interpolated",length:2,default:[0,0],requires:["text-field"]},"text-allow-overlap":{type:"boolean",function:"piecewise-constant",default:!1,requires:["text-field"]},"text-ignore-placement":{type:"boolean",function:"piecewise-constant",default:!1,requires:["text-field"]},"text-optional":{type:"boolean",function:"piecewise-constant",default:!1,requires:["text-field","icon-image"]},visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible"
}},layout_raster:{visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:["==","!=",">",">=","<","<=","in","!in","all","any","none"]},geometry_type:{type:"enum",values:["Point","LineString","Polygon"]},color_operation:{type:"enum",values:["lighten","saturate","spin","fade","mix"]},function:{stops:{type:"array",required:!0,value:"function_stop"},base:{type:"number",default:1,minimum:0}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2},paint:["paint_fill","paint_line","paint_circle","paint_symbol","paint_raster","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",function:"piecewise-constant",default:!0},"fill-opacity":{type:"number",function:"interpolated",default:1,minimum:0,maximum:1,transition:!0},"fill-color":{type:"color",default:"#000000",function:"interpolated",transition:!0,requires:[{"!":"fill-pattern"}]},"fill-outline-color":{type:"color",function:"interpolated",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}]},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels"},"fill-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"map",requires:["fill-translate"]},"fill-pattern":{type:"string",function:"piecewise-constant",transition:!0}},paint_line:{"line-opacity":{type:"number",function:"interpolated",default:1,minimum:0,maximum:1,transition:!0},"line-color":{type:"color",default:"#000000",function:"interpolated",transition:!0,requires:[{"!":"line-pattern"}]},"line-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels"},"line-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"map",requires:["line-translate"]},"line-width":{type:"number",default:1,minimum:0,function:"interpolated",transition:!0,units:"pixels"},"line-gap-width":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels"},"line-offset":{type:"number",default:0,function:"interpolated",transition:!0,units:"pixels"},"line-blur":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels"},"line-dasharray":{type:"array",value:"number",function:"piecewise-constant",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}]},"line-pattern":{type:"string",function:"piecewise-constant",transition:!0}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,function:"interpolated",transition:!0,units:"pixels"},"circle-color":{type:"color",default:"#000000",function:"interpolated",transition:!0},"circle-blur":{type:"number",default:0,function:"interpolated",transition:!0},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels"},"circle-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"map",requires:["circle-translate"]}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0,requires:["icon-image"]},"icon-color":{type:"color",default:"#000000",function:"interpolated",transition:!0,requires:["icon-image"]},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated",transition:!0,requires:["icon-image"]},"icon-halo-width":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",requires:["icon-image"]},"icon-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"map",requires:["icon-image","icon-translate"]},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0,requires:["text-field"]},"text-color":{type:"color",default:"#000000",function:"interpolated",transition:!0,requires:["text-field"]},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated",transition:!0,requires:["text-field"]},"text-halo-width":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",requires:["text-field"]},"text-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",requires:["text-field"]},"text-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels",requires:["text-field"]},"text-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"map",requires:["text-field","text-translate"]}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0},"raster-hue-rotate":{type:"number",default:0,period:360,function:"interpolated",transition:!0,units:"degrees"},"raster-brightness-min":{type:"number",function:"interpolated",default:0,minimum:0,maximum:1,transition:!0},"raster-brightness-max":{type:"number",function:"interpolated",default:1,minimum:0,maximum:1,transition:!0},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,function:"interpolated",transition:!0},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,function:"interpolated",transition:!0},"raster-fade-duration":{type:"number",default:300,minimum:0,function:"interpolated",transition:!0,units:"milliseconds"}},paint_background:{"background-color":{type:"color",default:"#000000",function:"interpolated",transition:!0,requires:[{"!":"background-pattern"}]},"background-pattern":{type:"string",function:"piecewise-constant",transition:!0},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}}}},{}],135:[function(a,b,c){function d(a){var b;a&&a.length&&(b=a,a=b.length);var c=new Uint8Array(a||0);return b&&c.set(b),c.readUInt32LE=g.readUInt32LE,c.writeUInt32LE=g.writeUInt32LE,c.readInt32LE=g.readInt32LE,c.writeInt32LE=g.writeInt32LE,c.readFloatLE=g.readFloatLE,c.writeFloatLE=g.writeFloatLE,c.readDoubleLE=g.readDoubleLE,c.writeDoubleLE=g.writeDoubleLE,c.toString=g.toString,c.write=g.write,c.slice=g.slice,c.copy=g.copy,c._isBuffer=!0,c}function e(a){for(var b,c,d=a.length,e=[],f=0;d>f;f++){if(b=a.charCodeAt(f),b>55295&&57344>b){if(!c){b>56319||f+1===d?e.push(239,191,189):c=b;continue}if(56320>b){e.push(239,191,189),c=b;continue}b=c-55296<<10|b-56320|65536,c=null}else c&&(e.push(239,191,189),c=null);128>b?e.push(b):2048>b?e.push(b>>6|192,63&b|128):65536>b?e.push(b>>12|224,b>>6&63|128,63&b|128):e.push(b>>18|240,b>>12&63|128,b>>6&63|128,63&b|128)}return e}b.exports=d;var g,h,i,f=a("ieee754");g={readUInt32LE:function(a){return(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},writeUInt32LE:function(a,b){this[b]=a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24},readInt32LE:function(a){return(this[a]|this[a+1]<<8|this[a+2]<<16)+(this[a+3]<<24)},readFloatLE:function(a){return f.read(this,a,!0,23,4)},readDoubleLE:function(a){return f.read(this,a,!0,52,8)},writeFloatLE:function(a,b){return f.write(this,a,b,!0,23,4)},writeDoubleLE:function(a,b){return f.write(this,a,b,!0,52,8)},toString:function(a,b,c){var d="",e="";b=b||0,c=Math.min(this.length,c||this.length);for(var f=b;c>f;f++){var g=this[f];127>=g?(d+=decodeURIComponent(e)+String.fromCharCode(g),e=""):e+="%"+g.toString(16)}return d+=decodeURIComponent(e)},write:function(a,b){for(var c=a===h?i:e(a),d=0;d<c.length;d++)this[b+d]=c[d]},slice:function(a,b){return this.subarray(a,b)},copy:function(a,b){b=b||0;for(var c=0;c<this.length;c++)a[b+c]=this[c]}},g.writeInt32LE=g.writeUInt32LE,d.byteLength=function(a){return h=a,i=e(a),i.length},d.isBuffer=function(a){return!(!a||!a._isBuffer)}},{ieee754:126}],136:[function(a,b,c){(function(c){function d(a){this.buf=n.isBuffer(a)?a:new n(a||0),this.pos=0,this.length=this.buf.length}function e(a,b){for(var c=0;c<a.length;c++)b.writeVarint(a[c])}function f(a,b){for(var c=0;c<a.length;c++)b.writeSVarint(a[c])}function g(a,b){for(var c=0;c<a.length;c++)b.writeFloat(a[c])}function h(a,b){for(var c=0;c<a.length;c++)b.writeDouble(a[c])}function i(a,b){for(var c=0;c<a.length;c++)b.writeBoolean(a[c])}function j(a,b){for(var c=0;c<a.length;c++)b.writeFixed32(a[c])}function k(a,b){for(var c=0;c<a.length;c++)b.writeSFixed32(a[c])}function l(a,b){for(var c=0;c<a.length;c++)b.writeFixed64(a[c])}function m(a,b){for(var c=0;c<a.length;c++)b.writeSFixed64(a[c])}b.exports=d;var n=c.Buffer||a("./buffer");d.Varint=0,d.Fixed64=1,d.Bytes=2,d.Fixed32=5;var o=4294967296,p=1/o,q=Math.pow(2,63);d.prototype={destroy:function(){this.buf=null},readFields:function(a,b,c){for(c=c||this.length;this.pos<c;){var d=this.readVarint(),e=d>>3,f=this.pos;a(e,b,this),this.pos===f&&this.skip(d)}return b},readMessage:function(a,b){return this.readFields(a,b,this.readVarint()+this.pos)},readFixed32:function(){var a=this.buf.readUInt32LE(this.pos);return this.pos+=4,a},readSFixed32:function(){var a=this.buf.readInt32LE(this.pos);return this.pos+=4,a},readFixed64:function(){var a=this.buf.readUInt32LE(this.pos)+this.buf.readUInt32LE(this.pos+4)*o;return this.pos+=8,a},readSFixed64:function(){var a=this.buf.readUInt32LE(this.pos)+this.buf.readInt32LE(this.pos+4)*o;return this.pos+=8,a},readFloat:function(){var a=this.buf.readFloatLE(this.pos);return this.pos+=4,a},readDouble:function(){var a=this.buf.readDoubleLE(this.pos);return this.pos+=8,a},readVarint:function(){var a,b,c,d,e,f,g=this.buf;if(c=g[this.pos++],128>c)return c;if(c=127&c,d=g[this.pos++],128>d)return c|d<<7;if(d=(127&d)<<7,e=g[this.pos++],128>e)return c|d|e<<14;if(e=(127&e)<<14,f=g[this.pos++],128>f)return c|d|e|f<<21;if(a=c|d|e|(127&f)<<21,b=g[this.pos++],a+=268435456*(127&b),128>b)return a;if(b=g[this.pos++],a+=34359738368*(127&b),128>b)return a;if(b=g[this.pos++],a+=4398046511104*(127&b),128>b)return a;if(b=g[this.pos++],a+=562949953421312*(127&b),128>b)return a;if(b=g[this.pos++],a+=72057594037927940*(127&b),128>b)return a;if(b=g[this.pos++],a+=0x8000000000000000*(127&b),128>b)return a;throw new Error("Expected varint not more than 10 bytes")},readVarint64:function(){var a=this.pos,b=this.readVarint();if(q>b)return b;for(var c=this.pos-2;255===this.buf[c];)c--;a>c&&(c=a),b=0;for(var d=0;c-a+1>d;d++){var e=127&~this.buf[a+d];b+=4>d?e<<7*d:e*Math.pow(2,7*d)}return-b-1},readSVarint:function(){var a=this.readVarint();return a%2===1?(a+1)/-2:a/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var a=this.readVarint()+this.pos,b=this.buf.toString("utf8",this.pos,a);return this.pos=a,b},readBytes:function(){var a=this.readVarint()+this.pos,b=this.buf.slice(this.pos,a);return this.pos=a,b},readPackedVarint:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readVarint());return b},readPackedSVarint:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readSVarint());return b},readPackedBoolean:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readBoolean());return b},readPackedFloat:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readFloat());return b},readPackedDouble:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readDouble());return b},readPackedFixed32:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readFixed32());return b},readPackedSFixed32:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readSFixed32());return b},readPackedFixed64:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readFixed64());return b},readPackedSFixed64:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readSFixed64());return b},skip:function(a){var b=7&a;if(b===d.Varint)for(;this.buf[this.pos++]>127;);else if(b===d.Bytes)this.pos=this.readVarint()+this.pos;else if(b===d.Fixed32)this.pos+=4;else{if(b!==d.Fixed64)throw new Error("Unimplemented type: "+b);this.pos+=8}},writeTag:function(a,b){this.writeVarint(a<<3|b)},realloc:function(a){for(var b=this.length||16;b<this.pos+a;)b*=2;if(b!==this.length){var c=new n(b);this.buf.copy(c),this.buf=c,this.length=b}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.slice(0,this.length)},writeFixed32:function(a){this.realloc(4),this.buf.writeUInt32LE(a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),this.buf.writeInt32LE(a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),this.buf.writeInt32LE(-1&a,this.pos),this.buf.writeUInt32LE(Math.floor(a*p),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),this.buf.writeInt32LE(-1&a,this.pos),this.buf.writeInt32LE(Math.floor(a*p),this.pos+4),this.pos+=8},writeVarint:function(a){if(a=+a,127>=a)this.realloc(1),this.buf[this.pos++]=a;else if(16383>=a)this.realloc(2),this.buf[this.pos++]=a>>>0&127|128,this.buf[this.pos++]=a>>>7&127;else if(2097151>=a)this.realloc(3),this.buf[this.pos++]=a>>>0&127|128,this.buf[this.pos++]=a>>>7&127|128,this.buf[this.pos++]=a>>>14&127;else if(268435455>=a)this.realloc(4),this.buf[this.pos++]=a>>>0&127|128,this.buf[this.pos++]=a>>>7&127|128,this.buf[this.pos++]=a>>>14&127|128,this.buf[this.pos++]=a>>>21&127;else{for(var b=this.pos;a>=128;)this.realloc(1),this.buf[this.pos++]=255&a|128,a/=128;if(this.realloc(1),this.buf[this.pos++]=0|a,this.pos-b>10)throw new Error("Given varint doesn't fit into 10 bytes")}},writeSVarint:function(a){this.writeVarint(0>a?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(Boolean(a))},writeString:function(a){a=String(a);var b=n.byteLength(a);this.writeVarint(b),this.realloc(b),this.buf.write(a,this.pos),this.pos+=b},writeFloat:function(a){this.realloc(4),this.buf.writeFloatLE(a,this.pos),this.pos+=4},writeDouble:function(a){this.realloc(8),this.buf.writeDoubleLE(a,this.pos),this.pos+=8},writeBytes:function(a){var b=a.length;this.writeVarint(b),this.realloc(b);for(var c=0;b>c;c++)this.buf[this.pos++]=a[c]},writeRawMessage:function(a,b){this.pos++;var c=this.pos;a(b,this);var d=this.pos-c,e=127>=d?1:16383>=d?2:2097151>=d?3:268435455>=d?4:Math.ceil(Math.log(d)/(7*Math.LN2));if(e>1){this.realloc(e-1);for(var f=this.pos-1;f>=c;f--)this.buf[f+e-1]=this.buf[f]}this.pos=c-1,this.writeVarint(d),this.pos+=d},writeMessage:function(a,b,c){this.writeTag(a,d.Bytes),this.writeRawMessage(b,c)},writePackedVarint:function(a,b){this.writeMessage(a,e,b)},writePackedSVarint:function(a,b){this.writeMessage(a,f,b)},writePackedBoolean:function(a,b){this.writeMessage(a,i,b)},writePackedFloat:function(a,b){this.writeMessage(a,g,b)},writePackedDouble:function(a,b){this.writeMessage(a,h,b)},writePackedFixed32:function(a,b){this.writeMessage(a,j,b)},writePackedSFixed32:function(a,b){this.writeMessage(a,k,b)},writePackedFixed64:function(a,b){this.writeMessage(a,l,b)},writePackedSFixed64:function(a,b){this.writeMessage(a,m,b)},writeBytesField:function(a,b){this.writeTag(a,d.Bytes),this.writeBytes(b)},writeFixed32Field:function(a,b){this.writeTag(a,d.Fixed32),this.writeFixed32(b)},writeSFixed32Field:function(a,b){this.writeTag(a,d.Fixed32),this.writeSFixed32(b)},writeFixed64Field:function(a,b){this.writeTag(a,d.Fixed64),this.writeFixed64(b)},writeSFixed64Field:function(a,b){this.writeTag(a,d.Fixed64),this.writeSFixed64(b)},writeVarintField:function(a,b){this.writeTag(a,d.Varint),this.writeVarint(b)},writeSVarintField:function(a,b){this.writeTag(a,d.Varint),this.writeSVarint(b)},writeStringField:function(a,b){this.writeTag(a,d.Bytes),this.writeString(b)},writeFloatField:function(a,b){this.writeTag(a,d.Fixed32),this.writeFloat(b)},writeDoubleField:function(a,b){this.writeTag(a,d.Fixed64),this.writeDouble(b)},writeBooleanField:function(a,b){this.writeVarintField(a,Boolean(b))}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./buffer":135}],137:[function(a,b,c){function d(a,b){this.x=a,this.y=b}b.exports=d,d.prototype={clone:function(){return new d(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var b=a.x-this.x,c=a.y-this.y;return b*b+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,b){return Math.atan2(this.x*b-this.y*a,this.x*a+this.y*b)},_matMult:function(a){var b=a[0]*this.x+a[1]*this.y,c=a[2]*this.x+a[3]*this.y;return this.x=b,this.y=c,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var b=Math.cos(a),c=Math.sin(a),d=b*this.x-c*this.y,e=c*this.x+b*this.y;return this.x=d,this.y=e,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},d.convert=function(a){return a instanceof d?a:Array.isArray(a)?new d(a[0],a[1]):a}},{}],138:[function(a,b,c){function d(){j=!1,k.length?i=k.concat(i):l=-1,i.length&&e()}function e(){if(!j){var a=setTimeout(d);j=!0;for(var b=i.length;b;){for(k=i,i=[];++l<b;)k&&k[l].run();l=-1,b=i.length}k=null,j=!1,clearTimeout(a)}}function f(a,b){this.fun=a,this.array=b}function g(){}var k,h=b.exports={},i=[],j=!1,l=-1;h.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];i.push(new f(a,b)),1!==i.length||j||setTimeout(e,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=g,h.addListener=g,h.once=g,h.off=g,h.removeListener=g,h.removeAllListeners=g,h.emit=g,h.binding=function(a){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(a){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},{}],139:[function(b,c,d){!function(){function b(a,c){return this instanceof b?(this._maxEntries=Math.max(4,a||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),c&&this._initFormat(c),void this.clear()):new b(a,c)}function d(a,b){a.bbox=e(a,0,a.children.length,b)}function e(a,b,c,d){for(var e,h=f(),i=b;c>i;i++)e=a.children[i],g(h,a.leaf?d(e):e.bbox);return h}function f(){return[1/0,1/0,-(1/0),-(1/0)]}function g(a,b){return a[0]=Math.min(a[0],b[0]),a[1]=Math.min(a[1],b[1]),a[2]=Math.max(a[2],b[2]),a[3]=Math.max(a[3],b[3]),a}function h(a,b){return a.bbox[0]-b.bbox[0]}function i(a,b){return a.bbox[1]-b.bbox[1]}function j(a){return(a[2]-a[0])*(a[3]-a[1])}function k(a){return a[2]-a[0]+(a[3]-a[1])}function l(a,b){return(Math.max(b[2],a[2])-Math.min(b[0],a[0]))*(Math.max(b[3],a[3])-Math.min(b[1],a[1]))}function m(a,b){var c=Math.max(a[0],b[0]),d=Math.max(a[1],b[1]),e=Math.min(a[2],b[2]),f=Math.min(a[3],b[3]);return Math.max(0,e-c)*Math.max(0,f-d)}function n(a,b){return a[0]<=b[0]&&a[1]<=b[1]&&b[2]<=a[2]&&b[3]<=a[3]}function o(a,b){return b[0]<=a[2]&&b[1]<=a[3]&&b[2]>=a[0]&&b[3]>=a[1]}function p(a,b,c,d,e){for(var f,g=[b,c];g.length;)c=g.pop(),b=g.pop(),d>=c-b||(f=b+Math.ceil((c-b)/d/2)*d,q(a,b,c,f,e),g.push(b,f,f,c))}function q(a,b,c,d,e){for(var f,g,h,i,j,k,l,m,n;c>b;){for(c-b>600&&(f=c-b+1,g=d-b+1,h=Math.log(f),i=.5*Math.exp(2*h/3),j=.5*Math.sqrt(h*i*(f-i)/f)*(0>g-f/2?-1:1),k=Math.max(b,Math.floor(d-g*i/f+j)),l=Math.min(c,Math.floor(d+(f-g)*i/f+j)),q(a,k,l,d,e)),m=a[d],g=b,n=c,r(a,b,d),e(a[c],m)>0&&r(a,b,c);n>g;){for(r(a,g,n),g++,n--;e(a[g],m)<0;)g++;for(;e(a[n],m)>0;)n--}0===e(a[b],m)?r(a,b,n):(n++,r(a,n,c)),d>=n&&(b=n+1),n>=d&&(c=n-1)}}function r(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}b.prototype={all:function(){return this._all(this.data,[])},search:function(a){var b=this.data,c=[],d=this.toBBox;if(!o(a,b.bbox))return c;for(var e,f,g,h,i=[];b;){for(e=0,f=b.children.length;f>e;e++)g=b.children[e],h=b.leaf?d(g):g.bbox,o(a,h)&&(b.leaf?c.push(g):n(a,h)?this._all(g,c):i.push(g));b=i.pop()}return c},collides:function(a){var b=this.data,c=this.toBBox;if(!o(a,b.bbox))return!1;for(var d,e,f,g,h=[];b;){for(d=0,e=b.children.length;e>d;d++)if(f=b.children[d],g=b.leaf?c(f):f.bbox,o(a,g)){if(b.leaf||n(a,g))return!0;h.push(f)}b=h.pop()}return!1},load:function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var b=0,c=a.length;c>b;b++)this.insert(a[b]);return this}var d=this._build(a.slice(),0,a.length-1,0);if(this.data.children.length)if(this.data.height===d.height)this._splitRoot(this.data,d);else{if(this.data.height<d.height){var e=this.data;this.data=d,d=e}this._insert(d,this.data.height-d.height-1,!0)}else this.data=d;return this},insert:function(a){return a&&this._insert(a,this.data.height-1),this},clear:function(){return this.data={children:[],height:1,bbox:f(),leaf:!0},this},remove:function(a){if(!a)return this;for(var b,c,d,e,f=this.data,g=this.toBBox(a),h=[],i=[];f||h.length;){if(f||(f=h.pop(),c=h[h.length-1],b=i.pop(),e=!0),f.leaf&&(d=f.children.indexOf(a),-1!==d))return f.children.splice(d,1),h.push(f),this._condense(h),this;e||f.leaf||!n(f.bbox,g)?c?(b++,f=c.children[b],e=!1):f=null:(h.push(f),i.push(b),b=0,c=f,f=f.children[0])}return this},toBBox:function(a){return a},compareMinX:function(a,b){return a[0]-b[0]},compareMinY:function(a,b){return a[1]-b[1]},toJSON:function(){return this.data},fromJSON:function(a){return this.data=a,this},_all:function(a,b){for(var c=[];a;)a.leaf?b.push.apply(b,a.children):c.push.apply(c,a.children),a=c.pop();return b},_build:function(a,b,c,e){var f,g=c-b+1,h=this._maxEntries;if(h>=g)return f={children:a.slice(b,c+1),height:1,bbox:null,leaf:!0},d(f,this.toBBox),f;e||(e=Math.ceil(Math.log(g)/Math.log(h)),h=Math.ceil(g/Math.pow(h,e-1))),f={children:[],height:e,bbox:null,leaf:!1};var i,j,k,l,m=Math.ceil(g/h),n=m*Math.ceil(Math.sqrt(h));for(p(a,b,c,n,this.compareMinX),i=b;c>=i;i+=n)for(k=Math.min(i+n-1,c),p(a,i,k,m,this.compareMinY),j=i;k>=j;j+=m)l=Math.min(j+m-1,k),f.children.push(this._build(a,j,l,e-1));return d(f,this.toBBox),f},_chooseSubtree:function(a,b,c,d){for(var e,f,g,h,i,k,m,n;d.push(b),!b.leaf&&d.length-1!==c;){for(m=n=1/0,e=0,f=b.children.length;f>e;e++)g=b.children[e],i=j(g.bbox),k=l(a,g.bbox)-i,n>k?(n=k,m=m>i?i:m,h=g):k===n&&m>i&&(m=i,h=g);b=h}return b},_insert:function(a,b,c){var d=this.toBBox,e=c?a.bbox:d(a),f=[],h=this._chooseSubtree(e,this.data,b,f);for(h.children.push(a),g(h.bbox,e);b>=0&&f[b].children.length>this._maxEntries;)this._split(f,b),b--;this._adjustParentBBoxes(e,f,b)},_split:function(a,b){var c=a[b],e=c.children.length,f=this._minEntries;this._chooseSplitAxis(c,f,e);var g=this._chooseSplitIndex(c,f,e),h={children:c.children.splice(g,c.children.length-g),height:c.height,bbox:null,leaf:!1};c.leaf&&(h.leaf=!0),d(c,this.toBBox),d(h,this.toBBox),b?a[b-1].children.push(h):this._splitRoot(c,h)},_splitRoot:function(a,b){this.data={children:[a,b],height:a.height+1,bbox:null,leaf:!1},d(this.data,this.toBBox)},_chooseSplitIndex:function(a,b,c){var d,f,g,h,i,k,l,n;for(k=l=1/0,d=b;c-b>=d;d++)f=e(a,0,d,this.toBBox),g=e(a,d,c,this.toBBox),h=m(f,g),i=j(f)+j(g),k>h?(k=h,n=d,l=l>i?i:l):h===k&&l>i&&(l=i,n=d);return n},_chooseSplitAxis:function(a,b,c){var d=a.leaf?this.compareMinX:h,e=a.leaf?this.compareMinY:i,f=this._allDistMargin(a,b,c,d),g=this._allDistMargin(a,b,c,e);g>f&&a.children.sort(d)},_allDistMargin:function(a,b,c,d){a.children.sort(d);var f,h,i=this.toBBox,j=e(a,0,b,i),l=e(a,c-b,c,i),m=k(j)+k(l);for(f=b;c-b>f;f++)h=a.children[f],g(j,a.leaf?i(h):h.bbox),m+=k(j);for(f=c-b-1;f>=b;f--)h=a.children[f],g(l,a.leaf?i(h):h.bbox),m+=k(l);return m},_adjustParentBBoxes:function(a,b,c){for(var d=c;d>=0;d--)g(b[d].bbox,a)},_condense:function(a){for(var b,c=a.length-1;c>=0;c--)0===a[c].children.length?c>0?(b=a[c-1].children,b.splice(b.indexOf(a[c]),1)):this.clear():d(a[c],this.toBBox)},_initFormat:function(a){var b=["return a"," - b",";"];this.compareMinX=new Function("a","b",b.join(a[0])),this.compareMinY=new Function("a","b",b.join(a[1])),this.toBBox=new Function("a","return [a"+a.join(", a")+"];")}},"function"==typeof a&&a.amd?a("rbush",function(){return b}):"undefined"!=typeof c?c.exports=b:"undefined"!=typeof self?self.rbush=b:window.rbush=b}()},{}],140:[function(b,c,d){void function(b,e){"function"==typeof a&&a.amd?a(e):"object"==typeof d?c.exports=e():b.resolveUrl=e()}(this,function(){function a(){var a=arguments.length;if(0===a)throw new Error("resolveUrl requires at least one argument; got none.");var b=document.createElement("base");if(b.href=arguments[0],1===a)return b.href;var c=document.getElementsByTagName("head")[0];c.insertBefore(b,c.firstChild);for(var d,e=document.createElement("a"),f=1;a>f;f++)e.href=arguments[f],d=e.href,b.href=d;return c.removeChild(b),d}return a})},{}],141:[function(a,b,c){function d(a,b,c,d){this.cx=3*a,this.bx=3*(c-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*b,this.by=3*(d-b)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=d,this.p2x=c,this.p2y=d}b.exports=d,d.prototype.sampleCurveX=function(a){return((this.ax*a+this.bx)*a+this.cx)*a},d.prototype.sampleCurveY=function(a){return((this.ay*a+this.by)*a+this.cy)*a},d.prototype.sampleCurveDerivativeX=function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},d.prototype.solveCurveX=function(a,b){"undefined"==typeof b&&(b=1e-6);var c,d,e,f,g;for(e=a,g=0;8>g;g++){if(f=this.sampleCurveX(e)-a,Math.abs(f)<b)return e;var h=this.sampleCurveDerivativeX(e);if(Math.abs(h)<1e-6)break;e-=f/h}if(c=0,d=1,e=a,c>e)return c;if(e>d)return d;for(;d>c;){if(f=this.sampleCurveX(e),Math.abs(f-a)<b)return e;a>f?c=e:d=e,e=.5*(d-c)+c}return e},d.prototype.solve=function(a,b){return this.sampleCurveY(this.solveCurveX(a,b))}},{}],142:[function(a,b,c){b.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},{}],143:[function(a,b,c){(function(b,d){function e(a,b){var d={seen:[],stylize:g};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),p(b)?d.showHidden=b:b&&c._extend(d,b),v(d.showHidden)&&(d.showHidden=!1),v(d.depth)&&(d.depth=2),v(d.colors)&&(d.colors=!1),v(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=f),i(d,a,d.depth)}function f(a,b){var c=e.styles[b];return c?"["+e.colors[c][0]+"m"+a+"["+e.colors[c][1]+"m":a}function g(a,b){return a}function h(a){var b={};return a.forEach(function(a,c){b[a]=!0}),b}function i(a,b,d){if(a.customInspect&&b&&A(b.inspect)&&b.inspect!==c.inspect&&(!b.constructor||b.constructor.prototype!==b)){var e=b.inspect(d,a);return t(e)||(e=i(a,e,d)),e}var f=j(a,b);if(f)return f;var g=Object.keys(b),p=h(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(b)),z(b)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return k(b);if(0===g.length){if(A(b)){var q=b.name?": "+b.name:"";return a.stylize("[Function"+q+"]","special")}if(w(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(y(b))return a.stylize(Date.prototype.toString.call(b),"date");if(z(b))return k(b)}var r="",s=!1,u=["{","}"];if(o(b)&&(s=!0,u=["[","]"]),A(b)){var v=b.name?": "+b.name:"";r=" [Function"+v+"]"}if(w(b)&&(r=" "+RegExp.prototype.toString.call(b)),y(b)&&(r=" "+Date.prototype.toUTCString.call(b)),z(b)&&(r=" "+k(b)),0===g.length&&(!s||0==b.length))return u[0]+r+u[1];if(0>d)return w(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);var x;return x=s?l(a,b,d,p,g):g.map(function(c){return m(a,b,d,p,c,s)}),a.seen.pop(),n(x,r,u)}function j(a,b){if(v(b))return a.stylize("undefined","undefined");if(t(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return s(b)?a.stylize(""+b,"number"):p(b)?a.stylize(""+b,"boolean"):q(b)?a.stylize("null","null"):void 0}function k(a){return"["+Error.prototype.toString.call(a)+"]"}function l(a,b,c,d,e){for(var f=[],g=0,h=b.length;h>g;++g)F(b,String(g))?f.push(m(a,b,c,d,String(g),!0)):f.push("");return e.forEach(function(e){e.match(/^\d+$/)||f.push(m(a,b,c,d,e,!0))}),f}function m(a,b,c,d,e,f){var g,h,j;if(j=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},j.get?h=j.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):j.set&&(h=a.stylize("[Setter]","special")),F(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(j.value)<0?(h=q(c)?i(a,j.value,null):i(a,j.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),v(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function n(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function o(a){return Array.isArray(a)}function p(a){return"boolean"==typeof a}function q(a){return null===a}function r(a){return null==a}function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return"symbol"==typeof a}function v(a){return void 0===a}function w(a){return x(a)&&"[object RegExp]"===C(a)}function x(a){return"object"==typeof a&&null!==a}function y(a){return x(a)&&"[object Date]"===C(a)}function z(a){return x(a)&&("[object Error]"===C(a)||a instanceof Error)}function A(a){return"function"==typeof a}function B(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function C(a){return Object.prototype.toString.call(a)}function D(a){return 10>a?"0"+a.toString(10):a.toString(10)}function E(){var a=new Date,b=[D(a.getHours()),D(a.getMinutes()),D(a.getSeconds())].join(":");return[a.getDate(),J[a.getMonth()],b].join(" ")}function F(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var G=/%[sdj%]/g;c.format=function(a){if(!t(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(G,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(a){return"[Circular]"}default:return a}}),h=d[c];f>c;h=d[++c])g+=q(h)||!x(h)?" "+h:" "+e(h);return g},c.deprecate=function(a,e){function f(){if(!g){if(b.throwDeprecation)throw new Error(e);b.traceDeprecation?console.trace(e):console.error(e),g=!0}return a.apply(this,arguments)}if(v(d.process))return function(){return c.deprecate(a,e).apply(this,arguments)};if(b.noDeprecation===!0)return a;var g=!1;return f};var I,H={};c.debuglog=function(a){
if(v(I)&&(I=b.env.NODE_DEBUG||""),a=a.toUpperCase(),!H[a])if(new RegExp("\\b"+a+"\\b","i").test(I)){var d=b.pid;H[a]=function(){var b=c.format.apply(c,arguments);console.error("%s %d: %s",a,d,b)}}else H[a]=function(){};return H[a]},c.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},c.isArray=o,c.isBoolean=p,c.isNull=q,c.isNullOrUndefined=r,c.isNumber=s,c.isString=t,c.isSymbol=u,c.isUndefined=v,c.isRegExp=w,c.isObject=x,c.isDate=y,c.isError=z,c.isFunction=A,c.isPrimitive=B,c.isBuffer=a("./support/isBuffer");var J=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];c.log=function(){console.log("%s - %s",E(),c.format.apply(c,arguments))},c.inherits=a("inherits"),c._extend=function(a,b){if(!b||!x(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":142,_process:138,inherits:127}],144:[function(a,b,c){b.exports.VectorTile=a("./lib/vectortile.js"),b.exports.VectorTileFeature=a("./lib/vectortilefeature.js"),b.exports.VectorTileLayer=a("./lib/vectortilelayer.js")},{"./lib/vectortile.js":145,"./lib/vectortilefeature.js":147,"./lib/vectortilelayer.js":148}],145:[function(a,b,c){function d(a,b){this.layers=a.readFields(e,{},b)}function e(a,b,c){if(3===a){var d=new f(c,c.readVarint()+c.pos);d.length&&(b[d.name]=d)}}var f=a("./vectortilelayer");b.exports=d},{"./vectortilelayer":148}],146:[function(a,b,c){function d(a){this.feature=a,this.finalRatio=4096/a.extent*Math.pow(2,a.dz);var b=64;b/=this.finalRatio;var c=a.extent>>a.dz;b>c&&(b=c),this.dz=a.dz,this.margin=b,this.xmin=c*a.xPos-b,this.ymin=c*a.yPos-b,this.xmax=this.xmin+c+2*b,this.ymax=this.ymin+c+2*b,this.lines=[],this._prevIsIn=!1,this.type=a.type}var e=a("point-geometry");b.exports=d,d.prototype.loadGeometry=function(){var a=this.feature._pbf;a.pos=this.feature._geometry;for(var b=a.readVarint()+a.pos,c=1,d=0,e=0,f=0;a.pos<b;){if(!d){var g=a.readVarint();c=7&g,d=g>>3}if(d--,1===c||2===c)e+=a.readSVarint(),f+=a.readSVarint(),1===c?this.moveTo(e,f):this.lineTo(e,f);else{if(7!==c)throw new Error("unknown command "+c);this.closePolygon()}}return this.result()},d.prototype.moveTo=function(a,b){this._push_line(),this._prevIsIn=this._isIn(a,b),this._moveTo(a,b,this._prevIsIn),this._prevPt=new e(a,b),this._firstPt=new e(a,b)},d.prototype.lineTo=function(a,b){var c,d,f,g,h,i,j,k,l,m,n,o,p=this._isIn(a,b);if(p)this._prevIsIn?this._lineTo(a,b,!0):(c=this._prevPt,d=new e(a,b),f=this._intersect(d,c),this._lineTo(f.x,f.y,!0),this._lineTo(d.x,d.y,!0));else if(this._prevIsIn)d=this._prevPt,c=new e(a,b),f=this._intersect(d,c),this._lineTo(f.x,f.y,!0),this._lineTo(c.x,c.y,!1);else if(g=this._prevPt,h=new e(a,b),g.x<=this.xmin&&h.x<=this.xmin||g.x>=this.xmax&&h.x>=this.xmax||g.y<=this.ymin&&h.y<=this.ymin||g.y>=this.ymax&&h.y>=this.ymax)this._lineTo(h.x,h.y,!1);else{if(k=[],(g.x<this.xmin&&h.x>this.xmin||g.x>this.xmin&&h.x<this.xmin)&&(i=(this.xmin-g.x)/(h.x-g.x),o=g.y+i*(h.y-g.y),o<=this.ymin?m=!1:o>=this.ymax?m=!0:(j={},j.ratio=i,j.x=this.xmin,j.y=o,k.push(j))),(g.x<this.xmax&&h.x>this.xmax||g.x>this.xmax&&h.x<this.xmax)&&(i=(this.xmax-g.x)/(h.x-g.x),o=g.y+i*(h.y-g.y),o<=this.ymin?m=!1:o>=this.ymax?m=!0:(j={},j.ratio=i,j.x=this.xmax,j.y=o,k.push(j))),(g.y<this.ymin&&h.y>this.ymin||g.y>this.ymin&&h.y<this.ymin)&&(i=(this.ymin-g.y)/(h.y-g.y),n=g.x+i*(h.x-g.x),n<=this.xmin?l=!1:n>=this.xmax?l=!0:(j={},j.ratio=i,j.x=n,j.y=this.ymin,k.push(j))),(g.y<this.ymax&&h.y>this.ymax||g.y>this.ymax&&h.y<this.ymax)&&(i=(this.ymax-g.y)/(h.y-g.y),n=g.x+i*(h.x-g.x),n<=this.xmin?l=!1:n>=this.xmax?l=!0:(j={},j.ratio=i,j.x=n,j.y=this.ymax,k.push(j))),0===k.length)l?m?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):m?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(k.length>1&&k[0].ratio>k[1].ratio)this._lineTo(k[1].x,k[1].y,!0),this._lineTo(k[0].x,k[0].y,!0);else for(var q=0;q<k.length;q++)this._lineTo(k[q].x,k[q].y,!0);this._lineTo(h.x,h.y,!1)}this._prevIsIn=p,this._prevPt=new e(a,b)},d.prototype.closePolygon=function(){var a,b;this.line.length>0&&(a=this._firstPt,b=this._prevPt,(a.x!==b.x||a.y!==b.y)&&this.lineTo(a.x,a.y))},d.prototype.result=function(){return this._push_line(),0===this.lines.length?null:this.lines},d.prototype._isIn=function(a,b){return a>=this.xmin&&a<=this.xmax&&b>=this.ymin&&b<=this.ymax},d.prototype._intersect=function(a,b){var c,d,f,g;return b.x>=this.xmin&&b.x<=this.xmax?(d=b.y<=this.ymin?this.ymin:this.ymax,c=a.x+(d-a.y)/(b.y-a.y)*(b.x-a.x)):b.y>=this.ymin&&b.y<=this.ymax?(c=b.x<=this.xmin?this.xmin:this.xmax,d=a.y+(c-a.x)/(b.x-a.x)*(b.y-a.y)):(d=b.y<=this.ymin?this.ymin:this.ymax,c=b.x<=this.xmin?this.xmin:this.xmax,f=(c-a.x)/(b.x-a.x),g=(d-a.y)/(b.y-a.y),g>f?d=a.y+f*(b.y-a.y):c=a.x+g*(b.x-a.x)),new e(c,d)},d.prototype._push_line=function(){this.line&&(1===this.type?this.line.length>0&&this.lines.push(this.line):2===this.type?this.line.length>1&&this.lines.push(this.line):3===this.type&&this.line.length>3&&this.lines.push(this.line)),this.line=[]},d.prototype._moveTo=function(a,b,c){3!==this.type?c&&(a=(a-(this.xmin+this.margin))*this.finalRatio,b=(b-(this.ymin+this.margin))*this.finalRatio,this.line.push(new e(a,b))):(c||(a<this.xmin&&(a=this.xmin),a>this.xmax&&(a=this.xmax),b<this.ymin&&(b=this.ymin),b>this.ymax&&(b=this.ymax)),a=(a-(this.xmin+this.margin))*this.finalRatio,b=(b-(this.ymin+this.margin))*this.finalRatio,this.line.push(new e(a,b)),this._is_h=!1,this._is_v=!1)},d.prototype._lineTo=function(a,b,c){var d,f;if(3!==this.type)if(c){if(a=(a-(this.xmin+this.margin))*this.finalRatio,b=(b-(this.ymin+this.margin))*this.finalRatio,this.line.length>0&&(d=this.line[this.line.length-1],d.x===a&&d.y===b))return;this.line.push(new e(a,b))}else this.line&&this.line.length>0&&this._push_line();else if(c||(a<this.xmin&&(a=this.xmin),a>this.xmax&&(a=this.xmax),b<this.ymin&&(b=this.ymin),b>this.ymax&&(b=this.ymax)),a=(a-(this.xmin+this.margin))*this.finalRatio,b=(b-(this.ymin+this.margin))*this.finalRatio,this.line&&this.line.length>0){d=this.line[this.line.length-1];var g=d.x===a,h=d.y===b;if(g&&h)return;this._is_h&&g?(d.x=a,d.y=b,f=this.line[this.line.length-2],this._is_h=f.x===a,this._is_v=f.y===b):this._is_v&&h?(d.x=a,d.y=b,f=this.line[this.line.length-2],this._is_h=f.x===a,this._is_v=f.y===b):(this.line.push(new e(a,b)),this._is_h=g,this._is_v=h)}else this.line.push(new e(a,b))}},{"point-geometry":137}],147:[function(a,b,c){function d(a,b,c,d,f){this.properties={},this.extent=c,this.type=0,this._pbf=a,this._geometry=-1,this._keys=d,this._values=f,a.readFields(e,this,b)}function e(a,b,c){1==a?b._id=c.readVarint():2==a?f(c,b):3==a?b.type=c.readVarint():4==a&&(b._geometry=c.pos)}function f(a,b){for(var c=a.readVarint()+a.pos;a.pos<c;){var d=b._keys[a.readVarint()],e=b._values[a.readVarint()];b.properties[d]=e}}var g=a("point-geometry"),h=a("./vectortileclipper");b.exports=d,d.types=["Unknown","Point","LineString","Polygon"],d.prototype.loadGeometry=function(){var a;if(this.dz){var b=new h(this);a=b.loadGeometry()}else{for(var c=0,d=this.extent;d>4096;)c+=1,d>>=1;var e=this._pbf;e.pos=this._geometry;var f,i=e.readVarint()+e.pos,j=1,k=0,l=0,m=0;for(a=[];e.pos<i;){if(!k){var n=e.readVarint();j=7&n,k=n>>3}if(k--,1===j||2===j)l+=e.readSVarint(),m+=e.readSVarint(),1===j&&(f&&a.push(f),f=[]),f.push(new g(l>>c,m>>c));else{if(7!==j)throw new Error("unknown command "+j);f&&f.push(f[0].clone())}}f&&a.push(f)}return a},d.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var b=a.readVarint()+a.pos,c=1,d=0,e=0,f=0,g=1/0,h=-(1/0),i=1/0,j=-(1/0);a.pos<b;){if(!d){var k=a.readVarint();c=7&k,d=k>>3}if(d--,1===c||2===c)e+=a.readSVarint(),f+=a.readSVarint(),g>e&&(g=e),e>h&&(h=e),i>f&&(i=f),f>j&&(j=f);else if(7!==c)throw new Error("unknown command "+c)}return[g,i,h,j]},d.prototype.toGeoJSON=function(a,b,c){for(var e=this.extent*Math.pow(2,c),f=this.extent*a,g=this.extent*b,h=this.loadGeometry(),i=d.types[this.type],j=0;j<h.length;j++)for(var k=h[j],l=0;l<k.length;l++){var m=k[l],n=180-360*(m.y+g)/e;k[l]=[360*(m.x+f)/e-180,360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90]}return"Point"===i&&1===h.length?h=h[0][0]:"Point"===i?(h=h[0],i="MultiPoint"):"LineString"===i&&1===h.length?h=h[0]:"LineString"===i&&(i="MultiLineString"),{type:"Feature",geometry:{type:i,coordinates:h},properties:this.properties}}},{"./vectortileclipper":146,"point-geometry":137}],148:[function(a,b,c){function d(a,b){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(e,this,b),this.length=this._features.length}function e(a,b,c){15===a?b.version=c.readVarint():1===a?b.name=c.readString():5===a?b.extent=c.readVarint():2===a?b._features.push(c.pos):3===a?b._keys.push(c.readString()):4===a&&b._values.push(f(c))}function f(a){for(var b=null,c=a.readVarint()+a.pos;a.pos<c;){var d=a.readVarint()>>3;b=1===d?a.readString():2===d?a.readFloat():3===d?a.readDouble():4===d?a.readVarint64():5===d?a.readVarint():6===d?a.readSVarint():7===d?a.readBoolean():null}return b}var g=a("./vectortilefeature.js");b.exports=d,d.prototype.feature=function(a){if(0>a||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var b=this._pbf.readVarint()+this._pbf.pos;return new g(this._pbf,b,this.extent,this._keys,this._values)}},{"./vectortilefeature.js":147}],149:[function(a,b,c){var d=arguments[3],e=arguments[4],f=arguments[5],g=JSON.stringify;b.exports=function(a){for(var b,c=Object.keys(f),h=0,i=c.length;i>h;h++){var j=c[h],k=f[j].exports;if(k===a||k.default===a){b=j;break}}if(!b){b=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var l={},h=0,i=c.length;i>h;h++){var j=c[h];l[j]=j}e[b]=[Function(["require","module","exports"],"("+a+")(self)"),l]}var m=Math.floor(Math.pow(16,8)*Math.random()).toString(16),n={};n[b]=b,e[m]=[Function(["require"],"var f = require("+g(b)+");(f.default ? f.default : f)(self);"),n];var o="("+d+")({"+Object.keys(e).map(function(a){return g(a)+":["+e[a][0]+","+g(e[a][1])+"]"}).join(",")+"},{},["+g(m)+"])",p=window.URL||window.webkitURL||window.mozURL||window.msURL;return new Worker(p.createObjectURL(new Blob([o],{type:"text/javascript"})))}},{}]},{},[24])(24)}),L.MapboxGL=L.Layer.extend({options:{updateInterval:32},initialize:function(a){if(L.setOptions(this,a),!a.accessToken)throw new Error("You should provide a Mapbox GL access token as a token option.");mapboxgl.accessToken=a.accessToken,this._throttledUpdate=mapboxgl.util.throttle(L.Util.bind(this._update,this),this.options.updateInterval)},onAdd:function(a){this._map=a,this._glContainer||this._initContainer(),a._panes.tilePane.appendChild(this._glContainer),this._initGL()},onRemove:function(a){a.getPanes().tilePane.removeChild(this._glContainer),this._glMap.remove(),this._glMap=null},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd}},addTo:function(a){return a.addLayer(this),this},_initContainer:function(){var a=this._glContainer=L.DomUtil.create("div","leaflet-gl-layer"),b=this._map.getSize();a.style.width=b.x+"px",a.style.height=b.y+"px"},_initGL:function(){var a=this._map.getCenter(),b=L.extend({},this.options,{container:this._glContainer,interactive:!1,center:[a.lng,a.lat],zoom:this._map.getZoom()-1,attributionControl:!1});this._glMap=new mapboxgl.Map(b),this._glMap.transform.latRange=null,L.DomUtil.addClass(this._glMap._canvas.canvas,"leaflet-image-layer"),L.DomUtil.addClass(this._glMap._canvas.canvas,"leaflet-zoom-animated")},_update:function(a){if(this._offset=this._map.containerPointToLayerPoint([0,0]),!this._zooming){var b=this._map.getSize(),c=this._glContainer,d=this._glMap,e=this._map.containerPointToLayerPoint([0,0]);L.DomUtil.setPosition(c,e);var f=this._map.getCenter(),g=d.transform;g.center=mapboxgl.LngLat.convert([f.lng,f.lat]),g.zoom=this._map.getZoom()-1,d.transform.width!==b.x||d.transform.height!==b.y?(c.style.width=b.x+"px",c.style.height=b.y+"px",d.resize()):d.update()}},_pinchZoom:function(a){this._glMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(a){var b=this._map.getZoomScale(a.zoom),c=this._map._latLngToNewLayerPoint(this._map.getBounds().getNorthWest(),a.zoom,a.center);L.DomUtil.setTransform(this._glMap._canvas.canvas,c.subtract(this._offset),b)},_zoomStart:function(){this._zooming=!0},_zoomEnd:function(){var a=this._map.getZoom(),b=this._map.getCenter(),c=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());L.Util.requestAnimFrame(function(){L.DomUtil.setTransform(this._glMap._canvas.canvas,c,1),this._glMap.once("moveend",L.Util.bind(function(){this._zooming=!1},this)),this._glMap.jumpTo({center:b,zoom:a-1})},this)}}),L.mapboxGL=function(a){return new L.MapboxGL(a)};var f=b.Layer.extend({statics:{URLPREFIX:"https://www.arcgis.com/sharing/rest/content/items/",URLSUFFIX:"/resources/styles/root.json",STYLES:{DarkGray:"850db44b9eb845d3bd42b19e8aa7a024",Gray:"0e02e6f86d02455091796eaae811d9b5",Hybrid:"8fad42206b6d4efcbd02623dba4554e4",Navigation:"dcbbba0edf094eaa81af19298b9c6247",Streets:"4e1133c28ac04cca97693cf336cd49ad",StreetsNight:"bf79e422e9454565ae0cbe9553cf6471",StreetsRelief:"2e063e709e3446459f8538ed6743f879",Topographic:"6f65bc1351b7411588a8cb43fe23dad7",Spring:"763884983d3544c0a418a97992881fce",Newspaper:"4f4843d99c34436f82920932317893ae",MidCentury:"267f44f08a844c7abee2b62b00600540"}},initialize:function(a){if(a={key:a},"string"!=typeof a.key||!f.STYLES[a.key])throw new Error('L.esri.Vector.Basemap: Invalid parameter. Use one of "DarkGray", "Gray", "Hybrid", "Navigation", "Streets", "StreetsNight", "StreetsRelief", "Topographic"');var b=f.URLPREFIX+f.STYLES[a.key]+f.URLSUFFIX;e(b,this)},onAdd:function(a){this._map=a,c.Util.setEsriAttribution(a),a.attributionControl&&(c.Util._getAttributionData("https://static.arcgis.com/attribution/World_Street_Map",a),a.attributionControl.addAttribution('<span class="esri-dynamic-attribution">USGS, NOAA</span>')),this._ready?this._asyncAdd():this.once("ready",function(){this._asyncAdd()},this)},onRemove:function(a){if(a.off("moveend",c.Util._updateMapAttribution),a.removeLayer(this._mapboxGL),a.attributionControl){var b=document.getElementsByClassName("esri-dynamic-attribution")[0].outerHTML;a.attributionControl.removeAttribution(b)}},_asyncAdd:function(){var a=this._map;a.getContainer().style.background=this._mapboxGL.options.style.layers[0].paint["background-color"],a.on("moveend",c.Util._updateMapAttribution),this._mapboxGL.addTo(a,this)}}),h=b.Layer.extend({statics:{URLPREFIX:"https://www.arcgis.com/sharing/rest/content/items/",URLSUFFIX:"/resources/styles/root.json"},initialize:function(a){if(a={id:a},"string"!=typeof a.id)throw new Error("L.esri.Vector.Layer: Invalid parameter. Use the id of an ArcGIS Online vector tile item");var b=h.URLPREFIX+a.id+h.URLSUFFIX;e(b,this)},onAdd:function(a){this._map=a,c.Util.setEsriAttribution(a),a.attributionControl&&(c.Util._getAttributionData("https://static.arcgis.com/attribution/World_Street_Map",a),a.attributionControl.addAttribution('<span class="esri-dynamic-attribution">USGS, NOAA</span>')),this._ready?this._asyncAdd():this.once("ready",function(){this._asyncAdd()},this)},onRemove:function(a){if(a.off("moveend",c.Util._updateMapAttribution),a.removeLayer(this._mapboxGL),a.attributionControl){var b=document.getElementsByClassName("esri-dynamic-attribution")[0].outerHTML;a.attributionControl.removeAttribution(b)}},_asyncAdd:function(){var a=this._map;a.getContainer().style.background=this._mapboxGL.options.style.layers[0].paint["background-color"],a.on("moveend",c.Util._updateMapAttribution),this._mapboxGL.addTo(a,this)}});a.VERSION=d,a.Basemap=f,a.basemap=g,a.Layer=h,a.layer=i});